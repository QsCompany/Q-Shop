var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(n,t,i,r){var f=arguments.length,u=f<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,e,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(e=n[o])&&(u=(f<3?e(u):f>3?e(t,i,u):e(t,i))||u);return f>3&&u&&Object.defineProperty(t,i,u),u},__metadata=this&&this.__metadata||function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};define("__supervisor__",["require","exports","context"],function(n,t,i){"use strict";function r(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}Object.defineProperty(t,"__esModule",{value:!0});var f=r(),u=r()?"desktop/":"mobile/";i.SetSuperVisor(function(n){var t=n.FullPath.toLowerCase();if(f){if(t.indexOf(u)===0||t.indexOf("apps/")==0||t.indexOf("idea/")==0||t.indexOf("componenets")==0)return!0}else if(t.indexOf(u)===0)return!0;return!1})});define("abstract/extra/AdminApis",["require","exports","../../lib/Q/sys/corelib","../../lib/Q/sys/System","../../lib/Q/sys/UI","abstract/extra/Basics","abstract/Models"],function(n,t,i,r,u,f,e){"use strict";function l(n){return n.getTime()+n.getTimezoneOffset()*6e4}var o,s,h,c;Object.defineProperty(t,"__esModule",{value:!0});t.dateToUTC=l;o=function(){function n(n,t,i){this.Init(n,t,i)}return n.prototype.callback=function(n,t,r,u){n&&n({Api:this,Data:t,Error:r?i.basic.DataStat.Success:i.basic.DataStat.Fail,List:u})},n.prototype.callback1=function(n,t){n&&n(t)},n.prototype.NativeCreateItem=function(n){return this.getDefaultList().CreateNewItem(n)},n.prototype.ShowList=function(){throw new Error("Method not implemented.");},n.prototype.Get=function(){throw new Error("Method not implemented.");},n.prototype.ShowInfo=function(n,t,i){u.UI.InfoArea.push(n,t,i)},Object.defineProperty(n.prototype,"EditData",{get:function(){return!this._catModal&&this._templateName&&(this._catModal=new u.UI.Modals.EModalEditer(this._templateName,!1)),this._catModal},enumerable:!0,configurable:!0}),n.prototype.getEditList=function(){return!this._listModal&&this._listTemplateName&&(this._listModal=new u.UI.Modals.ModalList(undefined,this._listTemplateName.templateName,this._listTemplateName.itemTemplateName),this._listModal.OnInitialized=function(n){return n.setWidth("90%")}),this._listModal},n.prototype.Init=function(n,t,i){this._vars=n;i instanceof u.UI.Modals.ModalList?this._listModal=i:this._listTemplateName=i;typeof t=="string"?this._templateName=t:this._catModal=t},n.prototype.Check=function(n,t){t&&t({Api:this,Data:n,Error:i.basic.DataStat.Success})},n.prototype.New=function(n){var u=this,t=this.NativeCreateItem(i.basic.New());return this._vars.requester.Request(t.GetType(),"CREATE",t,null,function(i,f,e){if(t&&(t.Stat=r.sdata.DataStat.IsNew),e){var o=u.getDefaultList();o&&o.Add(t)}u.callback(n,t,e)}),t},n.prototype.Save=function(n,t){var i=this;this.Check(n,function(r){switch(r.Error){case f.basics.DataStat.Success:i._vars.requester.Request(n.GetType(),"SAVE",n,null,function(r,f,e){if(e){u.UI.InfoArea.push("The "+n.TableName+" Successfully Saved",!0);var o=i.getDefaultList();o&&o.Add(n)}else u.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The "+n.TableName,!1,8e3);i.callback(t,n,e)});return;default:t&&t(r);return}})},n.prototype.Delete=function(n,t){var i=this;if(!n)return this.ShowInfo("Select one "+n.TableName+" PLEASE;");u.UI.Modal.ShowDialog("Attention !!","Are you sur to delete this "+n.TableName,function(r){if(r.Result!==u.UI.MessageResult.ok)return t&&t({Api:i,Data:n,Error:f.basics.DataStat.OperationCanceled});i._vars.requester.Request(n.GetType(),"DELETE",n,n,function(r,u,e){if(e){var o=i.getDefaultList();o&&o.Remove(n)}t&&t({Api:i,Data:n,Error:e?f.basics.DataStat.Success:f.basics.DataStat.Fail})||i.ShowInfo(e?"The "+n.TableName+" :"+n.toString()+"  Deleted!! ":"Could Not Delete The "+n.TableName+" :"+n.toString(),!1)})},"DELETE","Let's")},n.prototype.Edit=function(n,t,r){var e=this,o=n.CreateBackup(),h=function(){e.Check(n,function(n){switch(n.Error){case f.basics.DataStat.Success:return c();case f.basics.DataStat.Fail:case f.basics.DataStat.UnknownStat:case f.basics.DataStat.DataCheckError:return u.UI.InfoArea.push(n.Error==f.basics.DataStat.DataCheckError?"Please Validate Your Data":"Fatal Error Occured"),s();case f.basics.DataStat.OperationCanceled:u.UI.InfoArea.push("Operation Cancled")}})},c=function(){e.Save(n,function(i){switch(i.Error){case f.basics.DataStat.Success:return u.UI.InfoArea.push(n.TableName+" Successfully saved"),n.Commit(o),t&&t(i),e.EditData.NativeClose(u.UI.MessageResult.ok,!0);case f.basics.DataStat.OperationCanceled:return u.UI.InfoArea.push("Operation Cancled"),n.Rollback(o),t&&t(i),e.EditData.NativeClose(u.UI.MessageResult.cancel,!0);case f.basics.DataStat.Fail:case f.basics.DataStat.UnknownStat:case f.basics.DataStat.DataCheckError:u.UI.InfoArea.push(i.Error==f.basics.DataStat.DataCheckError?"Please Validate Your Data":"Fatal Error Occured");return}})},l=function(f,s){s.CommitOrBackupHandled=!0;var c;if(s.E.Result==u.UI.MessageResult.ok){if((r||s.IsDataChanged)&&s.Editor.IsEditable)return s.E.StayOpen(),h();c=i.basic.DataStat.OperationCanceled}n.Rollback(o,!1);t&&t({Api:e,Data:n,E:s,Error:i.basic.DataStat.OperationCanceled})},s=function(){e.EditData.edit(n,undefined,l,!0)};s()},n.prototype.Show=function(n,t,r){var u=this;r?this.Edit(n,t):this.EditData.edit(n,undefined,function(n,r){r.Data.Rollback(r.BackupData);r.CommitOrBackupHandled=!0;t&&t({Api:u,Data:r.Data,E:r,Error:i.basic.DataStat.OperationCanceled})},!1)},n.prototype.OpenList=function(n,t){var i=this.getEditList();i?i.show(t,n):u.UI.InfoArea.push("This data has no template editor yet")},n.prototype.Update=function(n){if(!n)return this.UpdateAll();if(n.Stat=r.sdata.DataStat.Updating,n instanceof r.sdata.DataRow)this.UpdateData(n);else if(n instanceof r.sdata.DataTable)this.UpdateList(n,n.Owner);else throw new Error("UnExpected Type Of Data");},n.prototype.SmartUpdate=function(){var n=this.GetArrayType();this._vars.requester.Request(n,"SUPDATE",null,{})},n.prototype.UpdateData=function(n,t){var i=this;this._vars.requester.Request(n.GetType(),"UPDATE",n,n,function(r,u,f){return i.callback(t,n,f)})},n.prototype.UpdateList=function(n,t,i){var r=this;this._vars.requester.Get(n.GetType(),n,{OwnerId:t&&t.Id},function(t,u,f){return r.callback(i,void 0,f,n)})},n.prototype.UpdateAll=function(n){var t=this;this._vars.requester.Get(this.GetArrayType(),this.getDefaultList(),{FromDate:0},function(i,r,u){return t.callback(n,void 0,u,t.getDefaultList())})},n.prototype.Select=function(n,t,i){var r=this;return this.getEditList().show(function(t,f,e){r.callback(n,f,e==u.UI.MessageResult.ok,i||r.getDefaultList())},i||this.getDefaultList()),this.getEditList().OnInitialized=function(n){return n.SelectedItem=t},this.getEditList()},n.prototype.CreateNew=function(n){var t=this;this.New(function(i){if(i.Error==f.basics.DataStat.Success){var r;t.Edit(i.Data,r=function(i){var o=i.Error===f.basics.DataStat.Success,e;switch(i.Error){case f.basics.DataStat.Success:e=t.getDefaultList();e&&e.Add(i.Data);break;case f.basics.DataStat.Fail:case f.basics.DataStat.UnknownStat:return u.UI.InfoArea.push("Fatal Error Occured"),t.Edit(i.Data,r);case f.basics.DataStat.OperationCanceled:u.UI.InfoArea.push("Operation Cancled");break;case f.basics.DataStat.DataCheckError:return u.UI.InfoArea.push("Please Validate Your Data"),t.Edit(i.Data,r)}t.callback1(n,i)})}else t.callback1(n,i)})},n}();t.EMyApi=o;i.basic.DataStat.DataCheckError;s=function(){function n(n,t,i){this.Init(n,t,i)}return n.prototype.ShowInfo=function(n,t,i){u.UI.InfoArea.push(n,t,i)},n.prototype.getAction=function(n){return n==undefined?this._action:this._action.Clone(n)},Object.defineProperty(n.prototype,"EditData",{get:function(){return!this._catModal&&this._templateName&&(this._catModal=new u.UI.Modals.ModalEditer(this._templateName)),this._catModal},enumerable:!0,configurable:!0}),n.prototype.getEditList=function(){return!this._listModal&&this._listTemplateName&&(this._listModal=new u.UI.Modals.ModalList(undefined,this._listTemplateName.templateName,this._listTemplateName.itemTemplateName),this._listModal.OnInitialized=function(n){return n.setWidth("90%")}),this._listModal},n.prototype.Init=function(n,t,i){this._action=u.UI.Modals.EditorAction.Create(this,this.OnModalSuccess,this.OnModalError,this.defaultCallback);this._vars=n;i instanceof u.UI.Modals.ModalList?this._listModal=i:this._listTemplateName=i;typeof t=="string"?this._templateName=t:this._catModal=t},n.prototype.Open=function(n,t,i){var r=this.EditData;r?r.edit(n,t,i):u.UI.InfoArea.push("This data has no template editor yet")},n.prototype.OpenList=function(n,t){var i=this.getEditList();i?i.show(t,n):u.UI.InfoArea.push("This data has no template editor yet")},n.prototype.Update=function(n){if(!n)return this.UpdateAll();if(n.Stat=r.sdata.DataStat.Updating,n instanceof r.sdata.DataRow)this.UpdateData(n);else if(n instanceof r.sdata.DataTable)this.UpdateList(n,n.Owner);else throw new Error("UnExpected Type Of Data");},n.prototype.SmartUpdate=function(){var n=this.getDefaultList().GetType();this._vars.requester.Request(n,"SUPDATE",null,{})},n.prototype.Get=function(){throw new Error("Method not implemented.");},n.prototype.Select=function(n,t,i){return this.getEditList().show(n,i||this.getDefaultList()),this.getEditList().OnInitialized=function(n){return n.SelectedItem=t},this.getEditList()},n.prototype.CreateNew=function(n){var t=this;this.New(function(i,r,e){if(e==f.basics.DataStat.Success){var o;t.Edit(!0,i,r,o=function(i,r,e){var s=e===f.basics.DataStat.Success;switch(e){case f.basics.DataStat.Success:t.getDefaultList().Add(i);break;case f.basics.DataStat.Fail:case f.basics.DataStat.UnknownStat:return u.UI.InfoArea.push("Fatal Error Occured"),t.Edit(!0,i,r,o);case f.basics.DataStat.OperationCanceled:u.UI.InfoArea.push("Operation Cancled");break;case f.basics.DataStat.DataCheckError:return u.UI.InfoArea.push("Please Validate Your Data"),t.Edit(!0,i,r,o)}n&&n(s?i:null)})}},!1,!1)},n}();t.MyApi=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.close=function(n,t){this._vars.requester.Request(n.GetType(),"CLOSE",n,n,function(i,r,f){f?n.IsOpen=!1:u.UI.Modal.ShowDialog("Critical Error","The Data was Saved But Closed Yet");t&&t(n,f)})},t.prototype.Discart=function(n){this._vars.requester.Request(n.GetType(),"FORCECLOSE",null,n,function(t,i,r){r&&(u.UI.InfoArea.push("The Facture Closed Successfully"),n.IsOpen=!1)})},t.prototype.OpenFacture=function(n,t){this._vars.requester.Request(n.GetType(),"OPEN",n,n,function(i,r,u){u&&(i.data.IsOpen=!0);t&&t(n,u)})},t.prototype.CloseFacture=function(n,t){return this.close(n,t)},t.prototype.EOpenFacture=function(n){var t=this;n.IsOpen==null&&(n.IsOpen=!1);n.IsOpen?this.close(n,function(n,i){if(i){if(n instanceof e.models.SFacture)return t._vars.apis.SVersment.Regler(n,n.Fournisseur);if(n instanceof e.models.Facture)return t._vars.apis.Versment.Regler(n,n.Client)}u.UI.Modal.ShowDialog("Critical Error","The Facture Is Saved But doesn't Closed <br> Fatal Error When Closing The Facture")}):this._vars.requester.Request(n.GetType(),"OPEN",n,n,function(t,i,r){r?n.IsOpen=!0:u.UI.Modal.ShowDialog("Critical Error","It'seem that the facture cannot be opened . Sory")})},t.prototype.CreateNew=function(t){n.prototype.CreateNew.call(this,function(n){i.Api.RiseApi("OpenFactureInfo",{callback:function(n){t(n.data)},data:n})})},t}(s);t.FactureBase=h;c=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.close=function(n,t){var i=this;this._vars.requester.Request(n.GetType(),"CLOSE",n,n,function(r,f,o){e.models.Login;o?n.IsOpen=!1:u.UI.Modal.ShowDialog("Critical Error","The Data was Saved But Closed Yet");i.callback(t,r.data,o)})},t.prototype.Discart=function(n){this._vars.requester.Request(n.GetType(),"FORCECLOSE",null,n,function(t,i,r){r&&(u.UI.InfoArea.push("The Facture Closed Successfully"),n.IsOpen=!1)})},t.prototype.EOpenFacture=function(n){var t=this;n.IsOpen==null&&(n.IsOpen=!1);n.IsOpen?this.close(n,function(r){if(r.Error==i.basic.DataStat.Success){if(n instanceof e.models.SFacture)return t._vars.apis.SVersment.Regler(n,n.Fournisseur);if(n instanceof e.models.Facture)return t._vars.apis.Versment.Regler(n,n.Client)}u.UI.Modal.ShowDialog("Critical Error","The Facture Is Saved But doesn't Closed <br> Fatal Error When Closing The Facture")}):this._vars.requester.Request(n.GetType(),"OPEN",n,n,function(t,i,r){r?n.IsOpen=!0:u.UI.Modal.ShowDialog("Critical Error","It'seem that the facture cannot be opened . Sory")})},t.prototype.CreateNew=function(t){var r=this;n.prototype.CreateNew.call(this,function(n){n.Error==i.basic.DataStat.Success&&i.Api.RiseApi("OpenFactureInfo",{callback:function(n){r.callback(t,n.data,!0)},data:n.Data})})},t}(o);t.EFactureBase=c});define("abstract/Apis/Agent",["require","exports","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/AdminApis","../../lib/Q/sys/System"],function(n,t,i,r,u,f){"use strict";var e,o;Object.defineProperty(t,"__esModule",{value:!0});e=function(n){function t(t){return n.call(this,t,"Agent.edit",{templateName:"Agents.table",itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return r.models.Agents},t.prototype.GetArgType=function(){return r.models.Agent},t.prototype.getDefaultList=function(){return this._vars.__data.Agents},t}(u.EMyApi);t.Agent=e;o=function(n){function t(t){return n.call(this,t,"SMS.edit")||this}return __extends(t,n),t.prototype.Check=function(n,t){var r=i.basic.DataStat.Success;n.To==null?r=i.basic.DataStat.DataCheckError:n.Title||n.Message?n.To==this._vars.user.Client?r=i.basic.DataStat.DataCheckError:n.To==n.From&&(r=i.basic.DataStat.DataCheckError):r=i.basic.DataStat.DataCheckError;t&&t({Api:this,Data:n,Error:r})},t.prototype.GetArrayType=function(){return r.models.SMSs},t.prototype.GetArgType=function(){return r.models.SMS},t.prototype.getDefaultList=function(){return this._vars.__data.SMSs},t.prototype.Update=function(t,u){if(t instanceof f.sdata.DataRow)return n.prototype.Update.call(this,t);this._vars.requester.Request(r.models.SMSs,"Update",t,{param:u||t.Tag},function(n,r,u,f){u&&t.Clear();t.FromCsv(f.Response,i.encoding.SerializationContext.GlobalContext.reset())})},t.prototype.SaveProperty=function(n,t,i){this._vars.requester.Request(n.getType(),"SetProperty",t,{Id:n.Id},i)},t}(u.EMyApi);t.SMS=o});define("abstract/Apis/Article",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"Article.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.Articles},t.prototype.GetArgType=function(){return i.models.Article},t.prototype.NativeCreateItem=function(n){return new i.models.Article(n)},t.prototype.Check=function(n,t){this.callback(t,n,(n&&n.Product)!=null)},t.prototype.getDefaultList=function(){return void 0},t}(r.EMyApi);t.Article=u});define("abstract/Apis/Category",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"Category.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.Categories},t.prototype.GetArgType=function(){return i.models.Category},t.prototype.Check=function(n,t){this.callback(t,n,n.Name!=null&&n.Name.trim()!="")},t.prototype.getDefaultList=function(){return this._vars.__data.Categories},t}(r.EMyApi);t.Category=u});define("abstract/Apis/Client",["require","exports","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(n){function t(t){return n.call(this,t,"Client.edit",{templateName:"Client.table1",itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetMyId=function(n){var u=this,t=this._vars.user.Client;this._vars.requester.Request(r.models.Client,i.net.WebRequestMethod.Get,t,{GetMyId:!0},function(i,r,f){u.callback(n,t,f)})},t.prototype.GetArrayType=function(){return r.models.Clients},t.prototype.GetArgType=function(){return r.models.Client},t.prototype.getDefaultList=function(){return this._vars.__data.Costumers},t}(u.EMyApi);t.Client1=f});define("abstract/Apis/Projet",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"Projet.edit",{templateName:"Projet.table1",itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.Projets},t.prototype.GetArgType=function(){return i.models.Projet},t.prototype.getDefaultList=function(){return this._vars.__data.Projets},t}(r.EMyApi);t.Projet=u});define("abstract/Apis/FactureAchat",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/AdminApis","abstract/extra/Basics","../../lib/q/sys/System"],function(n,t,i,r,u,f,e,o){"use strict";var s,h,c;Object.defineProperty(t,"__esModule",{value:!0});s=function(n){function t(t){return n.call(this,t,"SSFacture.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return u.models.SFactures},t.prototype.GetArgType=function(){return u.models.SFacture},t.prototype.GetLastArticlePrice=function(n,t,i,u,e){this._vars.requester.Costume({Url:__global.ApiServer.Combine("/_/pstat/LastArticleSolded").FullPath+("?Id="+t.Id+"&CID="+(n&&n.Id)+"&Befor="+(i&&f.dateToUTC(i))+(e?"":"&price")),HasBody:!1,Method:r.net.WebRequestMethod.Get},undefined,{},function(n,t){u&&u(t)},this)},t.prototype.UpdateArticlesOf=function(n,t){if(!n)return t&&t(null,!1,e.basics.DataStat.DataCheckError);var i=n.IsFrozen();n.UnFreeze();n.Articles==null?n.Articles=new u.models.FakePrices(n,[]):n.Articles.Clear();this._vars.requester.Get(u.models.FakePrices,n.Articles,n,function(r,u,f){f&&(n.Articles.Stat=o.sdata.DataStat.Updated);i?n.Freeze():n.UnFreeze();t&&t(r.param,!1,f?e.basics.DataStat.Success:e.basics.DataStat.Fail)},null,null,{Id:String(n.Id)})},t.prototype.LoadArticlesOf=function(n,t){return n?!n.IsOpen&&(n.Articles==null||!n.Articles.Stat)?this.UpdateArticlesOf(n,t):t(n,undefined,e.basics.DataStat.Success):t(null,undefined,e.basics.DataStat.DataCheckError)},t.prototype.UpdateData=function(n,t,i){this._vars.requester.Request(u.models.SFacture,"UPDATE",n,n,t,i)},t.prototype.UpdateList=function(n,t,i,r){this._vars.requester.Get(u.models.SFactures,n,{OwnerId:t&&t.Id},i,r)},t.prototype.UpdateAll=function(n,t){this._vars.requester.Get(u.models.SFactures,this._vars.__data.SFactures,{FromDate:0},n,t)},t.prototype.Check=function(){return!0},t.prototype.Avaible=function(n){return n?n(this._vars.__data.SFactures,undefined,e.basics.DataStat.Fail)||!0:!0},t.prototype.New=function(n){return this.Create(n),void 0},t.prototype.Create=function(n){function f(n){t.GData.apis.Fournisseur.Select(function(u){var e=u.Data;if(u.Error===r.basic.DataStat.Success){if(!e)return i.UI.InfoArea.push("You must selet a fournisseur"),f(n);t.Fournisseur=e;n&&n()}else t.Fournisseur=null,n&&n()},t.Fournisseur)}function e(n){t.GData.apis.Agent.Select(function(u){var f=u.Data;u.Error===r.basic.DataStat.Success?(f||(i.UI.InfoArea.push("You must selet an Achteur"),e(n)),t.Agent=f,n&&n()):(t.Agent=null,n&&n())},t.Agent)}function s(){if(!t.Fournisseur||!t.Agent)return i.UI.InfoArea.push("The Creation of Facture Canceled"),n(null,!0,r.basic.DataStat.OperationCanceled);t.Facture=new u.models.SFacture(0);t.GData.requester.Request(u.models.SFacture,"CREATE",t.Facture,{AId:t.Agent.Id,FId:t.Fournisseur.Id},function(u,e,s){s?(t.GData.__data.SFactures.Add(u.data),n(u.data,!0,r.basic.DataStat.Success)):(i.UI.InfoArea.push("Creation of Facture Failed"),f(o))})}function o(){return t.Fournisseur?e(s):(i.UI.InfoArea.push("The Creation of Facture Canceled"),n(null,!0,r.basic.DataStat.OperationCanceled))}var t={GData:this._vars};f(o)},t.prototype.Save=function(n,t,r){var f=this;return this.Check(n)?this._vars.requester.Request(u.models.SFacture,"SAVE",n,null,function(u,o,s){if(s){i.UI.InfoArea.push("The SFacture Successfully Saved",!0);t&&f._vars.__data.SFactures.Add(n);try{n.Recalc();n.NArticles=n.Articles.Count}catch(h){}n.Commit();r&&r(n,t,e.basics.DataStat.Success);return}i.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The SFacture",!1,8e3);r&&r(n,t,e.basics.DataStat.Fail);n.Rollback()}):r&&r(n,t,e.basics.DataStat.DataCheckError),!0},t.prototype.Delete=function(n,t,r){var f=this;if(!t)return this.ShowInfo("Select one SFacture PLEASE;");i.UI.Modal.ShowDialog("Confirmation !!","Are you sur to delete this SFacture",function(o){if(o.Result!==i.UI.MessageResult.ok)return r&&r(t,undefined,e.basics.DataStat.OperationCanceled);n?f._vars.requester.Request(u.models.SFacture,"DELETE",t,t,function(n,i,u){u&&f.deleteData(t);r&&r(t,!1,u?e.basics.DataStat.Success:e.basics.DataStat.Fail)||f.ShowInfo(u?"The SFacture :"+t.toString()+"  Deleted!! ":"Could Not Delete The SFacture :"+t.toString(),!1)}):(f.deleteData(t),r&&r(t,!1,e.basics.DataStat.Success)||f.ShowInfo("The SFacture :"+t.toString()+"  Deleted!! from App ",!0))},"DELETE","Let's")},t.prototype.deleteData=function(n){this._vars.__data.Factures.UnFreeze();this._vars.__data.SFactures.Remove(n)},t.prototype.Edit=function(n,t,r,u){t?this.EditData.edit(t,!1,this.getAction(u)):u&&u(t,r,e.basics.DataStat.DataCheckError)||i.UI.InfoArea.push("Select one SFacture PLEASE;")},t.prototype.OnModalSuccess=function(n,t,i){return this.Save(n,t,i)},t.prototype.OnModalError=function(n,t,r){return(i.UI.InfoArea.push("The Modification Aborded",!0,2500),r)?r(n,t,e.basics.DataStat.OperationCanceled):!1},t.prototype.Print=function(){},t.prototype.Validate=function(n,t,r){var f=this;return this.Check(n)?this._vars.requester.Request(u.models.SFacture,"VALIDATE",n,{Validate:n.Id},function(u,o,s){if(s){i.UI.InfoArea.push("The SFacture Successfully Saved",!0);n.IsValidated=!0;t&&f._vars.__data.SFactures.Add(n);try{n.Recalc();n.NArticles=n.Articles.Count}catch(h){}n.Commit();r&&r(n,t,e.basics.DataStat.Success);return}i.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The SFacture",!1,8e3);r&&r(n,t,e.basics.DataStat.Fail);n.Rollback()}):r&&r(n,t,e.basics.DataStat.DataCheckError),!0},t.prototype.OpenFacture=function(n,t){this._vars.requester.Request(u.models.SFacture,"OPEN",n,n,function(i,r,u){t(n,!1,u?e.basics.DataStat.Success:e.basics.DataStat.Fail)},null,null)},t.prototype.CloseFacture=function(n,t){this._vars.requester.Request(u.models.SFacture,"CLOSE",n,n,function(i,r,u){u?t(n,!1,e.basics.DataStat.Success):t(n,!1,e.basics.DataStat.Fail)})},t.prototype.IsFactureOpen=function(n,t){this._vars.requester.Request(u.models.SFacture,"ISOPEN",n,n,function(i,r,u){u?t(n,!1,e.basics.DataStat.Success):t(n,!1,e.basics.DataStat.Fail)})},t.prototype.getDefaultList=function(){return this._vars.__data.SFactures},t}(f.FactureBase);t.SFacture=s;h=function(n){function t(t){return n.call(this,t,"templates.carticleedit",{templateName:null,itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return u.models.CArticles},t.prototype.GetArgType=function(){return u.models.CArticle},t.prototype.getDefaultList=function(){return null},t}(f.EMyApi);t.CArticle=h;c=function(n){function t(t){return n.call(this,t,"templates.carticleedit",{templateName:"templates.commands",itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return u.models.Commands},t.prototype.GetArgType=function(){return u.models.Command},t.prototype.getDefaultList=function(){return null},t}(f.EMyApi);t.Command=c});define("abstract/Apis/FactureVent",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/AdminApis","abstract/extra/Basics","../../lib/q/sys/System"],function(n,t,i,r,u,f,e,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(t){return n.call(this,t,"Facture.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return u.models.Factures},t.prototype.GetArgType=function(){return u.models.Facture},t.prototype.GetLastArticlePrice=function(n,t,i,u,f){this._vars.requester.Costume({Url:__global.ApiServer.Combine("/_/pstat/LastArticlePurchased").FullPath+("?Id="+t.Id+"&CID="+n.Id+"&Befor="+(i&&i.toISOString())+(f?"":"&price")),HasBody:!1,Method:r.net.WebRequestMethod.Get},undefined,{},function(n,t){u&&u(t)},this)},t.prototype.LoadArticlesOf=function(n,t){return n?!n.IsOpen&&(n.Articles==null||!n.Articles.Stat)?this.UpdateArticlesOf(n,t):t(n,undefined,e.basics.DataStat.Success):t&&t(null,undefined,e.basics.DataStat.DataCheckError)},t.prototype.UpdateArticlesOf=function(n,t){if(!n)return t&&t(null,!1,e.basics.DataStat.DataCheckError);var i=n.IsFrozen();n.UnFreeze();n.Articles==null?n.Articles=new u.models.Articles(n,[]):n.Articles.Clear();this._vars.requester.Get(u.models.Articles,n.Articles,n,function(r,u,f){f&&(n.Articles.Stat=o.sdata.DataStat.Updated);i&&n.Freeze();t&&t(r.param,!1,f?e.basics.DataStat.Success:e.basics.DataStat.Fail)},null,null,{Id:String(n.Id)})},t.prototype.UpdateData=function(n,t,i){var r=n.IsFrozen();r&&n.UnFreeze();this._vars.requester.Request(u.models.Facture,"UPDATE",n,n,function(i,u,f,e){r&&n.Freeze();t&&t(i,u,f,e)},i)},t.prototype.UpdateList=function(n,t,i,r){this._vars.requester.Get(u.models.Factures,n,{OwnerId:t&&t.Id},i,r)},t.prototype.UpdateAll=function(n,t){this._vars.requester.Get(u.models.Factures,this._vars.__data.Factures,{FromDate:0},n,t)},t.prototype.Check=function(){return!0},t.prototype.Avaible=function(n){return n?n(this._vars.__data.Factures,undefined,e.basics.DataStat.Fail)||!0:!0},t.prototype.New=function(n){return this.Create(n)},t.prototype.Create=function(n){function f(n,u,e){t.apis.Client.Select(function(t){var u=t.Data;if(t.Error==r.basic.DataStat.Success){if(!u)return i.UI.InfoArea.push("You must selet a client"),f(n,u,e);n&&n(u,e)}else n&&n(null,e)},u);t.__data.Projets}function e(o,s){if(!o)return i.UI.InfoArea.push("The Creation of Facture Canceled"),n(null,!0,r.basic.DataStat.OperationCanceled);var s=s||new u.models.Facture(0);t.requester.Request(u.models.Facture,"CREATE",s,{CId:o.Id},function(u,h,c){c?(t.__data.Factures.Add(u.data),n(u.data,!0,r.basic.DataStat.Success)):(i.UI.InfoArea.push("Creation of Facture Failed"),f(e,o,s))})}var t=this._vars;f(e,null,null)},t.prototype.Save=function(n,t,r){var f=this;return this.Check(n)?this._vars.requester.Request(u.models.Facture,"SAVE",n,null,function(u,o,s){if(s){i.UI.InfoArea.push("The Facture Successfully Saved",!0);t&&f._vars.__data.Factures.Add(n);try{n.Recalc()}catch(h){}n.Commit();r&&r(n,t,e.basics.DataStat.Success);return}i.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The Facture",!1,8e3);r&&r(n,t,e.basics.DataStat.Fail);n.Rollback()}):r&&r(n,t,e.basics.DataStat.DataCheckError),!0},t.prototype.Validate=function(n,t,r){var f=this;return this.Check(n)?n&&this._vars.requester.Request(u.models.Facture,"VALIDATE",n,{Validate:n.Id},function(u,o,s){if(s){i.UI.InfoArea.push("The SFacture Successfully Saved",!0);n.IsValidated=!0;try{n.Recalc();n.MakeChange(function(n){return n.NArticles=n.Articles.Count},n)}catch(h){}t&&f._vars.__data.Factures.Add(n);n.Commit();r&&r(n,t,e.basics.DataStat.Success);return}i.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The SFacture",!1,8e3);r&&r(n,t,e.basics.DataStat.Fail);n.Rollback()},null,null):r&&r(n,t,e.basics.DataStat.DataCheckError),!0},t.prototype.Delete=function(n,t,r){var f=this;if(!t)return this.ShowInfo("Select one Facture PLEASE;");i.UI.Modal.ShowDialog("Confirmation !!","Are you sur to delete this Facture",function(o){if(o.Result!==i.UI.MessageResult.ok)return r&&r(t,undefined,e.basics.DataStat.OperationCanceled);n?f._vars.requester.Request(u.models.Facture,"DELETE",t,t,function(n,i,u){u&&f.deleteData(t);r&&r(t,!1,u?e.basics.DataStat.Success:e.basics.DataStat.Fail)||f.ShowInfo(u?"The Facture :"+t.toString()+"  Deleted!! ":"Could Not Delete The Facture :"+t.toString(),!1)},null,null,{Id:String(t.Id)}):(f.deleteData(t),r&&r(t,!1,e.basics.DataStat.Success)||f.ShowInfo("The Facture :"+t.toString()+"  Deleted!! from App ",!0))},"DELETE","Let's")},t.prototype.deleteData=function(n){this._vars.__data.Factures.UnFreeze();this._vars.__data.Factures.Remove(n)},t.prototype.Edit=function(n,t,r,u){t?this.EditData.edit(t,!1,this.getAction(u)):u&&u(t,r,e.basics.DataStat.DataCheckError)||i.UI.InfoArea.push("Select one Facture PLEASE;")},t.prototype.Print=function(n){var t=this;i.UI.Modal.ShowDialog("Confirmation","Do you want realy to Print this Facture",function(r){r.Result===i.UI.MessageResult.ok&&t._vars.requester.Request(u.models.Facture,"PRINT",n,n,function(t,r,u){u?i.UI.InfoArea.push("You Facture Printed Successfully"):i.UI.InfoArea.push("UnResolved Stat When We Print the facture "+n.Ref)})},"PRINT")},t.prototype.OnModalSuccess=function(n,t,i){return this.Save(n,t,i)},t.prototype.OnModalError=function(n,t,r){return(i.UI.InfoArea.push("The Modification Aborded",!0,2500),r)?r(n,t,e.basics.DataStat.OperationCanceled):!1},t.prototype.getDefaultList=function(){return this._vars.__data.Factures},t}(f.FactureBase);t.Facture=s});define("abstract/Apis/Fournisseur",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"Fournisseur.edit",{templateName:"Fournisseur.table",itemTemplateName:null})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.Fournisseurs},t.prototype.GetArgType=function(){return i.models.Fournisseur},t.prototype.getDefaultList=function(){return this._vars.__data.Fournisseurs},t}(r.EMyApi);t.Fournisseur=u});define("abstract/Apis/Product",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"iProduct.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.Products},t.prototype.GetArgType=function(){return i.models.Product},t.prototype.SmartUpdate=function(n){this._vars.requester.Request(i.models.Products,"SUPDATE",null,{Date:n&&n.toLocaleString()||"12/12/2016"})},t.prototype.getDefaultList=function(){return this._vars.__data.Products},t}(r.EMyApi);t.Product=u});define("abstract/Apis/Revage",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t,"Price.edit")||this}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.FakePrices},t.prototype.GetArgType=function(){return i.models.FakePrice},t.prototype.NativeCreateItem=function(n){return new i.models.FakePrice(n)},t.prototype.Check=function(n,t){var i=!0;n.Product==null&&(i=!1);n.PSel>n.Value?i=!1:(n.Value>n.PValue&&(n.PValue=n.Value),n.PValue>n.HWValue&&(n.HWValue=n.PValue),n.HWValue>n.WValue&&(n.WValue=n.HWValue));this.callback(t,n,i)},t.prototype.getDefaultList=function(){return void 0},t}(r.EMyApi);t.Revage=u});define("abstract/Apis/Versment",["require","exports","abstract/extra/AdminApis","../../lib/Q/sys/UI","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/Basics","../../lib/Q/sys/System"],function(n,t,i,r,u,f,e,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(t){return n.call(this,t,"Versment.cart",{templateName:"Versments.CardView",itemTemplateName:undefined})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return f.models.Versments},t.prototype.GetArgType=function(){return f.models.Versment},t.prototype.NativeCreateItem=function(n){return new f.models.Versment(n)},t.prototype.getDefaultList=function(){return void 0},t.prototype.VerserTo=function(n,t,i,f){var o=this;t=t||n&&n.Client;t||this._vars.apis.Client.Select(function(f){var s=f.Data;if(f.Error==u.basic.DataStat.Success)return s&&o.VerserTo(n,s,i),r.UI.InfoArea.push("You are'nt select any fournisseur"),o.VerserTo(n,t,i);r.UI.InfoArea.push("Versment est abondonnee");i&&i(null,!1,e.basics.DataStat.OperationCanceled)},t);this.New(function(u){var s=u.Data;u.Error==e.basics.DataStat.Success?(s.Client=t,s.Facture=n,o.Edit(s,function(n){var t=n.Data;n.Error===e.basics.DataStat.Success?t.Client.VersmentTotal+=t.Montant:r.UI.InfoArea.push("Versment est annulé");i&&i(t,!0,n.Error)}),s.Montant=f||0):(r.UI.InfoArea.push("An Expected error while creating a Versment "),i&&i(s,!0,u.Error))})},t.prototype.Regler=function(n,t,i){var e=this;if(!n&&!t)return r.UI.InfoArea.push("Vous devez au moin selectioner soit un fournisseur au une facture.");n?this._vars.requester.Request(f.models.Versments,"Facture.Total",void 0,n,function(r,u){n.MakeChange(function(n){this.Recalc();this.Versment=n||0},u);n.Sold!=0&&e.VerserTo(n,t,i,n.Sold)}):this._vars.apis.Client.UpdateData(t,function(f){f.Error!=u.basic.DataStat.OperationCanceled&&(f.Error!==u.basic.DataStat.Success?r.UI.InfoArea.push("Une Error Produit Quant le versment est calcer"):e.VerserTo(n,t,i,t.SoldTotal))})},t.prototype.Get=function(n){var t=f.models.Versment.getById(n,f.models.Versment);return(!t||t.Stat<=o.sdata.DataStat.Modified)&&(t=t||new f.models.Versment(n),u.encoding.SerializationContext.GlobalContext.reset(),t.FromJson(n,u.encoding.SerializationContext.GlobalContext,!0)),t},t.prototype.OpenVersmentsOfClient=function(n,t){var u=this,i=new f.models.Versments(n);this._vars.requester.Request(f.models.Versments,"VClient",i,n,function(f,e,o){o?u.OpenList(i,function(u,f,e){t&&t(i,f,n,e===r.UI.MessageResult.ok)}):r.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenVersmentsOfFacture=function(n,t){var u=this,i=n.ClearVersments();this._vars.requester.Request(f.models.Versments,"VFacture",i,n,function(f,e,o){o?(n.Recalc(),u.OpenList(i,function(u,f,e){t&&t(i,f,n,e===r.UI.MessageResult.ok)})):r.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenVersmentsOfPour=function(n,t){var u=this,i=new f.models.Versments(n);this._vars.requester.Request(f.models.Versments,"VPour",i,n,function(f,e,o){o?u.OpenList(i,function(u,f,e){t&&t(i,f,n,e===r.UI.MessageResult.ok)}):r.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenVersmentsWithObservation=function(n,t){var u=this,i=new f.models.Versments(null);this._vars.requester.Request(f.models.Versments,"VObservation",i,{Observation:n},function(f,e,o){o?u.OpenList(i,function(u,f,e){t&&t(i,f,n,e===r.UI.MessageResult.ok)}):r.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenVersmentsWithPeriod=function(n,t){var u=this,i=new f.models.Versments(null);this._vars.requester.Request(f.models.Versments,"VObservation",i,n,function(f,e,o){o?u.OpenList(i,function(u,f,e){t&&t(i,f,n,e===r.UI.MessageResult.ok)}):r.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t}(i.EMyApi);t.Versment=s});define("abstract/Apis/SVersment",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/corelib","abstract/Models","abstract/extra/AdminApis","abstract/extra/Basics"],function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(n){function t(t){return n.call(this,t,"SVersment.cart",{templateName:"SVersment.list",itemTemplateName:undefined})||this}return __extends(t,n),t.prototype.GetArrayType=function(){return u.models.SVersments},t.prototype.GetArgType=function(){return u.models.SVersment},t.prototype.NativeCreateItem=function(n){return new u.models.SVersment(n)},t.prototype.VerserTo=function(n,t,r,u){var f=this;if(t=t||n&&n.Fournisseur,!t)return i.UI.InfoArea.push("Unvalid fournisseur ");this.New(function(o){var s=o.Data,h=o.Error;h==e.basics.DataStat.Success?(s.Fournisseur=t,s.Facture=n,f.Edit(s,function(n){var t=n.Data,u=n.Error;u===e.basics.DataStat.Success?t.Fournisseur.VersmentTotal+=t.Montant:i.UI.InfoArea.push("Versment est annulé");r&&r(t,!0,u)}),s.Montant=u||0):(i.UI.InfoArea.push("An Expected error while creating a Versment "),r&&r(s,!0,h))})},t.prototype.Regler=function(n,t,r){var f=this;if(this.OpenSVersmentsOfFacture,!n&&!t)return i.UI.InfoArea.push("Vous devez au moin selectioner soit un fournisseur au une facture.");n?this._vars.requester.Request(u.models.SVersments,"Facture.Total",void 0,n,function(i,u){n.MakeChange(function(n){this.Recalc();this.Versment=n||0},u);n.Sold!=0&&f.VerserTo(n,t,r,n.Sold)}):this.VerserTo(n,t,r,t.SoldTotal)},t.prototype.Get=function(n){var t=u.models.SVersment.getById(n,u.models.SVersment);return t||(t=new u.models.SVersment(n),r.encoding.SerializationContext.GlobalContext.reset(),t.FromJson(n,r.encoding.SerializationContext.GlobalContext,!0)),t},t.prototype.getDefaultList=function(){return void 0},t.prototype.OpenSVersmentsOfFournisseur=function(n,t){var f=this,r=new u.models.SVersments(n);this._vars.requester.Request(u.models.SVersments,"VFournisseur",r,n,function(u,e,o){o?f.OpenList(r,function(u,f,e){t&&t(r,f,n,e===i.UI.MessageResult.ok)}):i.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenSVersmentsOfFacture=function(n,t){var f=this,r=new u.models.SVersments(n);this._vars.requester.Request(u.models.SVersments,"VFacture",r,n,function(u,e,o){o?f.OpenList(r,function(u,f,e){t&&t(r,f,n,e===i.UI.MessageResult.ok)}):i.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenSVersmentsWithObservation=function(n,t){var f=this,r=new u.models.SVersments(null);this._vars.requester.Request(u.models.SVersments,"VObservation",r,{Observation:n},function(u,e,o){o?f.OpenList(r,function(u,f,e){t&&t(r,f,n,e===i.UI.MessageResult.ok)}):i.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t.prototype.OpenSVersmentsWithPeriod=function(n,t){var f=this,r=new u.models.SVersments(null);this._vars.requester.Request(u.models.SVersments,"VObservation",r,n,function(u,e,o){o?f.OpenList(r,function(u,f,e){t&&t(r,f,n,e===i.UI.MessageResult.ok)}):i.UI.InfoArea.push("The Server Respond With UnExpected Error")})},t}(f.EMyApi);t.SVersment=o});define("abstract/extra/ShopApis",["require","exports","abstract/Apis/Agent","abstract/Apis/Article","abstract/Apis/Category","abstract/Apis/Client","abstract/Apis/Projet","abstract/Apis/FactureAchat","abstract/Apis/FactureVent","abstract/Apis/Fournisseur","abstract/Apis/Product","abstract/Apis/Revage","abstract/Apis/Versment","abstract/Apis/SVersment"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function n(){}return n.prototype.Init=function(n){return this.vars=n,this.Agent=new i.Agent(n),this.Article=new r.Article(n),this.Client=new f.Client1(n),this.Category=new u.Category(n),this.SFacture=new o.SFacture(n),this.Facture=new s.Facture(n),this.Fournisseur=new h.Fournisseur(n),this.Product=new c.Product(n),this.Revage=new l.Revage(n),this.Versment=new a.Versment(n),this.SVersment=new v.SVersment(n),this.Projet=new e.Projet(n),this.Command=new o.Command(n),this.Sms=new i.SMS(n),this},n}();t.ShopApis=y});define("abstract/extra/Basics",["require","exports","../../lib/Q/sys/Corelib"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(n){n.DataStat=i.basic.DataStat})(r=t.basics||(t.basics={}))});define("abstract/Services",["require","exports","abstract/Models","../lib/q/sys/Corelib","../lib/q/sys/System","../lib/q/sys/UI","../lib/q/sys/Services"],function(n,t,i,r,u,f,e){"use strict";function a(n){e.Load(n.requester);s=n.requester;c=n;u.Controller.Register(new o.ProductsUpdater);u.Controller.Register(new o.FactureUpdater);u.Controller.Register(new o.PriceUpdater);u.Controller.Register(new o.SecurityAccountRequest);u.Controller.Register(new o.Updater)}var s,h,c,l,o;Object.defineProperty(t,"__esModule",{value:!0});h={},function(n){function t(n){h[n.Name]=n}n.registerUpdater=t}(l=t.eServices||(t.eServices={})),function(n){var v=r.bind.NamedScop.Get("qdata"),t=new r.encoding.SerializationContext(!0),l=i.models.Product.getById,a=function(){function n(){this.Name="products_qte_updater"}return n.prototype.OnResponse=function(n,i,r){var e=r.sdata,u;t.reset();for(u in e)this.UpdatePrice(parseInt(u),e[u]);f.UI.InfoArea.push("<p style='background:yellow'>Products <h1>Success<\/h1>-<h2>fully<\/h2> Updated<\/p>",!0);r.dropRequest=!0},n.prototype.UpdatePrice=function(n,r){var u=l(n);u?(u.Stat=4,u.FromJson(r,t,!0),u.Stat=16):t.FromJson(r,i.models.Product,null)},n}(),u,e,o,c;n.ProductsUpdater=a;u=function(){function n(){this.Name="updater"}return n.prototype.OnResponse=function(n,i,r){var o=r.sdata,u,s,e;if(t.reset(),u=h[r.table],u){if(u.onstart)u.onstart(r);for(s in o){e=o[s];try{typeof e=="number"?u.del(e):u.edit(e.Id,e,t)}catch(c){}}if(u.onfinish)u.onfinish(r)}f.UI.InfoArea.push("<p style='background:yellow'>"+u.Name.toUpperCase()+" <h1>Success<\/h1>-<h2>fully<\/h2> Updated<\/p>",!0);r.dropRequest=!0},n}();n.Updater=u;e=function(){function n(){this.Name="SecurityAccountRequest"}return n.prototype.OnResponse=function(n,t,i){var r=i;f.UI.Spinner.Default.Start("Your Account is open By "+r.OriginalIP+"\r\n Your IP Is : "+r.YourIP);setTimeout(function(){f.UI.Spinner.Default.Pause()},r.Wait|3e5);i.dropRequest=!0},n}();n.SecurityAccountRequest=e;o=function(){function n(){this.Name="facture_count_updater"}return n.prototype.OnResponse=function(n,t,r){var e=r.sdata,u=i.models.Facture.getById(e.id,i.models.Facture),v,b,o,p,w,h,c;e.for?(v=i.models.Client.getById(e.for),v||s.Get(i.models.Client,u.Client=new i.models.Client(e.for),null,function(n,t,i){i?u.Client=n.data:f.UI.InfoArea.push("Failed To Update The Costumer Info of this facture",!1)}),u.Client=v):u.Client=null;var l=u.Articles,y=e.articles,a="";for(b in y)o=parseFloat(b),p=l.GetById(o),p!=null?p.Count=y[o]:a+=a===""?o:","+o;for(w=l.AsList(),h=0;h<w.length;h++)c=w[h],y[c.Id]==null&&(l.Remove(c),c.getStore().Remove(c.Id),h--);a!==""?s.Get(i.models.Articles,new i.models.Articles(u),null,function(n,t,i){if(i){var r=n.data;l.AddRange(r.AsList());f.UI.InfoArea.push("Facture <h1>Success<\/h1>-<h2>fully<\/h2> Updated",!0);r.Clear();r.Dispose()}else f.UI.InfoArea.push("Facture <h1>UnSuccess<\/h1>-<h2>fully<\/h2> Updated",!0)},function(n){n.Url="/_/Articles?list="+a}):f.UI.InfoArea.push("Facture <h1>Success<\/h1>-<h2>fully<\/h2> Updated",!0);r.dropRequest=!0},n}();n.FactureUpdater=o;c=function(){function n(){this.Name="update_price"}return n.prototype.OnResponse=function(n,t,r){var u=r.sdata,f=i.models.FakePrice.pStore.Get(u.id);f||(f=new i.models.FakePrice(u.id),i.models.FakePrice.pStore.Set(u.id,f));f.Value=u.value},n}();n.PriceUpdater=c}(o||(o={}));t.Load=a});define("assets/data/data",["require","exports","json|./data.json"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.data={value:i.value,require:i.require}});define("abstract/extra/Common",["require","exports","../../lib/q/sys/UI","../../lib/q/sys/Corelib","context","abstract/Models","../../lib/q/sys/System","../../lib/q/sys/Encoding","abstract/Services","../../lib/q/sys/db","../../lib/Q/components/ActionButton/script","abstract/extra/ShopApis"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function k(n){y||(y=n(a))}function d(){i.UI.Desktop.Current.OnInitialized=function(n){return a.spin.Parent=n};o.init();s.Load(a);g()}function g(){window.data=a.__data;r.thread.Dispatcher.call(a.__data,a.__data.OnPropertyChanged,f.models.QData.DPSelectedFacture,function(n,t){var i=t._new;this.Value=t._new?i.IsOpen&&!i.Validator:!1},a.modify);r.bind.NamedScop.Create("qdata",a.__data);r.bind.NamedScop.Create("User",a.user,0);v.initializeOprs();var n=r.bind.Register(new r.bind.Job("showIfModifiable",function(n){var t=n.Scop.Value,i=n.dom;i.parentElement.style.display=(t?t.IsFrozen():!1)?"none":""},null,null,function(n){var i=n.dom,t=n.Scop.Value;i.parentElement.style.display=(t?t.IsFrozen():!1)?"none":""},function(){})),n=r.bind.Register(new r.bind.Job("ilabel",function(n){var t=n.dom;t.innerText=n.Scop.Value||"Personal"},null,null,function(n){var t=n.dom;t.innerText=n.Scop.Value||"Personal"},function(){})),n=r.bind.Register(new r.bind.Job("dosave",null,null,null,function(n){var t=n.dom;t.click=function(){var t=n.Scop.Value;t instanceof e.sdata.DataRow&&i.UI.Modal.ShowDialog("Confirm","Are you sure save data ?",function(n){n.Result===i.UI.MessageResult.ok&&t.Upload()},"Yes","No")}},null)),n=r.bind.Register(new r.bind.Job("dodiscart",null,null,null,function(n){var t=n.dom;t.click=function(){var t=n.Scop.Value;t instanceof e.sdata.DataRow&&i.UI.Modal.ShowDialog("Confirm","Are you sure discart data ?",function(n){n.Result===i.UI.MessageResult.ok&&t.Update()},"Yes","No")}},null));r.bind.Register({Name:"openfournisseur",OnInitialize:function(n){n.addEventListener("ondblclick","dblclick",function(){return a.apis.Fournisseur.Edit(n.Scop.Value)})}});r.bind.Register({Name:"opencostumer",OnInitialize:function(n){n.addEventListener("ondblclick","dblclick",function(){a.apis.Client.Edit(n.Scop.Value,void 0)})}})}var w,a,b,y,nt,v,tt,p;Object.defineProperty(t,"__esModule",{value:!0});w=u.context.GetEnum("models.Abonment");a={__data:new f.models.QData,modify:r.bind.NamedScop.Create("modify",!1,3),user:function(){var n=new f.models.Login;return n.Client=new f.models.Client(r.basic.New()),n}(),requester:e.Controller.ProxyData.Default,invalidateFactures:new r.collection.List(f.models.Facture),invalidateLogins:new r.collection.List(f.models.Login),validateLogins:new r.collection.List(f.models.Login),mails:new r.collection.List(f.models.Mail),spin:i.UI.Spinner.Default,apis:new l.ShopApis,db:(new h.db.Database).initialize()};a.apis.Init(a);b=r.bind.NamedScop.Create("UserAbonment",f.models.Abonment.Detaillant,r.bind.BindingMode.TwoWay);t.GetVars=k;t.InitModule=d,function(n){function u(n,t,r){var u=n.getTemplate;n.getTemplate=function(n){var f=u(new i.UI.Anchore(n));return f.Enable===!1?f.Enable=!1:f.addEventListener("click",r,{t:t,c:n.Type}),f}}function f(){var n=new i.UI.Glyph(i.UI.Glyphs.none,!1);return n.Enable=!1,n}function e(){return t||(t=new i.UI.Modals.ModalEditer("Price.edit"))}function o(){return r||(r=new i.UI.Modals.ModalList(undefined,"Price.info","Price.price"))}function s(n,t,r){var u,o,f,e;return t&&(u=new c.components.ActionButton,o=i.UI.Modals.CreateGlyph("label","filter","","default",{})),f=(new i.UI.Div).applyStyle("icontent-header"),e=document.createTextNode(n),f.View.appendChild(e),t&&(f.Add(u),u.Source=r),{BtnFilter:o,BtnAction:u,txtCaption:e,container:f}}function h(n){return n&&n.getTime()||0}var t,r;n.setTepmlate=u;n.createSparator=f;n.priceModal=e;n.pricesModal=o;n.initializeSBox=s;n.toNum=h}(nt=t.funcs||(t.funcs={})),function(n){function e(n){return n instanceof f.models.Article?n.Product:n}function l(n,t){var i=new f.models.Article(r.basic.New());return i.Product=n,t&&(i.Count=t),i.Price=n.IGetValue(a.__data.SelectedFacture.Abonment||a.user.Client.Abonment||f.models.Abonment.Detaillant),i.Owner=a.__data.SelectedFacture,a.__data.SelectedFacture.Articles.Add(i),i}function o(n,t){var t=t||n.CurrentArticle,i;t&&(i=a.__data.SelectedFacture,i.Articles.Remove(t),n.CurrentArticle=null)}function t(n,t,i){var r,u;if(!a.__data.QteLimited)return b(n,t,i);if(r=n.CurrentArticle,t=t!=null?t:(r&&r.Count||0)+i,u=n.Qte,r)u+=r.OCount;else{if(t<=0)return;r=l(n)}t<=0?o(n,r):r.Count=t<=u?t:u}function b(n,t,i){var r=n.CurrentArticle;if(t=t!=undefined?t:(r&&r.Count||0)+i,t==0)return r&&o(n,r);r?r.Count=t:r=l(n,t)}function k(n){var t=v[n],i,f,e;if(t)return t;if(i=n&&u.context.GetEnum(n),i==undefined)throw"type not found";f=[];for(e in i)isNaN(parseFloat(e))&&f.push(e);return t={list:new r.collection.List(String,f),type:i},t.list.Freeze(),Object.freeze(t),Object.freeze(t.list),Object.defineProperty(v,n,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}function d(){r.bind.Register(new s("prod-add"));r.bind.Register(new s("prod-plus"));r.bind.Register(new s("prod-remove"));r.bind.Register(new s("prod-minus"));r.bind.Register(new h("art-add"));r.bind.Register(new h("art-plus"));r.bind.Register(new h("art-remove"));r.bind.Register(new h("art-minus"));r.bind.Register(new r.bind.Job("calctotal",null,null,null,function(n){var i=n.dom,t;i.onclick=function(){var t=n.Scop.Value;t&&t.Recalc()};t=n.Scop.Value;t&&t.Recalc()},null));r.bind.Register(new r.bind.Job("calcsold",null,null,null,function(n){var i=n.dom,t;i.onclick=function(){var t=n.Scop.Value;t&&(n.dom.nextElementSibling.textContent=t.CalcTotal()||"0.00")};t=n.Scop.Value;t&&(n.dom.nextElementSibling.textContent=t.CalcTotal()||"0.00")},null))}function y(n){i.UI.Modal.ShowDialog("Confirmation","Are you Sure To <b>Delete<\/b> This Client",function(t){t.Result===i.UI.MessageResult.ok&&a.requester.Request(Number,"REMOVE",n,n,function(t,r,u){u?(a.invalidateLogins.Remove(n),a.validateLogins.IndexOf(n)==-1&&a.validateLogins.Remove(n),i.UI.InfoArea.push("The Client Successffuly <h2>Removed<\/h2>",!0,3e3)):i.UI.InfoArea.push("A <h2 style='color:red'>Error<\/h2> Occured When Removing A Client",!1)})},"DELETE","Cancel")}function p(n){a.requester.Request(Number,"VALIDATE",n,n,function(t,r,u){u?(a.invalidateLogins.Remove(n),a.validateLogins.IndexOf(n)==-1&&a.validateLogins.Add(n),i.UI.InfoArea.push("The Client Successffuly <h2>Validated<\/h2>",!0,3e3)):i.UI.InfoArea.push("A Error Occured When Validating A Client",!1)})}function w(n){if(n instanceof f.models.Login==!1)throw"invalid param";a.requester.Request(Number,"LOCK",n,n,function(t,r,u){u?(a.validateLogins.Remove(n),a.invalidateLogins.Add(n),i.UI.InfoArea.push("The Client Successffuly <h2>Locke<\/h2>",!0,3e3)):i.UI.InfoArea.push("A <h2 style='color:red'>Error<\/h2> Occured When Locking A Client",!1)})}function c(n,t){var f,u,e={OnSuccess:{Invoke:function(n){return u.callback(u,{data:n,iss:!0}),!0},Owner:null},OnError:{Invoke:function(n){return u.callback(u,{data:n,iss:!1}),!0},Owner:null}};r.Api.RegisterApiCallback({Name:t,DoApiCallback:function(t,r,o){f||(f=new i.UI.Modals.ModalEditer(n));u=o;f.edit(u.data,!1,e,!u.data.IsFrozen())}})}var v={},s=function(){function n(n){var t=this;this.Name=n;switch(n){case"prod-add":this.modadd=new i.UI.Modal;this.modadd.OnInitialized=function(n){return n.Add(t.t=new i.UI.NumericUpDown)};this.modadd.OnClosed.On=function(n){return t.addr(n.Modal,n.msg)};this.oper=this.add;return;case"prod-plus":this.oper=this.plus;return;case"prod-minus":this.oper=this.minus;return;case"prod-remove":this.oper=this.remove;return}throw"";}return n.prototype.Todo=function(){},n.prototype.Check=function(){},n.prototype.OnError=function(){},n.prototype.OnInitialize=function(n){var t=this;n.dom.addEventListener("click",function(){return t.oper(n)})},n.prototype.OnScopDisposing=function(){},n.prototype.addr=function(n,i){i=="ok"&&t(e(this.selectedJobInstance.Scop.Value),this.t.Value)},n.prototype.add=function(n){var t=this,r=a.__data.SelectedFacture;if(r==null)return i.UI.InfoArea.push("<p><h1>Select<\/h1> a facture<\/p>");this.selectedJobInstance=n;this.modadd.Open();this.modadd.OnInitialized=function(){t.t.Focus();var i=n.Scop.Value;i=i&&i.CurrentArticle;t.t.Value=i&&i.Count||0;t.t.SelectAll()}},n.prototype.plus=function(n){return t(n.Scop.Value,undefined,1)},n.prototype.minus=function(n){return t(n.Scop.Value,undefined,-1)},n.prototype.remove=function(n){var t=n.Scop.Value,r=t.CurrentArticle;r!=null&&i.UI.Modal.ShowDialog("Confirmation","Do you want realy  to delete this Article",function(n){n.Result===i.UI.MessageResult.ok&&o(t,r)})},n}(),h=function(){function n(n){var t=this;this.Name=n;switch(n){case"art-plus":this.oper=this.plus;return;case"art-minus":this.oper=this.minus;return;case"art-remove":this.oper=this.remove;return;case"art-add":this.modadd=new i.UI.Modal;this.modadd.OnInitialized=function(n){return n.Add(t.t=new i.UI.NumericUpDown)};this.modadd.OnClosed.On=function(n){return t.addr(n.Modal,n.msg)};this.oper=this.add;return}throw"";}return n.prototype.Todo=function(){},n.prototype.Check=function(){},n.prototype.OnError=function(){},n.prototype.OnInitialize=function(n){var t=this,i=n.dom;i.addEventListener("click",function(){t.oper(n)})},n.prototype.OnScopDisposing=function(){},n.prototype.addr=function(n,i){i=="ok"&&t(e(this.selectedScop.Scop.Value),this.t.Value)},n.prototype.add=function(n){var t=a.__data.SelectedFacture;if(t==null)return i.UI.InfoArea.push("<p><h1>Select<\/h1> a facture<\/p>");this.selectedScop=n;this.modadd.Open();this.t.Focus();this.t.SelectAll()},n.prototype.plus=function(n){t(e(n.Scop.Value),undefined,1)},n.prototype.minus=function(n){t(e(n.Scop.Value),undefined,-1)},n.prototype.remove=function(n){var t=n.Scop.Value;t!=null&&i.UI.Modal.ShowDialog("Confirmation","Do you want realy  to delete this Article",function(n){n.Result===i.UI.MessageResult.ok&&o(t.Product,t)})},n}();n.initializeOprs=d;r.Api.RegisterApiCallback({Name:"validateuser",DoApiCallback:function(n,t,i){p(i.data)}});r.bind.Register({Name:"validateuser",OnInitialize:function(n){n.addEventListener("onclick","click",function(){return p(n.Scop.Value)})}}),function(){var n,u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.ctor=function(){t.DPObservation=r.bind.DObject.CreateField("Observation",String,null)},t.__fields__=function(){return[this.DPObservation]},t}(r.bind.DObject),t=new u,f=new r.bind.ValueScop(t,r.bind.BindingMode.TwoWay);r.Api.RegisterApiCallback({Name:"OpenObservation",DoApiCallback:function(r,u,e){n||(n=new i.UI.Modal,n.OnInitialized=function(t){t.setStyle("minWidth","50%").setStyle("minHeight","50%");n.Add(new i.UI.TControl("templates.Observation",f))});t.Observation=e.data;n.Open();n.OnClosed.Add(function(n){try{n.Modal.OnClosed.Remove("");n.Result===i.UI.MessageResult.ok&&e.callback(e,t.Observation)}catch(n){}},"")}})}();n.createApiEdit=c;c("templates.sfactureInfo","OpenSFactureInfo");c("templates.factureInfo","OpenFactureInfo");r.Api.RegisterApiCallback({Name:"removeuser",DoApiCallback:function(n,t,i){y(i.data)}});r.bind.Register({Name:"removeuser",OnInitialize:function(n){n.addEventListener("onclick","click",function(){return y(n.Scop.Value)})}});r.Api.RegisterApiCallback({Name:"lockuser",DoApiCallback:function(n,t,i){w(i.data)}});r.bind.Register({Name:"lockuser",OnInitialize:function(n){n.addEventListener("onclick","click",function(){return w(n.Scop.Value)})}});r.bind.Register({Name:"openclient",OnInitialize:function(n){n.addEventListener("click","click",{Owner:n,handleEvent:function(){a.apis.Client.Edit(this.Owner.Scop.Value,void 0)}})}});r.bind.Register({Name:"selectclient",OnInitialize:function(n){n.addEventListener("click","click",{Owner:n,handleEvent:function(){var t=n.Scop.Value;a.apis.Client.Select(function(t){t.Error==r.basic.DataStat.Success&&(n.Scop.Value=t.Data)},t)}})}});r.bind.Register({Name:"selectprojet",OnInitialize:function(n){n.addEventListener("click","click",{Owner:n,handleEvent:function(){var t=n.Scop.Value;a.apis.Projet.Select(function(t){t.Error==r.basic.DataStat.Success&&(n.Scop.Value=t.Data)},t)}})}});r.bind.Register({Name:"proj.new",OnInitialize:function(n){n.addEventListener("click","click",{Owner:n,handleEvent:function(){a.apis.Projet.CreateNew()}})}});r.bind.Register({Name:"proj.del",OnInitialize:function(n){n.addEventListener("click","click",{Owner:n,handleEvent:function(){alert(n)}})}});r.bind.Register({Name:"openproduct",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",{Owner:n,handleEvent:function(){var n=this.Owner.Scop.Value;a.apis.Product.Edit(n,null)}})}});r.bind.Register({Name:"opencategory",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",{handleEvent:function(){var n=this.self.Scop.Value;a.apis.Category.Edit(n)},self:n})}});r.bind.Register({Name:"enum2string",OnInitialize:function(n,t){var i=n.dom;n.addValue("info",{map:k(i.getAttribute("type")),rIsNumber:i.getAttribute("rtype")==="number"});this.Todo(n,t)},Todo:function(n){var t=n.getValue("info"),i=n.Scop.Value,r=n.dom;r.textContent=t.rIsNumber?t.map.type[i||0]||(i||0).toString():i||t.map.type[0]}});r.bind.Register({Name:"selectcategory",OnInitialize:function(n){if(!(n.dom instanceof HTMLSelectElement))throw"Dom must be Select";var t=new i.UI.ComboBox(n.dom,a.__data.Categories),r=n.Control||n.Scop.__Controller__&&n.Scop.__Controller__.CurrentControl||i.UI.Desktop.Current;t.Parent=r;t.addEventListener("change",function(t,i,r){var f=r.Content.getChild(i.target.selectedIndex),u;f&&(u=f.getDataContext(),u&&(n.Scop.Value=u))},t)}})}(v||(v={})),function(n){function t(n,t,i,r){var u=document.createElement("button"),f;if(u.classList.add("btn","btn-"+i,"glyphicon","glyphicon-"+n),u.textContent="  "+t,r)for(f in r)u.setAttribute(f,r[f]);return u}n.crb=t}(tt=t.extern||(t.extern={}));p=function(n){function t(t,u,f,e,o){var s=n.call(this,t,u)||this;return s.template=f,s.focuseOrEdit=o,s.header=i.UI.Template.ToTemplate("templates.facturePageHeader",!1).CreateShadow(null),s._caption=document.createTextNode("Facture D'Achat"),s.abonment=new i.UI.ProxyAutoCompleteBox(new i.UI.Input(document.createElement("input")),r.basic.getEnum("models.Abonment")),s.Title=u,s.Data=e,s}return __extends(t,n),t.__fields__=function(){return[this.DPData,this.DPTitle]},t.prototype.Open=function(n){var u=this;this.OnInitialized=function(f){var o=f.Data,e;(f.Data=n,f.LoadArticles(),f.scp)||(e=r.bind.Scop.Create("Data.IsOpen",f,1),e.AddJob(f,f.View),u.tb=new r.bind.TwoBind(3,f,f.adapter,t.DPData,i.UI.TControl.DPData),f.scp=u)}},t.prototype.getHelp=function(){var n={Enter:"New Article",F2:"Edit",F3:"Deep Searche",F4:"Open Info",F5:"Update",F7:"Open | Close ",F8:"Save Facture",F9:"Regler Facture","CTRL+S, CTRL+R":"Stat. Recherche","CTRL+S, CTRL+D":"Stat. Detail","CTRL+S, CTRL+B":"Stat. Benifit"},t=["primary","success","danger","info","warning"],f=0,r="";for(var u in n)r+='<div class="input-group" style="background:gray"> <span class="input-group-btn"> <label class="btn btn-'+t[f++%t.length]+'">'+u+'<\/label> <\/span> <label class="form-control" >'+n[u]+"<\/label> <\/div>";i.UI.InfoArea.push(r,!0,1e4)},t.prototype.OnKeyDown=function(t){if(this.Data&&this.Data.IsOpen&&t.keyCode==i.UI.Keys.Enter)this.AddNewArticle();else if(!this.adapter.OnKeyDown(t)){switch(t.keyCode){case 86:this.GetLastArticlePrice();return;case i.UI.Keys.F1:this.getHelp();break;case 13:this.focuseOrEdit?this.focuser.focuseNext(!0):this.edit();break;case i.UI.Keys.F2:this.edit();break;case i.UI.Keys.F3:this.OnDeepSearch();break;case i.UI.Keys.F4:this.OpenInfo();break;case i.UI.Keys.F5:this.Update();break;case i.UI.Keys.F6:break;case i.UI.Keys.F7:this.OpenCloseFacture();break;case i.UI.Keys.F8:this.Data.IsOpen&&this.SaveFacture();break;case i.UI.Keys.F9:this.ReglerFacture();break;case i.UI.Keys.F10:this.OpenVersments(!1);break;case 13:this.edit();break;default:return n.prototype.OnKeyDown.call(this,t)}t.preventDefault();t.stopPropagation()}},t.prototype.ToggleFactureStat=function(n,t){var i=this.Data,r=t.dom;i&&a.apis.Facture.EOpenFacture(i);r&&r.blur()},t.prototype.initialize=function(){n.prototype.initialize.call(this);this._view.style.minWidth="750px";this.Add(this.header);this.Add(this.adapter=new i.UI.ListAdapter(this.template,undefined,this.Data,!0).applyStyle("fitHeight"));this.adapter.AcceptNullValue=!1;this.adapter.OnItemSelected.On=function(n){var t=n.SelectedChild;t&&t.View&&r.thread.Dispatcher.call(null,r.basic._focuseOn,t.View)};this.focuser=new r.basic.focuser(this.adapter.View,!0);i.UI.Desktop.Current.KeyCombiner.On("S","R",function(n){this.OpenPrdStatistics();n.Cancel=!0},this,this);i.UI.Desktop.Current.KeyCombiner.On("S","D",function(n){this.OpenPrdStatisticsRslt();n.Cancel=!0},this,this);i.UI.Desktop.Current.KeyCombiner.On("S","B",function(n){this.CalculateBenifite();n.Cancel=!0},this,this)},Object.defineProperty(t.prototype,"IsOpen",{get:function(){var n=this.Data;return n?n.IsOpen:!1},enumerable:!0,configurable:!0}),t.prototype.OpenCloseFacture=function(){a.apis.Facture.EOpenFacture(this.Data)},__decorate([r.attributes.property(String,""),__metadata("design:type",String)],t.prototype,"Title",void 0),__decorate([r.attributes.property(f.models.FactureBase),__metadata("design:type",Object)],t.prototype,"Data",void 0),t}(i.UI.NavPanel);t.Facture=p;r.Api.RegisterApiCallback({Name:"loadFournisseurs",Params:{},DoApiCallback:function(n,t,i){if(this.Params.loaded)return i&&i.callback&&i.callback(i,!0);this.Params.loaded=!0;a.spin.Start("Load la list des fournisseurs");a.requester.Push(f.models.Fournisseurs,a.__data.Fournisseurs,null,function(n,t,r){a.spin.Pause();i&&i.callback&&i.callback(i,r)})}});r.Api.RegisterApiCallback({Name:"loadSFActures",Params:{},DoApiCallback:function(n,t,i){if(this.Params.loaded)return i&&i.callback&&i.callback(i,!0);this.Params.loaded=!0;a.spin.Start("Load la list des factures de reciption");a.requester.Push(f.models.SFactures,a.__data.SFactures,null,function(n,t,r){a.spin.Pause();i&&i.callback&&i.callback(i,r)})}});r.Api.RegisterApiCallback({Name:"loadFActures",Params:{},DoApiCallback:function(n,t,i){if(this.Params.loaded)return i&&i.callback&&i.callback(i,!0);this.Params.loaded=!0;a.spin.Start("Load la list des factures de livraison");a.requester.Request(f.models.Factures,"GETCSV",null,null,function(n,t,r,u){a.spin.Pause();a.__data.Factures.FromCsv(u.Response);i&&i.callback&&i.callback(i,r)})}});r.Api.RegisterApiCallback({Name:"getLastArticlePrice",Params:{},DoApiCallback:function(n,t,i){var r=i.data,u;r.Dealer&&(r.IsAchat=r.Dealer instanceof f.models.Fournisseur);u=r.IsAchat?a.apis.SFacture:a.apis.Facture;u.GetLastArticlePrice(r.Dealer,r.Product,r.Before,function(n){return i&&i.callback&&i.callback(i,n)},r.asRecord)}});typeof __data!="undefined"&&r.Api.RiseApi("getLastArticlePrice",{data:{Dealer:__data.Costumers.Get(0),Product:__data.Products.Get(0),Before:new Date(0)},callback:function(){}});window.api=r.Api;i.UI});define("Componenets/Forms",["require","exports","abstract/Models","../lib/Q/sys/UI","../lib/Q/sys/Corelib","abstract/extra/Common","abstract/extra/Basics"],function(n,t,i,r,u,f,e){"use strict";function h(){var n=new s.InitFacture;return n.Show(),n}function c(){var n=new s.InitSFacture;return n.Show(),n}var o,s;Object.defineProperty(t,"__esModule",{value:!0});f.GetVars(function(n){return o=n,!1}),function(t){var l=function(n){function t(){var t=n.call(this,"Facture.new",r.UI.TControl.Me)||this;return t.OnSuccess=new u.bind.EventListener(0,!0),t}return __extends(t,n),t.prototype.SelectClient=function(){var n=this;o.apis.Client.Select(function(t){if(t.Error==e.basics.DataStat.Success){var i=t.Data;n.Value.Client=i;i&&(n.Value.Abonment=i.Abonment)}},this.Value.Client,o.__data.Costumers)},t.prototype.Show=function(n){var t=this;return this.Value=new i.models.Facture(0),this.Data=this.Value,n&&this.OnSuccess.Add(n),this.Value.Type=i.models.BonType.Bon,this.Value.Transaction=i.models.TransactionType.Vente,this.Value.Abonment=this.Value.Client&&this.Value.Client.Abonment||0,r.UI.Modal.ShowDialog("Creation Facture Vente",this,function(n){return t.onModalCosed(n)},"Create","Discart"),this},t.prototype.onModalCosed=function(n){var u=this,t;if(this.Parent=null,n.Result==r.UI.MessageResult.ok){if(t=this.Value,!t.Client)return n.StayOpen();o.requester.Request(i.models.Facture,"CREATE",this.Value,{CId:t.Client.Id,Type:t.Type,Abonment:t.Abonment,Transaction:t.Transaction},function(n,t,i){u.OnSuccess.PInvok(0,[u.Value,i],u)})}},t}(r.UI.TControl),s,h,c,f;t.InitFacture=l;s=function(n){function t(){var i=n.call(this,"templates.PDFViewer",r.UI.TControl.Me)||this;if(i.quee=[],t.pdf!=null)throw null;return t.pdf=i,t.modal.OnInitialized=function(n){n.setWidth("95vw").setHeight("90vh").Content=i},t.modal.OnClosed.On=function(n){i.quee.length!=0&&(n.StayOpen(),i.Url=i.quee.pop())},i}return __extends(t,n),t.__fields__=function(){return[this.DPUrl]},t.ctor=function(){t.modal=new r.UI.Modal},t.prototype.UrlChanged=function(n){this.OnInitialized=function(t){return u.thread.Dispatcher.call(t,t.asyncUrl,n._new)}},t.prototype.asyncUrl=function(n){this.pdfDom.src="";setTimeout(function(n,t){n.pdfDom.src=t},200,this,n)},t.prototype.setName=function(n,t){var i=this;if(n=="pdfDom")return this.pdfDom=t,this.pdfDom.addEventListener("error",function(){i.Refech()}),!0},t.Show=function(n){this.pdf||new t;this.modal.IsOpen?t.pdf.quee.push(n):(this.modal.Open(),this.pdf.OnCompiled=function(t){return t.Url=n})},t.prototype.Refech=function(){var n=this.Url;this.Url="";this.Url=n},t.modal=new r.UI.Modal,t.DPUrl=u.bind.DObject.CreateField("Url",String,null,t.prototype.UrlChanged),t}(r.UI.TControl);t.PDFViewer=s;h=function(n){function t(){var t=n.call(this,"SFacture.new",r.UI.TControl.Me)||this;return t.OnSuccess=new u.bind.EventListener(0,!0),t}return __extends(t,n),t.prototype.SelectFournisseur=function(){var n=this;o.apis.Fournisseur.Select(function(t){t.Error===e.basics.DataStat.Success&&(n.Value.Fournisseur=t.Data)},this.Value.Fournisseur)},t.prototype.SelectAchteur=function(){var n=this;o.apis.Agent.Select(function(t){var i=t.Data;t.Error==e.basics.DataStat.Success&&(n.Value.Achteur=i)},this.Value.Achteur,o.__data.Agents)},t.prototype.Show=function(n){var t=this;return this.Value=new i.models.SFacture(0),this.Data=this.Value,n&&this.OnSuccess.Add(n),this.Value.Type=i.models.BonType.Bon,this.Value.Transaction=i.models.TransactionType.Vente,this.Value.Abonment=this.Value.Client&&this.Value.Client.Abonment||0,r.UI.Modal.ShowDialog("Creation Facture Achat",this,function(n){return t.onModalCosed(n)},"Create","Discart"),this},t.prototype.onModalCosed=function(n){var u=this,t;if(this.Parent=null,n.Result==r.UI.MessageResult.ok){if(t=this.Value,!t.Fournisseur||!t.Achteur)return n.StayOpen();o.requester.Request(i.models.SFacture,"CREATE",this.Value,{FId:t.Fournisseur.Id,AId:t.Achteur.Id,Type:t.Type,Transaction:t.Transaction},function(n,t,i){u.OnSuccess.PInvok(0,[u.Value,i],u)})}},t}(r.UI.TControl);t.InitSFacture=h;c=function(n){function t(){var t=n.call(this,"templates.PictureViewer",r.UI.TControl.Me)||this,i=new FileReader;return t.openDlg.multiple=!1,t.openDlg.pattern="[wds].png",i.readAsText(t.openDlg.files[0]),t}return __extends(t,n),t}(r.UI.TControl);t.PictureViewer=c;f=function(t){function i(){return t.call(this,i.createElement("div","ImageModal"))||this}return __extends(i,t),i.prototype.initialize=function(){this._view.appendChild(this.btnClose=i.createElement("span","close"));this._view.appendChild(this.txtCaption=i.createElement("div",void 0,"caption"));this._view.appendChild(this.imgContent=i.createElement("img","modal-content"));this.btnClose.addEventListener("click",this);this._view.style.zIndex="9007199254740991";this.btnClose.innerText="Fermer";n("style|../assets/Forms.css")},i.createElement=function(n,t,i){var r=document.createElement(n);return t&&r.classList.add(t),i&&(r.id=i),r},i.prototype.Open=function(n,t){var i=this;this.Parent==null?(this.Parent=r.UI.Desktop.Current,r.UI.Desktop.Current.View.appendChild(this._view)):this.Parent.View.classList.add("modal-open");r.UI.Desktop.Current.GetKeyControl(this,function(n){return(n.keyCode==r.UI.Keys.Esc&&i.Close(),n.keyCode>36&&n.keyCode<41&&!n.altKey&&!n.ctrlKey&&!n.shiftKey)?2:(n.preventDefault(),n.stopImmediatePropagation(),0)},[]);this._view.style.display="block";this.imgContent.src=n;this.txtCaption.innerHTML=t},Object.defineProperty(i.prototype,"IsOpen",{get:function(){return this._view.style.display=="block"},enumerable:!0,configurable:!0}),i.prototype.Close=function(){this.Parent.View.classList.remove("modal-open");this._view.style.display="none";r.UI.Desktop.Current.ReleaseKeyControl()},i.prototype.handleEvent=function(n){n.type=="click"&&n.srcElement===this.btnClose&&this.Close()},i.Default=new i,i}(r.UI.JControl);t.ImageModal=f;window.ImageModal=f}(s=t.Forms||(t.Forms={}));t.Test=h;t.Test1=c});define("Componenets/PStat",["require","exports","../lib/Q/sys/Corelib","../lib/Q/sys/UI","abstract/Models","assets/data/data","../lib/q/components/HeavyTable/script","abstract/extra/Common"],function(n,t,i,r,u,f,e,o){"use strict";var s,c,h;Object.defineProperty(t,"__esModule",{value:!0});o.GetVars(function(n){return s=clone(n),!1}),function(n){var t;(function(n){var t=function(n){function t(t,i){var u=n.call(this,"templates.ProductSearch"+(i=="Client"?"":"1"),r.UI.TControl.Me)||this;return u._dealers=t,u.DealerTitle=i,u._dealer=null,u._product=null,u.dealer=null,u.product=null,u.from=null,u.to=null,u}return __extends(t,n),Object.defineProperty(t.prototype,"DealersSource",{get:function(){return this._dealers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"List",{set:function(n){this._list=n},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){n.prototype.initialize.call(this);this.To=new Date(Date.now()+31536e6);this.From=new Date(Date.now()-31536e6)},t.prototype.setName=function(n,t,i,r){this[n]===null&&(this[n]=t,this["_"+n]=r.Control)},t.__fields__=function(){return[this.DPFrom,this.DPTo,this.DPSelectedDealer,this.DPSelectedProduct]},t.prototype.Open=function(){var n=this;return this.modal||(this.modal=new r.UI.Modal,this.modal.OnInitialized=function(){return n.modal.Content=n},this.modal.OnClosed.On=function(t){t.Result==r.UI.MessageResult.ok&&n._list.Execute(n.getRequest())}),this.modal.Open(),this},t.prototype.getRequest=function(){var n=[];return this.SelectedProduct&&n.push("Id="+this.SelectedProduct.Id),this.SelectedDealer&&n.push((this.DealerTitle=="Client"?"CID=":"FID=")+this.SelectedDealer.Id),this.From&&this.From.getTime()!=0&&n.push("From="+this.From.getTime()),this.To&&this.To.getTime()!=0&&n.push("To="+this.To.getTime()),n.join("&")},t.DPFrom=i.bind.DObject.CreateField("From",Date),t.DPTo=i.bind.DObject.CreateField("To",Date),t.DPSelectedDealer=i.bind.DObject.CreateField("SelectedDealer",u.models.Dealer),t.DPSelectedProduct=i.bind.DObject.CreateField("SelectedProduct",u.models.Product),t}(r.UI.TControl),c,l;n.ProduitStat=t;c=function(n){function c(t){var i=n.call(this,7,undefined,!0)||this;return i.query=t,i.fact=1,t.List=i,i}return __extends(c,n),c.prototype.Execute=function(n){var t=this;s.requester.Costume({Url:__global.ApiServer.Combine("/_/pstat/ArticlesPurchased").FullPath+"?"+n,HasBody:!1,Method:i.net.WebRequestMethod.Get},new u.models.Articles(null),{},function(n,r){t.Open();t.OnInitialized=function(u){u.table.OnInitialized=function(){n.data.FromJson(r,i.encoding.SerializationContext.GlobalContext);t.Input=n.data}}},this);this.Open()},Object.defineProperty(c.prototype,"DealerTitle",{get:function(){return this.query.DealerTitle},enumerable:!0,configurable:!0}),c.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.table=new e.Material.HeavyTable(f.data.value.ProductStatDef.def);this.OnInitialized=function(n){t.table.OnInitialized=function(i){i.Source=n.Output;n.OnPropertyChanged(r.UI.Paginator.DPOutput,function(n,i){t.table.Source=i._new})};t.Content=t.table}},c.prototype.OrderByDealer=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Owner.Client.Name||"").localeCompare(i.Owner.Client.Name||"")});this.fact*=-1},c.prototype.OrderByProduct=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Product||"").toString().localeCompare(i.Product||"").toString()});this.fact*=-1},c.prototype.OrderByQte=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Count-i.Count)});this.fact*=-1},c.prototype.OrderByPSel=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.PSel-i.PSel)});this.fact*=-1},c.prototype.OrderByPVente=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Price-i.Price)});this.fact*=-1},c.prototype.OrderByModifiedDate=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(o.funcs.toNum(t.Owner.LastModified)-o.funcs.toNum(i.Owner.LastModified))});this.fact*=-1},c.prototype.OrderByFactureDate=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*((t.Owner.Date||h).getTime()-(i.Owner.Date||h).getTime())});this.fact*=-1},c.prototype.Open=function(){c.modal.Open()},c.Open=function(){this.Default.Open()},c.OpenQuery=function(){return this.Default.query.Open()},c.prototype.OnKeyDown=function(t){if(t.preventDefault(),t.stopPropagation(),this.table.OnKeyDown(t))return!0;n.prototype.OnKeyDown.call(this,t)},Object.defineProperty(c,"Default",{get:function(){var n=this;return this._default||(c._default=new c(new t(s.__data.Costumers,"Client")),this.modal=new r.UI.Modal,this.modal.OnInitialized=function(){n.modal.Content=n._default;n.modal.setWidth("90%")}),c._default},enumerable:!0,configurable:!0}),c.prototype.OpenFacture=function(n,t,u){var f=u.Value||this.table.SelectedItem;f&&i.Api.RiseApi("OpenFacture",{data:f.Owner,callback:function(){c.modal.Close(r.UI.MessageResult.Exit)}})},c}(r.UI.Paginator);n.ListOfArticles=c;l=function(n){function c(t){var i=n.call(this,7,undefined,!0)||this;return i.query=t,i.fact=1,t.List=i,i}return __extends(c,n),Object.defineProperty(c.prototype,"DealerTitle",{get:function(){return this.query.DealerTitle},enumerable:!0,configurable:!0}),c.prototype.Execute=function(n){var t=this;s.requester.Costume({Url:__global.ApiServer.Combine("/_/pstat/ArticlesSolded").FullPath+"?"+n,HasBody:!1,Method:i.net.WebRequestMethod.Get},new u.models.FakePrices(null),{},function(n,r){t.Open();t.OnInitialized=function(u){u.table.OnInitialized=function(){n.data.FromJson(r,i.encoding.SerializationContext.GlobalContext);t.Input=n.data}}},this);this.Open()},c.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.table=new e.Material.HeavyTable(f.data.value.ProductStatDef1.def);this.OnInitialized=function(n){t.table.OnInitialized=function(i){i.Source=n.Output;n.OnPropertyChanged(r.UI.Paginator.DPOutput,function(n,i){t.table.Source=i._new})};t.Content=t.table}},c.prototype.OrderByDealer=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Facture.Fournisseur.Name||"").localeCompare(i.Facture.Fournisseur.Name||"")});this.fact*=-1},c.prototype.OrderByProduct=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Product||"").toString().localeCompare(i.Product||"").toString()});this.fact*=-1},c.prototype.OrderByQte=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Qte-i.Qte)});this.fact*=-1},c.prototype.OrderByPSel=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.PSel-i.PSel)});this.fact*=-1},c.prototype.OrderByPVente=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(t.Value-i.Value)});this.fact*=-1},c.prototype.OrderByModifiedDate=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*(o.funcs.toNum(t.Facture.LastModified)-o.funcs.toNum(i.Facture.LastModified))});this.fact*=-1},c.prototype.OrderByFactureDate=function(){var n=this;this.Input.OrderBy(function(t,i){return n.fact*((t.Facture.Date||h).getTime()-(i.Facture.Date||h).getTime())});this.fact*=-1},c.prototype.Open=function(){c.modal.Open()},c.OpenQuery=function(){return this.Default.query.Open()},c.Open=function(){this.Default.Open()},c.prototype.OnKeyDown=function(t){if(t.preventDefault(),t.stopPropagation(),this.table.OnKeyDown(t))return!0;n.prototype.OnKeyDown.call(this,t)},Object.defineProperty(c,"Default",{get:function(){var n=this;return this._default||(this._default=new c(new t(s.__data.Fournisseurs,"Fournisseur")),this.modal=new r.UI.Modal,this.modal.OnInitialized=function(){n.modal.Content=n._default;n.modal.setWidth("90%")}),this._default},enumerable:!0,configurable:!0}),c.prototype.OpenFacture=function(n,t,u){var f=u.Value||this.table.SelectedItem;f&&i.Api.RiseApi("OpenSFacture",{data:f.Facture,callback:function(){c.modal.Close(r.UI.MessageResult.Exit)}})},c.modal=new r.UI.Modal,c}(r.UI.Paginator);n.ListOfFakePrices=l})(t=n.Views||(n.Views={}))}(c=t.Statistique||(t.Statistique={}));window.Statistics=c;window.Test=function(){return c.Views.ProduitStat};h=new Date});define("Desktop/Admin/Facture",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib","abstract/extra/Common","abstract/Models","abstract/extra/Basics","../../lib/Q/components/HeavyTable/script","Componenets/Forms","Componenets/PStat","assets/data/data"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l,a,v,y;Object.defineProperty(t,"__esModule",{value:!0});u.GetVars(function(n){return l=n,!1});a=r.bind.NamedScop.Get("UserAbonment");v=function(n){function t(){var t=n.call(this,"facture_achat","Facture D'<b><u>A<\/u><\/b>chat","SFacture.view",null,!1)||this;return t.sfs=new p(t,"SFacturePrinter"),t}return __extends(t,n),t.prototype.GetLastArticlePrice=function(){r.Api.RiseApi("getLastArticlePrice",{data:{Dealer:this.Data.Fournisseur,Product:this.adapter.SelectedItem.Product,Before:this.Data.Date,IsAchat:!0},callback:function(n,t){t?i.UI.InfoArea.push("Le dernie revage est "+t):i.UI.InfoArea.push("Le Produit n'est pas acheter")}})},t.prototype.OnAbonmentChanged=function(){throw new Error("Method not implemented.");},t.prototype.CalculateBenifite=function(){var u=this.Data&&this.Data.Articles.AsList(),t,f,r,n;if(u){for(t=0,f=0,r=0;r<u.length;r++)(n=u[r],n)&&(t+=(n.Value-n.PSel)*n.Qte,f+=n.PSel*n.Qte);i.UI.InfoArea.push("<h3 >Benefit est :<\/h3><h1>"+t+'DA  <\/h1><br><h3 >Precentage est :<\/h3><h1 style="color:yellow">'+t/f*100+"%  <\/h1>")}},t.prototype.OpenPrdStatistics=function(){var i=h.Statistique.Views.ListOfFakePrices.OpenQuery(),n=this.adapter.SelectedItem,t=this.Data;i.OnInitialized=function(i){n&&(i.SelectedProduct=n.Product);t&&(i.SelectedDealer=t.Fournisseur)}},t.prototype.OpenPrdStatisticsRslt=function(){h.Statistique.Views.ListOfFakePrices.Open()},t.prototype.ReglerFacture=function(){this.verser(!0)},t.prototype.LoadArticles=function(){this.Data&&(this.Data.IsOpen||this.Data.Articles!=null&&this.Data.Articles.Stat||l.apis.SFacture.UpdateArticlesOf(this.Data,null))},t.prototype.OpenInfo=function(){var n=this.Data,t=n.CreateBackup();r.Api.RiseApi("OpenSFactureInfo",{callback:function(n,i){i.iss&&i.data.IsOpen?l.requester.Request(f.models.SFacture,"SetInfo",i.data,i.data,function(n,r,u){i.data[u?"Commit":"Rollback"](t)}):i.data.Rollback(t)},data:n})},t.prototype.Update=function(){var n=this;i.UI.Modal.ShowDialog("Update","Do you want realy to update this facture from server",function(t){t.Result===i.UI.MessageResult.ok&&l.apis.SFacture.UpdateArticlesOf(n.Data,function(){l.apis.SFacture.Update(n.Data)})})},t.prototype.AddNewArticle=function(){var t=this,n=this.adapter.Data;n.IsOpen&&l.apis.Revage.New(function(u){var f=u.Data,o;if(u.Error!==e.basics.DataStat.Success)return i.UI.InfoArea.push("UnExpected Error");f.Facture=n;o=function(i){i.Error===r.basic.DataStat.Success?(n.Recalc(),n.Articles.Add(i.Data),t.adapter.SelectItem(i.Data)):i.Data.Dispose()};t.edit(f,o)})},t.prototype.SaveFacture=function(){r.Api.RiseApi("SaveSFacture",{data:this.Data})},t.prototype.DeleteArticle=function(){var t=this.adapter.Data,n,u,e;t&&t.IsOpen&&(n=this.adapter.SelectedItem,n==null&&i.UI.InfoArea.push("select an article to delete"),u=n.Product,e=t.GetValue(f.models.SFacture.DPArticles),i.UI.Modal.ShowDialog("Confirmation","Do you want to remove this Article <br>"+(u||"").toString(),function(u){u.Result===i.UI.MessageResult.ok&&l.apis.Revage.Delete(n,function(i){i.Error==r.basic.DataStat.Success&&(t.Recalc(),e.Remove(n))})},"DELETE","Cancel"))},t.prototype.edit=function(n,t){var i=this;(n||this.adapter.SelectedItem)&&l.apis.Revage.Show(n||this.adapter.SelectedItem,function(n){n.Error==r.basic.DataStat.Success&&i.Data.Recalc();t&&t(n)},this.Data.IsOpen)},t.prototype.GetLeftBar=function(){var t=this,n=this.sfs.GetLeftBar();return n.OnInitialized=function(){return t.sfs.ShowFournisseur()},n},t.prototype.GetRightBar=function(){return this.sfs.GetRightBar()},t.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.verser(t==="Regler")},t.prototype.verser=function(n){var t=this.Data;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une facture pour ajouter une versment");if(n)return l.apis.SVersment.Regler(t,t.Client);l.apis.SVersment.VerserTo(t,t.Fournisseur)},t.prototype.OpenVersments=function(n){var t=this.Data;t?l.apis.SVersment.OpenSVersmentsOfFacture(t,function(r,u,f,o){t.Recalc(r);o&&n&&(u?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&l.apis.SVersment.Delete(u,function(n){n.Error===e.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.OpenStatistics=function(){this.OpenPrdStatistics()},t.prototype.OpenMails=function(){},t.prototype.NewProduct=function(){var t=this,n=this.Data;l.apis.Product.CreateNew(function(i){if(i.Error==r.basic.DataStat.Success){var u=i.Data;n&&n.IsOpen&&l.apis.Revage.New(function(i){if(i.Error===r.basic.DataStat.Success){var f=i.Data;f.Facture=n;f.Product=u;f.Qte=0;t.edit(f,function(i){i.Error===r.basic.DataStat.Success?(n.Articles.Add(i.Data),t.adapter.SelectItem(i.Data)):i.Data.Dispose()})}})}})},t.prototype.SelectFournisseur=function(){var t=this,n=this.Data;if(!n.IsOpen)return i.UI.InfoArea.push("La facture est fermer");l.apis.Fournisseur.Select(function(i){if(i.Error==r.basic.DataStat.Success){if(!i.Data)return r.thread.Dispatcher.call(t,t.SelectFournisseur);i.Data!=n.Fournisseur&&l.requester.Request(f.models.SFacture,"SetProperty",null,{Property:"Fournisseur",Id:n.Id,Value:i.Data.Id},function(t,r,u){u&&(n.Fournisseur=i.Data)})}},this.Data.Fournisseur)},t.prototype.SelectAchteur=function(){var u=this,n=this.Data,t;if(!n.IsOpen)return i.UI.InfoArea.push("La facture est fermer");t=n.GetValue(f.models.SFacture.DPAchteur);l.apis.Agent.Select(function(t){var i=t.Data;if(t.Error===r.basic.DataStat.Success){if(!i)return u.SelectFournisseur();i!=n.Achteur&&l.requester.Request(f.models.SFacture,"SetProperty",null,{Property:"Achteur",Id:n.Id,Value:i.Id},function(t,r,u){u&&(n.Achteur=i)})}},t)},t.prototype.Validate=function(){r.Api.RiseApi("ValidateSFacture",{data:this.Data})},t.prototype.GenerateTickets=function(){var n=this;this._tickets?this._tickets.Clear().From(this.Data):(this._tickets=f.models.Tickets.From(this.Data,this._tickets),this.mdl_tickets=new i.UI.Modal,this.mdl_tickets.SetDialog("Tickets Generator",this.createTicketTable(this._tickets)),this.mdl_tickets.OnClosed.Add(function(t){if(t.Result===i.UI.MessageResult.ok)n.onPrint(n._tickets,!1)}),this.mdl_tickets.OnInitialized=function(n){return n.setWidth("90%")});this.mdl_tickets.Open()},t.prototype.Print=function(n){n==="Tickets"?this.GenerateTickets():this.PrintModel(n,undefined)},t.prototype.Delete=function(){r.Api.RiseApi("DeleteSFacture",{data:this.Data})},t.prototype.New=function(){r.Api.RiseApi("NewSFacture",{data:null,callback:function(){}})},t.prototype.OnBringIntoFront=function(){var n=this,t=this.adapter.Data;t==null&&i.UI.Modal.ShowDialog(this.Caption,"There no facture selected do you want to create a new one",function(t){if(t.Result===i.UI.MessageResult.ok)n.New();else{var r=n.parent;r.Select("facture_fournisseurs")}},"Create New","Cancel");this.abonment.Box.Enable=!0;a.Value=f.models.Abonment.Detaillant;this.abonment.Box.Disable(!0)},t.prototype.createTicketTable=function(n){var t=new o.Material.HeavyTable(c.data.value.ticketTableDef.def);return t.Source=n.Values,t},t.prototype.onPrint=function(n){var t=new f.Printing.PrintData;return t.HandlerId="SFacturePrinter",t.DataId=this.Data.Id,t.Model="Tickets",t.Data=n,l.requester.Request(f.Printing.PrintData,"PRINT",t,null,function(n){var t=n.data,i;t.Response&&t.Response.Success&&(i=__global.ApiServer.Combine("/_/$").FullPath+"?Id="+t.Response.FileName,s.Forms.PDFViewer.Show(i))},null,null,this),!1},t.prototype.PrintModel=function(n,t){var i=new f.Printing.PrintData;return i.HandlerId="SFacturePrinter",i.DataId=this.Data.Id,i.Model=n,i.Data=t,l.requester.Request(f.Printing.PrintData,"PRINT",i,null,function(n){var t=n.data,i;t.Response&&t.Response.Success&&(i=__global.ApiServer.Combine("/_/$").FullPath+"?Id="+t.Response.FileName,s.Forms.PDFViewer.Show(i))},null,null,this),!1},t}(u.Facture);t.FactureAchat=v;y=function(n){function t(){var t=n.call(this,"facture_vent","Facture <b><u>V<\/u><\/b>ent","Facture.oview",null,!1)||this;return t.fs=new p(t,"FacturePrinter"),t}return __extends(t,n),t.prototype.GetLastArticlePrice=function(){l.apis.Facture.GetLastArticlePrice(this.Data.Client,this.adapter.SelectedItem.Product,this.Data.Date,function(n){n?i.UI.InfoArea.push("Le dernie revage est "+n):i.UI.InfoArea.push("Le Produit n'est pas acheter")})},t.prototype.CalculateBenifite=function(){var u=this.Data&&this.Data.Articles.AsList(),t,f,r,n;if(u){for(t=0,f=0,r=0;r<u.length;r++)(n=u[r],n)&&(t+=(n.Price-n.PSel)*n.Count,f+=n.Price*n.Count);i.UI.InfoArea.push("<h3 >Benefit est :<\/h3><h1>"+t+'DA  <\/h1><br><h3 >Precentage est :<\/h3><h1 style="color:yellow">'+t/f*100+"%  <\/h1>")}},t.prototype.OpenPrdStatistics=function(){var n=h.Statistique.Views.ListOfArticles.OpenQuery(),t=this.adapter.SelectedItem,i=this.Data;n.OnInitialized=function(n){n.SelectedProduct=t.Product;n.SelectedDealer=i.Client}},t.prototype.OpenPrdStatisticsRslt=function(){h.Statistique.Views.ListOfArticles.Open()},t.prototype.OpenInfo=function(){var n=this.Data,t=n.CreateBackup();r.Api.RiseApi("OpenFactureInfo",{callback:function(n,i){i.iss&&i.data.IsOpen?l.requester.Request(f.models.Facture,"SetInfo",i.data,i.data,function(n,r,u){i.data[u?"Commit":"Rollback"](t)}):i.data.Rollback(t)},data:n})},t.prototype.GenerateTickets=function(){throw new Error("Method not implemented.");},t.prototype.ReglerFacture=function(){this.verser(!0)},t.prototype.LoadArticles=function(){this.Data&&(this.Data.IsOpen||this.Data.Articles!=null&&this.Data.Articles.Stat||l.apis.Facture.UpdateArticlesOf(this.Data,null))},t.prototype.OnPrint=function(){this.Print("Format1")},t.prototype.Update=function(){var n=this;i.UI.Modal.ShowDialog("Update","Do you want realy to update this facture from server",function(t){t.Result===i.UI.MessageResult.ok&&l.apis.Facture.UpdateArticlesOf(n.Data,function(){l.apis.Facture.Update(n.Data)})})},t.prototype.edit=function(n,t){var i=this;l.apis.Article.Show(n||this.adapter.SelectedItem,function(n){n.Error==r.basic.DataStat.Success&&i.Data.Recalc();t&&t(n)},this.Data.IsOpen)},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Enable=!0},t.prototype.AddNewArticle=function(){var n=this,t=this.adapter.Data;t.IsOpen&&l.apis.Article.New(function(u){var o=u.Data,h=u.Error,s;if(h!==e.basics.DataStat.Success)return i.UI.InfoArea.push("UnExpected Error");o.Owner=t;o.Count=1;s=o.OnPropertyChanged(f.models.Article.DPProduct,function(n,t){o.PSel=t._new&&t._new.PSel||0});n.edit(o,function(i){o.removeEvent(f.models.Article.DPProduct,s);i.Error===r.basic.DataStat.Success?(t.Articles.Add(i.Data),n.Data.Recalc(),n.adapter.SelectItem(i.Data)):i.Data.Dispose()})})},t.prototype.SaveFacture=function(){var n=this.Data;if(!n)return i.UI.InfoArea.push("There no facture selected");r.Api.RiseApi("SaveFacture",{data:n})},t.prototype.DeleteArticle=function(){var u=this,t=this.adapter.Data,n,r;t&&t.IsOpen&&(n=this.adapter.SelectedItem,n==null&&i.UI.InfoArea.push("select an article to delete"),r=t.GetValue(f.models.Facture.DPArticles),i.UI.Modal.ShowDialog("Confirmation","Do you want to remove this Article <br>"+(n.Product||"").toString(),function(t){t.Result===i.UI.MessageResult.ok&&l.requester.Request(f.models.Article,"DELETE",n,n,function(t,f,e){e?(r.Remove(n),u.Data.Recalc()):i.UI.InfoArea.push("L' article n'a pas supprimmer")})},"DELETE","Cancel"))},t.prototype.GetLeftBar=function(){var t=this,n=this.fs.GetLeftBar();return n.OnInitialized=function(){return t.fs.HideFournisseur()},n},t.prototype.GetRightBar=function(){return this.fs.GetRightBar()},t.prototype.verser=function(n){var t=this.Data;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une facture pour ajouter une versment");if(n)return l.apis.Versment.Regler(t,t.Client);l.apis.Versment.VerserTo(t,t.Client)},t.prototype.OpenVersments=function(n){this.Data?l.apis.Versment.OpenVersmentsOfFacture(this.Data,function(t,r,u,f){f&&n&&(r?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&l.apis.Versment.Delete(r,function(n){n.Error===e.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.OpenStatistics=function(){this.OpenPrdStatistics()},t.prototype.OpenMails=function(){},t.prototype.NewProduct=function(){var t=this,n=this.Data;l.apis.Product.CreateNew(function(i){if(i.Error==r.basic.DataStat.Success){var u=i.Data;n&&n.IsOpen&&l.apis.Article.New(function(i){var e=i.Error,f=i.Data;e===r.basic.DataStat.Success&&(f.Owner=n,f.Product=u,f.Count=1,t.edit(f,function(i){i.Error===r.basic.DataStat.Success?(t.Data.Recalc(),n.Articles.Add(i.Data),t.adapter.SelectItem(i.Data)):i.Data.Dispose()}))})}})},t.prototype.SelectFournisseur=function(){},t.prototype.SelectAchteur=function(){var t=this,n=this.Data,u;if(!n.IsOpen)return i.UI.InfoArea.push("La facture est fermer");u=n.Client;l.apis.Client.Select(function(i){var u=i.Data;if(i.Error==r.basic.DataStat.Success){if(!u)return t.SelectAchteur();l.requester.Request(f.models.Facture,"SetProperty",null,{Property:"Client",Id:n.Id,Value:u.Id},function(t,i,r){r&&(n.Client=u)})}},this.Data.Client)},t.prototype.Validate=function(){r.Api.RiseApi("ValidateFacture",{data:this.Data})},t.prototype.Print=function(n){var t=new f.Printing.PrintData,i;t.HandlerId="FacturePrinter";t.DataId=this.Data.Id;t.Model=n;i=this;l.requester.Request(f.Printing.PrintData,"PRINT",t,null,function(n){var t=n.data,i;t.Response&&t.Response.Success&&(i=__global.ApiServer.Combine("/_/$").FullPath+"?Id="+t.Response.FileName,s.Forms.PDFViewer.Show(i))},null,null,this)},t.prototype.Delete=function(){r.Api.RiseApi("DeleteFacture",{data:this.Data})},t.prototype.New=function(){var n=this;l.apis.Article.New(function(t){t.Error==e.basics.DataStat.Success?(n.Data.Articles.Add(t.Data),n.Data.Recalc()):i.UI.InfoArea.push("UnExpected  Error")})},t.prototype.OnBringIntoFront=function(){var t=this,n=this.adapter.Data,r;n==null&&i.UI.Modal.ShowDialog("Facture De Livraison","There no facture selected do you want to create new one",function(n){if(n.Result===i.UI.MessageResult.ok)t.New();else{var r=t.parent;r.Select("facture_clientels")}},"Create New","Cancel");r=n&&n.Client?n.Client.Abonment:0;a.Value=r;this.abonment.Box.Enable=!0;this.Enable=!!n},t.prototype.OnAbonmentChanged=function(n,t,i){var r=this.Data;r&&(r.Abonment=i.Value)},t}(u.Facture);t.FactureVent=y;var w=r.basic.getEnum("models.Abonment"),p=function(){function n(n,t){this.target=n;this.printModeHandlerId=t}return n.prototype.GetLeftBar=function(){var n=this;return this.lb||(this._edit=new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit"),this._new=new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"New"),this._delete=new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete"),this._acht=new i.UI.Glyph(i.UI.Glyphs.user,!1,"Achteur"),this._forn=new i.UI.Glyph(i.UI.Glyphs.home,!1,"Fournisseur"),this._creditCart=new i.UI.Glyph(i.UI.Glyphs.creditCard,!1,"Versments"),this._stat=new i.UI.Glyph(i.UI.Glyphs.stats,!1,"Statistics"),this._info=new i.UI.Glyph(i.UI.Glyphs.infoSign,!1,"Information"),this._prod=new i.UI.Glyph(i.UI.Glyphs.rub,!1,"Insert New Product"),this.lb=new i.UI.Navbar,u.funcs.setTepmlate(this.lb,this,this.handleSerices),this.rm=new i.UI.RichMenu(undefined,["Regler","Verser","Supprimer","","Ouvrir"],this._creditCart),l.requester.Request(f.Printing.PrintData,"MODELS",new r.collection.List(String),{HandlerId:this.printModeHandlerId},function(t){n.printMenu=new i.UI.RichMenu(undefined,t.data.AsList(),n._print)},null,null,this),this.lb.OnInitialized=function(t){return t.AddRange([n._new,n._edit,n._delete,u.funcs.createSparator(),n._forn,n._acht,n._creditCart,u.funcs.createSparator(),n._stat,n._info,u.funcs.createSparator(),u.funcs.createSparator(),n._prod])}),this.lb},n.prototype.GetRightBar=function(){var n=this;return this.rb||(this._print=new i.UI.Glyph(i.UI.Glyphs.print,!1,"Print"),this._save=new i.UI.Glyph(i.UI.Glyphs.floppyDisk,!1,"Save"),this._valid=new i.UI.Glyph(i.UI.Glyphs.check,!1,"Validate"),this.rb=new i.UI.Navbar,u.funcs.setTepmlate(this.rb,this,this.handleSerices),this.rb.OnInitialized=function(t){return t.AddRange([n._print,u.funcs.createSparator(),n._valid,n._save])}),this.rb},n.prototype.handleSerices=function(n,t,r){var u=i.UI.Glyphs,f=r.t.target;switch(r.c){case u.print:r.t.printMenu.Open(t,{Owner:r.t,Invoke:r.t.OnPrintContextMenuFired},null,!0);break;case u.floppyDisk:f.SaveFacture();break;case u.check:f.Validate();break;case u.fire:f.Delete();break;case u.plusSign:f.New();break;case u.user:f.SelectAchteur();break;case u.home:f.SelectFournisseur();break;case u.creditCard:r.t.rm.Open(t,{Owner:r.t,Invoke:r.t.OnContextMenuFired},null,!0);break;case u.infoSign:f.OpenInfo();break;case u.rub:f.NewProduct();break;case u.stats:f.OpenStatistics();return;case u.edit:f.edit();return;default:i.UI.InfoArea.push("This Option need for money to activate");return}},n.prototype.HideFournisseur=function(){this._forn.Visible=!1},n.prototype.ShowFournisseur=function(){this._forn.Visible=!0},n.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.target.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.target.verser(t==="Regler")},n.prototype.OnPrintContextMenuFired=function(n,t){this.target.Print(t)},n}(),b=function(){function n(){}return n.prototype.GetRightBar=function(){var n=this,t;return this.lb||(this._print=new i.UI.Glyph(i.UI.Glyphs.print,!1,"Print"),this._open=new i.UI.Glyph(i.UI.Glyphs.open,!1,"Open"),this._new=new i.UI.Glyph(i.UI.Glyphs.openFile,!1,"New"),this.lb=new i.UI.Navbar,t=this.lb.getTemplate,this.lb.getTemplate=function(n){var r=t(new i.UI.Anchore(n));return n.Enable||(r.Enable=!1),r},this.lb.OnInitialized=function(t){return t.AddRange([n._print,n._open,n._new])},this.lb.OnSelectedItem.On=function(){}),this.lb},n.prototype.GetLeftBar=function(){var n=this,t;return this.rb||(this._update=new i.UI.Glyph(i.UI.Glyphs.banCircle,!1,"Update"),this._validate=new i.UI.Glyph(i.UI.Glyphs.openFile,!1,"Validate"),this._save=new i.UI.Glyph(i.UI.Glyphs.openFile,!1,"Save"),this._delete=new i.UI.Glyph(i.UI.Glyphs.openFile,!1,"Delete"),this.rb=new i.UI.Navbar,t=this.rb.getTemplate,this.rb.getTemplate=function(n){return t(new i.UI.Anchore(n))},this.rb.OnInitialized=function(t){t.AddRange([n._delete,u.funcs.createSparator(),n._save,n._validate,n._update])}),this.rb},n}()});define("abstract/Models",["require","exports","../lib/q/sys/Corelib","../lib/q/sys/System","../lib/Q/sys/UI"],function(n,t,i,r,u){"use strict";function o(n){var i,t,r;if(n==null)return 0;for(i=0,t=0,r=n.Count;t<r;t++)i+=n.Get(t).Montant;return i}var e,f,s;Object.defineProperty(t,"__esModule",{value:!0});e=i.bind.DObject.CreateField("CheckLogging",Boolean,null,null,null,i.bind.PropertyAttribute.NonSerializable),function(n){function s(){return delete n.get,e}var f,o,h,c,l,a,v,y,p,w,t,u;(function(n){n[n.Detaillant=0]="Detaillant";n[n.Proffessional=1]="Proffessional";n[n.WGrossit=2]="WGrossit";n[n.Grossist=2]="Grossist";n[n.Entrepreneur=3]="Entrepreneur"})(f=n.Job||(n.Job={})),function(n){n[n.Detaillant=0]="Detaillant";n[n.Proffessionnal=1]="Proffessionnal";n[n.DemiGrossist=2]="DemiGrossist";n[n.Grossist=3]="Grossist";n[n.Importateur=4]="Importateur";n[n.Exportateur=5]="Exportateur"}(o=n.Abonment||(n.Abonment={}));n.get=s,function(n){n[n.Espece=0]="Espece";n[n.CCP=1]="CCP";n[n.CIB=2]="CIB";n[n.Cheque=3]="Cheque";n[n.EPay=4]="EPay";n[n.QPay=5]="QPay"}(h=n.VersmentType||(n.VersmentType={}));c=0;l=4096,function(n){n[n.Bon=2]="Bon";n[n.Facture=4]="Facture";n[n.Devise=4098]="Devise";n[n.ProFormat=4100]="ProFormat"}(a=n.BonType||(n.BonType={})),function(n){n[n.Vente=0]="Vente";n[n.Neutre=1]="Neutre";n[n.Avoir=2]="Avoir"}(v=n.TransactionType||(n.TransactionType={})),function(n){n[n.Achat=0]="Achat";n[n.Neutre=1]="Neutre";n[n.Avoir=2]="Avoir"}(y=n.FTransactionType||(n.FTransactionType={})),function(n){n[n.None=0]="None";n[n.Agent=1]="Agent";n[n.Vendeur=3]="Vendeur";n[n.Achteur=5]="Achteur";n[n.Cassier=9]="Cassier";n[n.Validateur=17]="Validateur";n[n.Admin=-1]="Admin"}(p=n.AgentPermissions||(n.AgentPermissions={})),function(n){n[n.None=0]="None";n[n.Low=1]="Low";n[n.Medium=2]="Medium";n[n.High=3]="High"}(w=n.Quality||(n.Quality={}));t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStore=function(){return r.store},r.prototype.Update=function(){},r.prototype.Upload=function(){},Object.defineProperty(r.prototype,"From",{get:function(){return this.get(r.DPFrom)},set:function(n){this.set(r.DPFrom,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"To",{get:function(){return this.get(r.DPTo)},set:function(n){this.set(r.DPTo,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"IsReaded",{get:function(){return this.get(r.DPIsReaded)},set:function(n){this.set(r.DPIsReaded,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Title",{get:function(){return this.get(r.DPTitle)},set:function(n){this.set(r.DPTitle,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Message",{get:function(){return this.get(r.DPMessage)},set:function(n){this.set(r.DPMessage,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Date",{get:function(){return this.get(r.DPDate)},set:function(n){this.set(r.DPDate,n)},enumerable:!0,configurable:!0}),r.__fields__=function(){return[this.DPFrom,this.DPTo,this.DPIsReaded,this.DPTitle,this.DPMessage,this.DPDate]},r.ctor=function(){this.DPFrom=i.bind.DObject.CreateField("From",n.Client,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPTo=i.bind.DObject.CreateField("To",n.Client,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPIsReaded=i.bind.DObject.CreateField("IsReaded",Boolean);this.DPTitle=i.bind.DObject.CreateField("Title",String);this.DPMessage=i.bind.DObject.CreateField("Message",String);this.DPDate=i.bind.DObject.CreateField("Date",Date)},r.store=new i.collection.Dictionary("sms"),r}(r.sdata.QShopRow);n.SMS=t;u=function(t){function i(i,r){var u=t.call(this,null,n.SMS,function(t){return new n.SMS(t)})||this;return u.category=i,u.Tag=r,u}return __extends(i,t),Object.defineProperty(i.prototype,"ArgType",{get:function(){return n.SMS},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return n.SMS},i.prototype.GetType=function(){return i},i}(r.sdata.DataTable);n.SMSs=u}(f=t.models||(t.models={})),function(n){function dt(n){n.__this.SetValue(w.DPSoldTotal,(n.__this.MontantTotal||0)-(n.__this.VersmentTotal||0))}function ai(n){var t=RegExp(""+n+"[^;,]+$").exec(document.cookie);return decodeURIComponent(!t?"":t.toString().replace(/^[^=]+./,""))}function vi(){var n=ai("id");return n&&(n=n.trim())!=""?n:"new_account"}var kt=new i.collection.Dictionary("sfactures",!1),lt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Address",{get:function(){return this.get(t.DPAddress)},set:function(n){this.set(t.DPAddress,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ville",{get:function(){return this.get(t.DPVille)},set:function(n){this.set(t.DPVille,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CodePostal",{get:function(){return this.get(t.DPCodePostal)},set:function(n){this.set(t.DPCodePostal,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SiteWeb",{get:function(){return this.get(t.DPSiteWeb)},set:function(n){this.set(t.DPSiteWeb,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Email",{get:function(){return this.get(t.DPEmail)},set:function(n){this.set(t.DPEmail,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Tel",{get:function(){return this.get(t.DPTel)},set:function(n){this.set(t.DPTel,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Mobile",{get:function(){return this.get(t.DPMobile)},set:function(n){this.set(t.DPMobile,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPAddress,this.DPVille,this.DPCodePostal,this.DPSiteWeb,this.DPEmail,this.DPTel,this.DPMobile]},t.ctor=function(){this.DPAddress=i.bind.DObject.CreateField("Address",String);this.DPVille=i.bind.DObject.CreateField("Ville",String);this.DPCodePostal=i.bind.DObject.CreateField("CodePostal",String);this.DPSiteWeb=i.bind.DObject.CreateField("SiteWeb",String);this.DPEmail=i.bind.DObject.CreateField("Email",String);this.DPTel=i.bind.DObject.CreateField("Tel",String);this.DPMobile=i.bind.DObject.CreateField("Mobile",String)},t}(r.sdata.QShopRow),at,w,y,gt,tt,vt,yt,s,it,o,rt,ut,c,b,ft,pt,wt,et,l,ot,ni,st,ti,k,a,h,d,v,g,t,ht,nt,ii,ri,p,f,bt,ui,fi,ei,oi,si,hi,ci,ct,li;n.SiegeSocial=lt;at=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"RIB",{get:function(){return this.get(t.DPRIB)},set:function(n){this.set(t.DPRIB,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NRC",{get:function(){return this.get(t.DPNRC)},set:function(n){this.set(t.DPNRC,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NIF",{get:function(){return this.get(t.DPNIF)},set:function(n){this.set(t.DPNIF,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NCompte",{get:function(){return this.get(t.DPNCompte)},set:function(n){this.set(t.DPNCompte,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CapitalSocial",{get:function(){return this.get(t.DPCapitalSocial)},set:function(n){this.set(t.DPCapitalSocial,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NAI",{get:function(){return this.get(t.DPNAI)},set:function(n){this.set(t.DPNAI,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NIS",{get:function(){return this.get(t.DPNIS)},set:function(n){this.set(t.DPNIS,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPRIB,this.DPNRC,this.DPNIF,this.DPNCompte,this.DPCapitalSocial,this.DPNAI,this.DPNIS]},t.ctor=function(){this.DPRIB=i.bind.DObject.CreateField("RIB",String);this.DPNRC=i.bind.DObject.CreateField("NRC",String);this.DPNIF=i.bind.DObject.CreateField("NIF",String);this.DPNCompte=i.bind.DObject.CreateField("NCompte",String);this.DPCapitalSocial=i.bind.DObject.CreateField("CapitalSocial",String);this.DPNAI=i.bind.DObject.CreateField("NAI",String);this.DPNIS=i.bind.DObject.CreateField("NIS",String)},t}(lt);n.Shop=at;w=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return[this.DPName,this.DPAvatar,this.DPObservation,this.DPVersmentTotal,this.DPMontantTotal,this.DPNFactures,this.DPSoldTotal]},Object.defineProperty(t.prototype,"SoldTotal",{get:function(){return this.get(t.DPSoldTotal)},enumerable:!0,configurable:!0}),t.ctor=function(){this.DPName=i.bind.DObject.CreateField("Name",String);this.DPAvatar=i.bind.DObject.CreateField("Avatar",String);t.DPObservation=i.bind.DObject.CreateField("Observation",String);t.DPVersmentTotal=i.bind.DObject.CreateField("VersmentTotal",Number,null,dt);t.DPMontantTotal=i.bind.DObject.CreateField("MontantTotal",Number,null,dt);t.DPNFactures=i.bind.DObject.CreateField("NFactures",Number,null);t.DPSoldTotal=i.bind.DObject.CreateField("SoldTotal",Number,0,null,null,i.bind.PropertyAttribute.Private)},t}(at);n.Dealer=w;y=function(n){function t(t,r){var u=n.call(this,t)||this;return u._region=new i.basic.Rectangle,u.ImageUrl=r,u}return __extends(t,n),t.__fields__=function(){return[t.DPImageUrl]},Object.defineProperty(t.prototype,"Region",{get:function(){return this._region},enumerable:!0,configurable:!0}),t.getById=function(n){return t.pstore.Get(n)},t.prototype.getStore=function(){return t.pstore},t.DPImageUrl=i.bind.DObject.CreateField("ImageUrl",String,""),t.pstore=new i.collection.Dictionary("Pictures",!0),t}(r.sdata.QShopRow);n.Picture=y;gt=function(n){function t(t,i){return n.call(this,t,y,function(n){return new y(n)},i)||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return y},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return y},t.prototype.GetType=function(){return t},t}(r.sdata.DataTable);n.Pictures=gt;tt=function(t){function u(){return t!==null&&t.apply(this,arguments)||this}return __extends(u,t),u.__fields__=function(){return[this.DPTotal,this.DPDateLivraison,this.DPDate,this.DPEditeur,this.DPValidator,this.DPObservation,this.DPLockedBy,this.DPLockedAt,this.DPType,this.DPIsValidated,this.DPIsOpen,this.DPNArticles,this.DPRef,this.DPSold,this.DPVersment,this.DPTransaction]},Object.defineProperty(u.prototype,"Factor",{get:function(){return this.Type<4096?this.Transaction==n.TransactionType.Avoir?-1:1:1},enumerable:!0,configurable:!0}),u.prototype.onTransactionChanging=function(t){if(n.TransactionType[t._new]==undefined)t._new=t._old||n.TransactionType.Vente;else switch(this.Type){case n.BonType.Bon:case n.BonType.Facture:t._new==n.TransactionType.Neutre&&(t._new=n.TransactionType.Vente);break;default:t._new!==n.TransactionType.Neutre&&(t._new=n.TransactionType.Neutre)}},u.prototype.SetFactureType=function(t,i){t=t==undefined?this.Type:t;i=i==undefined?this.Transaction:i;t>4096?i=n.TransactionType.Neutre:i==n.TransactionType.Neutre&&(i=n.TransactionType.Vente);this.set(u.DPTransaction,i);this.set(u.DPType,t)},u.prototype.factureTypeChanged=function(n){n.prop===u.DPType?this.SetFactureType(n._new,undefined):this.SetFactureType(undefined,n._new)},u.prototype.ClearVersments=function(){return this.MakeChange(function(){var n=this.Versments;n?n.Clear():this.Versments=this.createNewVersments()},this),this.Versments},u.prototype.IsFrozen=function(){return!this.IsOpen},u.prototype.Freeze=function(){this.IsOpen=!1},u.prototype.UnFreeze=function(){this.IsOpen=!0},u.prototype.set=function(n,i,r){var f=n===u.DPIsOpen,e;return f&&this._isFrozen&&(this._isFrozen=!1),e=t.prototype.set.call(this,n,i,r),f&&!i&&(this._isFrozen=!0),e},Object.defineProperty(u.prototype,"IsOpen",{get:function(){return this.get(u.DPIsOpen)},set:function(n){this.set(u.DPIsOpen,n)},enumerable:!0,configurable:!0}),u.prototype.MakeChange=function(n,t,i,r,u){var f=this._isFrozen;f&&(this._isFrozen=!1);try{n.call(this,t,i,r,u)}catch(e){}this._isFrozen=f},u.ctor=function(){u.DPLockedAt=i.bind.DObject.CreateField("LockedAt",Date,null,null,null,i.bind.PropertyAttribute.NonSerializable);u.DPLockedBy=i.bind.DObject.CreateField("LockedBy",f,null,null,null,i.bind.PropertyAttribute.NonSerializable);u.DPEditeur=i.bind.DObject.CreateField("Editeur",n.Client,null,null,null,i.bind.PropertyAttribute.SerializeAsId);u.DPValidator=i.bind.DObject.CreateField("Validator",f,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},u.prototype.Recalc=function(n){this.MakeChange(u._recalc,n)},u.prototype.FromJson=function(n,i,r){return n&&(t.prototype.FromJson.call(this,n,i,r),typeof n.IsFrozen=="boolean"&&(this.IsOpen=!n.IsFrozen)),this},u.DPTotal=i.bind.DObject.CreateField("Total",Number,0,function(n){var t=n.__this;t.Sold=t.Total-t.Versment},null,i.bind.PropertyAttribute.NonSerializable),u.DPDateLivraison=i.bind.DObject.CreateField("DateLivraison",Date,null),u.DPDate=i.bind.DObject.CreateField("Date",Date,null),u.DPObservation=i.bind.DObject.CreateField("Observation",String,null),u.DPType=i.bind.DObject.CreateField("Type",Number,n.BonType.Bon,u.prototype.factureTypeChanged,function(t){n.BonType[t._new]==undefined&&(t._new=t._old||n.BonType.Bon)},i.bind.PropertyAttribute.NonSerializable),u.DPTransaction=i.bind.DObject.CreateField("Transaction",Number,n.TransactionType.Vente,u.prototype.factureTypeChanged,u.prototype.onTransactionChanging,i.bind.PropertyAttribute.NonSerializable),u.DPIsValidated=i.bind.DObject.CreateField("IsValidated",Boolean,null,null,null,i.bind.PropertyAttribute.NonSerializable),u.DPVersments=i.bind.DObject.CreateField("Versments",r.sdata.DataTable,null,null,null,i.bind.PropertyAttribute.Private),u.DPIsOpen=i.bind.DObject.CreateField("IsOpen",Boolean,!1,function(n){!!n._new},function(n){typeof n._new!="boolean"&&(n._new=!!n._new)},i.bind.PropertyAttribute.NonSerializable|i.bind.PropertyAttribute.Private),u.DPNArticles=i.bind.DObject.CreateField("NArticles",Number,0,null,null,i.bind.PropertyAttribute.NonSerializable),u.DPRef=i.bind.DObject.CreateField("Ref",String,null,null,null,i.bind.PropertyAttribute.NonSerializable),u.DPSold=i.bind.DObject.CreateField("Sold",Number,null,null,null,i.bind.PropertyAttribute.NonSerializable),u.DPVersment=i.bind.DObject.CreateField("Versment",Number,0,function(n){var t=n.__this;t.Sold=t.Total-t.Versment},null,i.bind.PropertyAttribute.NonSerializable),u._recalc=function(n){var t,u,i,r;try{if(this.Total=NaN,t=this.CalcTotal(),this.Total=t,n=n||this.Versments,n){for(u=n.AsList(),i=0,r=u.length-1;r>=0;r--)i+=u[r].Montant;this.Versment=i;this.Sold=NaN;this.Sold=t-i}else this.Versement!=undefined&&(this.Sold=NaN,this.Sold=t-this.Versment)}catch(f){}},u}(r.sdata.QShopRow);n.FactureBase=tt;vt=function(t){function r(n){return t.call(this,n)||this}return __extends(r,t),Object.defineProperty(r.prototype,"FullName",{get:function(){return this.get(r.DPFullName)},enumerable:!0,configurable:!0}),r.prototype.toString=function(){return(this.get(r.DPFullName)||"")+" \tTel:"+(this.get(lt.DPTel)||"")},r.__fields__=function(){return[r.DPFirstName,r.DPLastName,r.DPJob,r.DPWorkAt,r.DPFullName,r.DPAbonment]},r.getById=function(n){return r.pstore.Get(n)},r.prototype.getStore=function(){return r.pstore},r.ctor=function(){this.DPWorkAt=i.bind.DObject.CreateField("WorkAt",String,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},r.DPAbonment=i.bind.DObject.CreateField("Abonment",Number,0,null,function(t){t._new==null&&(t._new=n.Abonment.Detaillant)}),r.DPFirstName=i.bind.DObject.CreateField("FirstName",String,null,function(n){n.__this.set(r.DPFullName,(n._new||"")+" "+(n.__this.LastName||""))}),r.DPLastName=i.bind.DObject.CreateField("LastName",String,null,function(n){n.__this.set(r.DPFullName,(n.__this.FirstName||"")+" "+(n._new||""))}),r.DPFullName=i.bind.DObject.CreateField("FullName",String,null,null,null,i.bind.PropertyAttribute.Private),r.DPJob=i.bind.DObject.CreateField("Job",Number,n.Job.Detaillant),r.pstore=new i.collection.Dictionary("Clients",!0),r}(w);n.Client=vt;yt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Name",{get:function(){return this.get(t.DPName)},set:function(n){this.set(t.DPName,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPName]},t.ctor=function(){this.DPName=i.bind.DObject.CreateField("Name",String)},t.prototype.getStore=function(){return t._pstore},t._pstore=new i.collection.Dictionary("Projets"),t}(n.SiegeSocial);n.Projet=yt;s=function(r){function u(n){var t=r.call(this,n)||this;return t.ArticlesListener={Invoke:t.OnArticlesChanged,Owner:t},t.set(u.DPArticles,new rt(t)),t}return __extends(u,r),u.__fields__=function(){return[this.DPFournisseur,this.DPAchteur,this.DPArticles]},u.prototype.createNewVersments=function(){return new wt(this)},u.prototype.OnArticlesChanged=function(){var t=this.get(u.DPArticles),r=0,n,f,i;if(t)for(n=0,f=t.Count;n<f;n++)i=t.Get(n),r+=i.Qte*i.PSel;this.set(u.DPTotal,r)},u.prototype.CalcTotal=function(){var t=this.get(u.DPArticles),i=0,n,r,f;if(t)for(n=0,r=t.Count;n<r;n++)f=t.Get(n),i+=f.Qte*f.PSel;return this.set(u.DPTotal,i),this.NArticles=r,i},u.prototype.getStore=function(){return kt},u.getById=function(n){return kt.Get(n)},u.prototype.toString=function(){return this._str||(this._str=n.BonType[this.Type]+" "+this.Ref+":  ["+t.getString(this.get(u.DPFournisseur))+"\rdate:"+t.getString(this.get(t.DPDate))+"\rdatelivraison:"+t.getString(this.get(t.DPDateLivraison))+"]")},u.ctor=function(){this.DPFournisseur=i.bind.DObject.CreateField("Fournisseur",l,null,null,null,i.bind.PropertyAttribute.NonSerializable);this.DPAchteur=i.bind.DObject.CreateField("Achteur",f,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPArticles=i.bind.DObject.CreateField("Articles",rt,null,null,function(t){if(t._new==null){var i=t._old;if(i){i.UnFreeze();i.Clear();t._new=i;return}t._new=new n.FakePrices(t.__this,[])}},i.bind.PropertyAttribute.NonSerializable)},u}(tt);n.SFacture=s;it=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.CalclMoyen=function(n,t){var e=n.Qte||0,s=t.Qte||0,h=e+s,c,i,u,f;for(h==0&&(e=1,s=1,h=2),c=r.__fields__(),i=new o,u=0;u<c.length-1;u++)f=c[u],i.set(f,((n.get(f)||0)*e+(t.get(f)||0)*s)/h);return t instanceof o&&(i.Product=t.Product),i},r.__fields__=function(){return[r.DPPSel,r.DPValue,r.DPPValue,r.DPHWValue,r.DPWValue,r.DPQte]},r.prototype.GetPrice=function(n){return n<4&&n>=0?this.get(this.GetDProperty(n)):this.Value},r.prototype.GetDProperty=function(n){return n<4&&n>=0?i.bind.DObject.GetDPropertyAt(this.constructor,r.DPValue.Index+n):r.DPValue},r.GetDProperty=function(n){return n<4&&n>=0?i.bind.DObject.GetDPropertyAt(this,r.DPValue.Index+n):r.DPValue},r.GetAbonment=function(t){var i=t.Index-r.DPValue.Index;return i<0||i>3?n.Abonment.Detaillant:i},r.prototype.ISetValue=function(n,t){var i=this.GetDProperty(n);i?this.set(i,t):this.set(r.DPValue,t)},r.prototype.IGetValue=function(n){var t=this.GetDProperty(n);return t?this.get(t):undefined},r.prototype.ClonePrices=function(n,t){n.Value=this.Value;n.PValue=this.PValue;n.HWValue=this.HWValue;n.WValue=this.WValue;t&&(n.PSel=this.PSel)},r.prototype.getStore=function(){return r.pStore},r.DPPSel=i.bind.DObject.CreateField("PSel",Number,0),r.DPValue=i.bind.DObject.CreateField("Value",Number,0),r.DPPValue=i.bind.DObject.CreateField("PValue",Number,0),r.DPHWValue=i.bind.DObject.CreateField("HWValue",Number,0),r.DPWValue=i.bind.DObject.CreateField("WValue",Number,0),r.DPQte=i.bind.DObject.CreateField("Qte",Number,null),r.pStore=new i.collection.Dictionary("prices"),r}(r.sdata.QShopRow);n.Price=it;o=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.__fields__=function(){return[r.DPProduct,r.DPNextRevage,r.DPSFacture,r.DPApplyPrice]},r.ctor=function(){this.DPApplyPrice=i.bind.DObject.CreateField("ApplyPrice",r);this.DPProduct=i.bind.DObject.CreateField("Product",h,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPNextRevage=i.bind.DObject.CreateField("NextRevage",r,null,null,null,i.bind.PropertyAttribute.NonSerializable);this.DPSFacture=i.bind.DObject.CreateField("Facture",s,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},r.prototype.getStore=function(){return r.pStore},r.getById=function(n){return r.pStore.Get(n)},r.prototype.test=function(n){switch(n.keyCode){case u.UI.Keys.F2:this.calc("current");break;case u.UI.Keys.F3:this.calc("calc");break;case u.UI.Keys.F5:this.applyPrice("moyen");break;case u.UI.Keys.F6:this.applyPrice("percent");break;case u.UI.Keys.F7:this.applyPrice("new");break;case u.UI.Keys.F8:this.applyPrice("old");break;default:return}n.stopImmediatePropagation();n.stopPropagation();n.preventDefault()},r.prototype.calcPrices=function(){},r.prototype.applyPrice=function(t){var i=this,f=i.Facture,r;if(f&&!f.IsOpen)return u.UI.Modal.ShowDialog("Apprentissage","La Facture Is Clossed donc vous ne pouver pas executer cette command",null,"Ok",null);if(r=i.Product,r==null)return u.UI.Modal.ShowDialog("Apprentissage","Vous dever selectioner un produit pour appliquer le prix");switch(t){case"moyen":i.ApplyPrice=n.Price.CalclMoyen(r,i);break;case"new":i.ApplyPrice=i;break;case"old":i.ApplyPrice=null;break;case"percent":u.UI.InfoArea.push("this option is depricated")}},r.prototype.calc=function(t){var o,l,h,s,c,f,e;switch(t){case"costume":for(e=this,o=e.ApplyPrice===e||e.ApplyPrice==null?new r(i.basic.New()):e.ApplyPrice,f=3;f>=0;f--)o.ISetValue(f,e.GetPrice(f));o.PSel=e.PSel;o.Product=e.Product;o.Qte=e.Product.Qte;e.ApplyPrice=o;break;case"current":if(l=this,l instanceof n.Product)return;if(s=this,h=s.Product,!h)return u.UI.InfoArea.push("The product of this revage is not setted",!1);for(f=3;f>=0;f--)s.ISetValue(f,h.GetPrice(f));break;case"calc":for(s=this,c=s.PSel,f=3;f>=0;f--)s.ISetValue(f,c=parseFloat(i.math.round(c*1.33,2)));break;case"default":e=this;e.ApplyPrice=e}},r.prototype.ToList=function(){var t=[],n=this;do{if(t.indexOf(n)!==-1)break;t.push(n);n=n.NextRevage}while(n!=null);return new i.collection.List(r,t)},r.prototype.toString=function(){return(this.get(r.DPProduct)||"").toString()},r.prototype.Freeze=function(){},r.prototype.UnFreeze=function(){},r.pStore=new i.collection.Dictionary("fakes"),r}(it);n.FakePrice=o;rt=function(n){function t(t,i){return n.call(this,t,o,function(n){return new o(n)},i)||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return o},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return o},t.prototype.GetType=function(){return t},t.prototype.Freeze=function(){},t.prototype.UnFreeze=function(){},t}(r.sdata.DataTable);n.FakePrices=rt;ut=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.ctor=function(){this.DPMontant=i.bind.DObject.CreateField("Montant",Number,0);this.DPType=i.bind.DObject.CreateField("Type",Number,n.VersmentType.Espece);this.DPDate=i.bind.DObject.CreateField("Date",Date,new Date);this.DPCassier=i.bind.DObject.CreateField("Cassier",f,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPObservation=i.bind.DObject.CreateField("Observation",String,null)},r.__fields__=function(){return[r.DPType,r.DPMontant,r.DPDate,this.DPCassier,this.DPObservation,this.DPRef]},r.DPRef=i.bind.DObject.CreateField("Ref",String,null),r}(r.sdata.QShopRow);n.VersmentBase=ut;c=function(r){function u(n){return r.call(this,n)||this}return __extends(u,r),u.__fields__=function(){return[this.DPClient,this.DPFacture]},Object.defineProperty(u.prototype,"Partner",{get:function(){return this.get(u.DPClient)},enumerable:!0,configurable:!0}),u.ctor=function(){this.DPClient=i.bind.DObject.CreateField("Client",vt,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPFacture=i.bind.DObject.CreateField("Facture",t,null)},u.getById=function(n){return u.pstore.Get(n)},u.prototype.getStore=function(){return u.pstore},u.prototype.toString=function(){var t=(t=this.Client)&&(t=t.FullName||""),i=(i=this.Cassier)&&(i=i.Name)||"";return"Le client "+t+" Verser � "+i+" a la date "+this.Date+" le montant "+this.Montant+" DZD en "+n.VersmentType[this.Type]+' \r\n et remarquer que "'+this.Observation+'" '},u.pstore=new i.collection.Dictionary("Versments",!0),u}(ut);n.Versment=c;b=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Partner",{get:function(){return this.get(t.DPFournisseur)},enumerable:!0,configurable:!0}),t.ctor=function(){this.DPFournisseur=i.bind.DObject.CreateField("Fournisseur",l,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPFacture=i.bind.DObject.CreateField("Facture",s,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},t.__fields__=function(){return[this.DPFournisseur,this.DPFacture]},t.getById=function(n){return t.pstore.Get(n)},t.prototype.getStore=function(){return t.pstore},t.pstore=new i.collection.Dictionary("SVersments",!0),t}(ut);n.SVersment=b;ft=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(r.sdata.DataTable);n.BVersments=ft;pt=function(n){function t(t){var i=n.call(this,t,c,function(n){return new c(n)})||this;return i.Owner=t,i}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return c},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return c},t.prototype.GetType=function(){return t},t}(ft);n.Versments=pt;wt=function(n){function t(t){var i=n.call(this,t,c,function(n){return new b(n)})||this;return i.Owner=t,i}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return b},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return b},t.prototype.GetType=function(){return t},t}(ft);n.SVersments=wt;et=function(t){function i(i,r){return t.call(this,i,n.Client,function(t){return new n.Client(t)},r)||this}return __extends(i,t),Object.defineProperty(i.prototype,"ArgType",{get:function(){return n.Client},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return n.Client},i.prototype.GetType=function(){return i},i.prototype.Freeze=function(){},i.prototype.OnDeserialize=function(){this.Order(function(n,t){return(n.Name||"").localeCompare(t.Name||"")})},i}(r.sdata.DataTable);n.Costumers=et;l=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.__fields__=function(){return[this.DPRef]},t.prototype.getStore=function(){return t._mystore},t.prototype.toString=function(){return(this.Name||"")+" / "+(this.Tel||"")},t.getById=function(i,r){return t._mystore.Get(i)||n.getById.call(this,i,r)},t.DPRef=i.bind.DObject.CreateField("Ref",String,null),t._mystore=new i.collection.Dictionary("Fournisseurs",!1),t}(w);n.Fournisseur=l;ot=function(t){function i(i,r){return t.call(this,i,n.Client,function(n){return new l(n)},r)||this}return __extends(i,t),Object.defineProperty(i.prototype,"ArgType",{get:function(){return l},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return l},i.prototype.GetType=function(){return i},i.prototype.OnDeserialize=function(){this.Order(function(n,t){return(n.Name||"").localeCompare(t.Name||"")})},i}(r.sdata.DataTable);n.Fournisseurs=ot;ni=function(t){function i(i,r){return t.call(this,i,n.Client,function(t){return new n.Client(t)},r)||this}return __extends(i,t),Object.defineProperty(i.prototype,"ArgType",{get:function(){return n.Client},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return n.Client},i.prototype.GetType=function(){return i},i}(r.sdata.DataTable);n.Clients=ni;st=function(t){function i(i,r){return t.call(this,i,n.Projet,function(t){return new n.Projet(t)},r)||this}return __extends(i,t),i.__fields__=function(){return[]},Object.defineProperty(i.prototype,"ArgType",{get:function(){return n.Projet},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return n.Projet},i.prototype.GetType=function(){return i},i}(r.sdata.DataTable);n.Projets=st;ti=function(t){function i(i,r){return t.call(this,i,n.Mail,function(t){return new n.Mail(t)},r)||this}return __extends(i,t),i}(r.sdata.DataTable);n.Mails=ti;k=function(n){function t(t){return n.call(this,t,a,function(n){return new a(n)})||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return a},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return a},t.prototype.GetType=function(){return t},t}(r.sdata.DataTable);n.Categories=k;a=function(n){function t(t){var i=n.call(this,t)||this;return i._s=null,i}return __extends(t,n),t.__fields__=function(){return[t.DPName,t.DPBase]},t.GetCategory=function(n){var i=t._categoriesStore.Get(n);return i==null&&(i=new t(n),i.Update()),i},Object.defineProperty(t,"Categories",{get:function(){return t._categoriesStore},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.Name},t.prototype.getStore=function(){return t.pstore},t.getById=function(n){return t.pstore.Get(n)},t.ctor=function(){this.DPName=i.bind.DObject.CreateField("Name",String,null);this.DPBase=i.bind.DObject.CreateField("Base",t,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},t._categoriesStore=new k(null),t.pstore=new i.collection.Dictionary("categories",!0),t}(r.sdata.QShopRow);n.Category=a;h=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.toString=function(){return this._toString},t.__fields__=function(){return[this.DPCategory,this.DPName,this.DPDimention,this.DPSerieName,this.DPQuality,this.DPPicture,this.DPDescription,this.DPRevage,this.DPCurrentArticle]},t.prototype.onPropertyChanged=function(i){i.prop.Index>=t.DPName.Index&&i.prop.Index<=t.DPSerieName.Index&&(this._toString=(this.Name||"")+"  "+(this.Dimention||"")+" "+(this.SerieName||""));n.prototype.onPropertyChanged.call(this,i)},t.getById=function(n){return t.pstore.Get(n)},t.prototype.getStore=function(){return t.pstore},t.prototype.FromJson=function(t,i,r){return n.prototype.FromJson.call(this,t,i,r)},t.ctor=function(){this.DPCategory=i.bind.DObject.CreateField("Category",a,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPName=i.bind.DObject.CreateField("Name",String,null);this.DPDescription=i.bind.DObject.CreateField("Description",String);this.DPPicture=i.bind.DObject.CreateField("Picture",String);this.DPDimention=i.bind.DObject.CreateField("Dimention",String);this.DPQuality=i.bind.DObject.CreateField("Quality",Number);this.DPSerieName=i.bind.DObject.CreateField("SerieName",String);this.DPRevage=i.bind.DObject.CreateField("Revage",o,null,null,null,i.bind.PropertyAttribute.NonSerializable);this.DPCurrentArticle=i.bind.DObject.CreateField("CurrentArticle",v,null,null,null,i.bind.PropertyAttribute.Private|i.bind.PropertyAttribute.Optional)},t.pstore=new i.collection.Dictionary("Products",!0),t}(it);n.Product=h;d=function(n){function t(t,i){return n.call(this,t,h,function(n){return new h(n)},i)||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return h},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return h},t.prototype.GetType=function(){return t},t.prototype.OnDeserialize=function(){var n=new Date(Date.now());console.profile("DeserializeProducts");this.Order(function(n,t){return(n.Name||"").localeCompare(t.Name||"")});console.log("Statr DeserializeProducts "+n+" to "+new Date(Date.now()));console.profileEnd()},t}(r.sdata.DataTable);n.Products=d;v=function(r){function u(n){var t=r.call(this,n)||this;return t.OCount=0,t}return __extends(u,r),u.prototype.toString=function(){return this.Product.toString()+" Count:"+this.Count},Object.defineProperty(u.prototype,"Reduction",{get:function(){return this.get(u.DPReduction)},enumerable:!0,configurable:!0}),u.__fields__=function(){return[u.DPOwner,u.DPProduct,u.DPPrice,u.DPCount,u.DPPSel,this.DPProductName,this.DPLabel,this.DPReduction,this.DPOPrice]},u.getById=function(n){return u.pstore.Get(n)},u.prototype.getStore=function(){return u.pstore},u.prototype.FromJson=function(n,t,i){return r.prototype.FromJson.call(this,n,t,i),this.OCount=this.Count,this},u.ctor=function(){this.DPProduct=i.bind.DObject.CreateField("Product",h,null,this.prototype.WhenProductChanged,null,i.bind.PropertyAttribute.SerializeAsId);this.DPProductName=i.bind.DObject.CreateField("ProductName",String,null,this.prototype.WhenProductNameChanged,null);this.DPOwner=i.bind.DObject.CreateField("Owner",t,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPPrice=i.bind.DObject.CreateField("Price",Number,null,this.prototype.onPriceChanged);this.DPCount=i.bind.DObject.CreateField("Count",Number,0);this.DPPSel=i.bind.DObject.CreateField("PSel",Number,0);this.DPOPrice=i.bind.DObject.CreateField("OPrice",Number,0,this.prototype.onOPriceChanged);this.DPReduction=i.bind.DObject.CreateField("Reduction",Number,0,void 0,void 0,i.bind.PropertyAttribute.Private)},u.prototype.onPriceChanged=function(n){this.set(u.DPReduction,(n._new||0)-(this.OPrice||0))},u.prototype.onOPriceChanged=function(n){this.set(u.DPReduction,(this.Price||0)-(n._new||0))},u.prototype.isNullOrWhiteSpace=function(n){return n==null||n.trim()==""},u.prototype.WhenProductNameChanged=function(n){this._setLabel(this.Product,n._new)},u.prototype.WhenProductChanged=function(n){this.updateReduction(n._new);this._setLabel(n._new,this.ProductName)},u.prototype._setLabel=function(n,t){this.Label=this.isNullOrWhiteSpace(t)?n&&n.toString()||"":t},u.prototype.Freeze=function(){},u.prototype.UnFreeze=function(){},u.prototype.getValues=function(n){return{pv:this.OPrice||(n?n.GetPrice(this.Owner&&this.Owner.Abonment||0)||n.Value:0)||0,pa:this.PSel||n&&n.PSel||0}},u.prototype.updateReduction=function(n){var t=this.getValues(n).pv;this.set(u.DPReduction,this.Price-t)},u.prototype.setProduct=function(t){this.PSel=t&&t.PSel;this.OPrice=t&&t.IGetValue(this.Owner&&this.Owner.Abonment||n.Abonment.Detaillant);this.Price=this.OPrice;this.Product=t},u.prototype.setReduction=function(n){u.redEx.exec(null);var t=u.redEx.exec('\0'+n+'\0');return t&&this.calcReduction({Method:t[1],Value:parseFloat(t[2]),IsPercent:(t[4]||"").trim()=="%"})},u.prototype.calcReduction=function(n){var r=this.Product,i=this.getValues(r),t=n.Value;switch(n.Method){case"=":break;case"*":t=i.pa*t;break;case":":if(!r)return!1;t=r.GetPrice(t);break;case"+":t=n.IsPercent?i.pa*(1+t/100):i.pv+t;break;case"-":t=n.IsPercent?i.pa*(1-t/100):i.pv-t;break;case"/":t=i.pa+Math.abs(i.pv-i.pa)/t;break;default:t=n.IsPercent?t=i.pa*(1+t/100):i.pv+t}return this.Price=t,!0},u.pstore=new i.collection.Dictionary("Articles",!0),u.DPLabel=i.bind.DObject.CreateField("Label",String,"",void 0,void 0,i.bind.PropertyAttribute.Private),u.redEx=/\0([\=\*\-\+\:\/]){0,1}([\-]{0,1}[\d]+(\.[\d]+){0,1})([\%]{0,1})\0/gmi,u}(r.sdata.QShopRow);n.Article=v;g=function(n){function t(t,i){return n.call(this,t,v,function(n){return new v(n)},i)||this}return __extends(t,n),t.prototype.Freeze=function(){},t.prototype.UnFreeze=function(){},Object.defineProperty(t.prototype,"ArgType",{get:function(){return v},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return v},t.prototype.GetType=function(){return t},t.prototype.OnDeserialize=function(){function n(n){return n&&n.getTime()||0}this.Order(function(t,i){return n(t.LastModified)-n(i.LastModified)})},t}(r.sdata.DataTable);n.Articles=g;t=function(t){function r(n){var i=t.call(this,n)||this;return i.Articles=new g(i),i}return __extends(r,t),r.prototype.createNewVersments=function(){return new pt(this)},r.getString=function(n){return n==null?"null":n.toString()},r.prototype.toString=function(){return this._str||(this._str=n.BonType[this.Type]+" "+this.Ref+":  ["+r.getString(this.get(r.DPClient))+"\rdate:"+r.getString(this.get(r.DPDate))+"\rdatelivraison:"+this.get(r.DPDateLivraison)+"]")},r.__fields__=function(){return[r.DPAbonment,r.DPClient,r.DPAgent,r.DPArticles,this.DPPour]},r.prototype.CalcTotal=function(){for(var n,r=this.Articles,t=0,i=0,u=r.Count;i<u;i++)n=r.Get(i),n&&(t+=n.Count*(n.Price||0));return this.Total=t,this.NArticles=u,t},r.getById=function(n){return r.pstore.Get(n)},r.prototype.getStore=function(){return r.pstore},r.freezeArray=function(n){if(n._new==null){if(n._old==null)return;n._old.Clear();n._new=n._old}},r._ctor=function(){this.DPAgent=i.bind.DObject.CreateField("Vendeur",f,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPClient=i.bind.DObject.CreateField("Client",n.Client,null,null,null,i.bind.PropertyAttribute.NonSerializable);this.DPArticles=i.bind.DObject.CreateField("Articles",g,null,null,this.freezeArray,i.bind.PropertyAttribute.NonSerializable);this.DPAbonment=i.bind.DObject.CreateField("Abonment",Number,n.Abonment.Detaillant,null,function(t){t._new==null?t._new=n.Abonment.Detaillant:n.Abonment[t._new]==undefined&&(t._new=t._old)},i.bind.PropertyAttribute.NonSerializable);r.DPPour=i.bind.DObject.CreateField("Pour",yt,null,null,null,i.bind.PropertyAttribute.SerializeAsId)},r.prototype.Update=function(){},r.pstore=new i.collection.Dictionary("Factures",!0),r}(tt);n.Facture=t;ht=function(n){function t(t,i){return n.call(this,t,s,function(n){return new s(n)},i)||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return s},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return s},t.prototype.GetType=function(){return t},t.prototype.FromJson=function(t,i,r,u){return t?(t.__list__ instanceof Array&&t.__list__.sort(function(n,t){return t.Date-n.Date}),n.prototype.FromJson.call(this,t,i,r,u)):this},t.prototype.OnDeserialize=function(){this.Order(function(n,t){return n.Date>t.Date})},t.prototype.Freeze=function(){},t}(r.sdata.DataTable);n.SFactures=ht;nt=function(n){function i(i,r){return n.call(this,i,t,function(n){return new t(n)},r)||this}return __extends(i,n),Object.defineProperty(i.prototype,"ArgType",{get:function(){return t},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return t},i.prototype.GetType=function(){return i},i.prototype.OnDeserialize=function(){this.Order(function(n,t){return n.Date>t.Date})},i.prototype.FromJson=function(t,i,r,u){return t?(t.__list__ instanceof Array&&t.__list__.sort(function(n,t){return t.Date-n.Date}),n.prototype.FromJson.call(this,t,i,r,u)):this},i.prototype.Freeze=function(){},i}(r.sdata.DataTable);n.Factures=nt;ii=function(){function n(){}return n}();n.ii=ii;ri=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){},t}(r.sdata.QShopRow);n.Logout=ri;p=function(t){function u(n){return t.call(this,n||i.basic.New())||this}return __extends(u,t),Object.defineProperty(u.prototype,"IsLogged",{get:function(){return this.get(e)},enumerable:!0,configurable:!0}),u.prototype.Freeze=function(){},u.copy=function(n,t,i,r){var f,u;for(r===void 0&&(r=16),f=Math.min(n.length,r),u=0;u<n.length;u++)t[u+i]=n[u]==0?128:n[u];for(;u<r;u++)t[i+u]=128},u.prototype.getEncripter=function(){},u.byte2Hex=function(n){for(var t,r="",i=0;i<n.length;i++)t=n[i],r+=t<16?"0"+t.toString(16):t.toString(16);return r.toUpperCase()},u.getKey=function(n,t){t===void 0&&(t=32);var i=new Array(t),r=this.getBytes(n);return u.copy(r.slice(0,t),i,0,t),i},u.getBytes=function(n){var t=i.encoding.UTF8.GetBytes(i.encoding.Utf8.encode(n||""));return t[t.length-1]==0&&t.pop(),t},u.prototype.ReGenerateEncPwd=function(n,t){var r=new i.crypto.AesCBC(u.getKey(n).slice()),f=r.Encrypt(u.getBytes(t));this.EncPwd=u.byte2Hex(f)},u.__fields__=function(){return[e,u.DPUsername,u.DPPwd,u.DPIdentification,u.DPClient,u.DPEncPwd]},u.prototype.getStore=function(){return u.pStore},u.prototype.OnMessage=function(n){this.OnPropertyChanged(e,n)},u.prototype.FromJson=function(n,t,u){if(typeof n=="number"){if(this.Stat>=r.sdata.DataStat.Updating)return this;this.Id=n;this.set(r.sdata.DataRow.DPStat,r.sdata.DataStat.Updating);r.Controller.ProxyData.Default.Request(this.constructor,"UPDATE",this,this)}else i.bind.DObject.prototype.FromJson.call(this,n,t,u),n!=null&&n.IsFrozen==!0&&this.Freeze();return this},u.DPUsername=i.bind.DObject.CreateField("Username",String,null),u.DPPwd=i.bind.DObject.CreateField("Pwd",String,"",function(n){return n.__this.ReGenerateEncPwd(n.__this instanceof f?vi():n._new,n._new)},undefined,i.bind.PropertyAttribute.NonSerializable|i.bind.PropertyAttribute.Private),u.DPEncPwd=i.bind.DObject.CreateField("EncPwd",String,null),u.DPIdentification=i.bind.DObject.CreateField("Identification",String,undefined),u.DPClient=i.bind.DObject.CreateField("Client",n.Client,null),u.pStore=new i.collection.Dictionary("Signup",!1),u}(r.sdata.QShopRow);n.Login=p;f=function(t){function r(n){return t.call(this,n)||this}return __extends(r,t),r.__fields__=function(){return[r.DPIsDisponible,r.DPPermission,r.DPName]},r.getById=function(n){return r.pstore.Get(n)},r.prototype.getStore=function(){return r.pstore},r.ctor=function(){this.DPIsDisponible=i.bind.DObject.CreateField("IsDisponible",Boolean,null);this.DPPermission=i.bind.DObject.CreateField("Permission",Number,0);this.DPName=i.bind.DObject.CreateField("Name",String)},r.prototype.toString=function(){var i=this,t=i&&i.Client,r=t&&t.FullName||"",u=t&&t.Tel||"";return n.AgentPermissions[this.Permission||1]+" : "+r+" / "+u},r.pstore=new i.collection.Dictionary("Agents",!0),r}(p);n.Agent=f;bt=function(n){function t(t){return n.call(this,t,f,function(n){return new f(n)})||this}return __extends(t,n),Object.defineProperty(t.prototype,"ArgType",{get:function(){return f},enumerable:!0,configurable:!0}),t.prototype.getArgType=function(){return f},t.prototype.GetType=function(){return t},t}(r.sdata.DataTable);n.Agents=bt;ui=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(p);n.Signup=ui;fi=function(n){function t(){return n.call(this,i.basic.New())||this}return __extends(t,n),t.__fields__=function(){return[]},t.prototype.getStore=function(){return t.pStore},t.prototype.GetType=function(){return t},t.pStore=new i.collection.Dictionary("Signout",!1),t}(r.sdata.QShopRow);n.Signout=fi;ei=function(n){function i(t,i){return n.call(this,t,p,function(){return new p},i)||this}return __extends(i,n),Object.defineProperty(i.prototype,"ArgType",{get:function(){return t},enumerable:!0,configurable:!0}),i.prototype.getArgType=function(){return t},i.prototype.GetType=function(){return nt},i.prototype.OnDeserialize=function(){this.Order(function(n,t){return n.Client.Id>t.Client.Id})},i}(r.sdata.DataTable);n.Logins=ei;oi=function(u){function f(){var t=u.call(this,i.basic.New())||this;return t.oacd={Owner:t,Invoke:t.OnArticlesChanged},t.articles=new g(t),t.set(f.DPAgents,new n.Agents(t)),t.set(f.DPProducts,new d(t)),t.set(f.DPFactures,new nt(t)),t.set(f.DPCostmers,new et(t)),t.set(f.DPCategories,new k(t)),t.set(f.DPFournisseurs,new ot(t)),t.set(f.DPProducts,new d(t)),n.SVersment,t.set(f.DPProjets,new st(t)),t.set(f.DPSFactures,new ht(t)),t.set(f.DPSMSs,new n.SMSs("General","all")),i.bind.NamedScop.Create("qdata",t),t}return __extends(f,u),f.prototype.getStore=function(){return f.pStore},f.__fields__=function(){return[f.DPProducts,f.DPSelectedFacture,f.DPFactures,f.DPAgents,this.DPCostmers,f.DPCategories,f.DPSFactures,f.DPFournisseurs,]},Object.defineProperty(f.prototype,"Products",{get:function(){return this.get(f.DPProducts)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Categories",{get:function(){return this.get(f.DPCategories)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Factures",{get:function(){return this.get(f.DPFactures)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"SFactures",{get:function(){return this.get(f.DPSFactures)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Costumers",{get:function(){return this.get(f.DPCostmers)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Projets",{get:function(){return this.get(f.DPProjets)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Fournisseurs",{get:function(){return this.get(f.DPFournisseurs)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Agents",{get:function(){return this.get(f.DPAgents)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"SMSs",{get:function(){return this.get(f.DPSMSs)},enumerable:!0,configurable:!0}),f.prototype.onCurrentFactureChanged=function(n){var t,i,u,r,f;if(n._old){for(t=n._old.Articles,i=0,u=t.Count;i<u;i++)r=t.Get(i),r.Product.CurrentArticle=null;this.articles.Clear();t.Unlisten=this.oacd}if(n._new){for(t=n._new.Articles,i=0,u=t.Count;i<u;i++)r=t.Get(i),f=r.Product,f&&(f.CurrentArticle=r),this.articles.Add(r);t.Listen=this.oacd}},f.prototype.OnArticlesChanged=function(n){var r,t,f,u;switch(n.event){case i.collection.CollectionEvent.Added:n.newItem.Product.CurrentArticle=n.newItem;this.articles.Insert(n.startIndex,n.newItem);break;case i.collection.CollectionEvent.Cleared:for(r=this.articles,t=0,f=r.Count;t<f;t++)u=r.Get(t),u.Product.CurrentArticle=null;this.articles.Clear();break;case i.collection.CollectionEvent.Removed:n.oldItem.Product.CurrentArticle=null;this.articles.RemoveAt(n.startIndex);break;case i.collection.CollectionEvent.Replace:n.oldItem.Product.CurrentArticle=null;n.newItem.Product.CurrentArticle=n.newItem;this.articles.Set(n.startIndex,n.newItem);break;case i.collection.CollectionEvent.Reset:for(r=this.articles,t=0,f=r.Count;t<f;t++)u=r.Get(t),u.Product.CurrentArticle=null;for(this.articles.Clear(),r=this.SelectedFacture.Articles,t=0,f=r.Count;t<f;t++)u=r.Get(t),u.Product.CurrentArticle=u,this.articles.Add(u)}},f.prototype.Clear=function(){for(var t,i=this.GetValues(),n=0;n<i.length;n++)t=i[n],t instanceof r.sdata.DataTable&&t.Clear()},f.pStore=new i.collection.Dictionary("QData",!0),f.DPProducts=i.bind.DObject.CreateField("Products",d,null),f.DPCategories=i.bind.DObject.CreateField("Categories",k),f.DPSelectedFacture=i.bind.DObject.CreateField("SelectedFacture",t,null,function(n){return n.__this.onCurrentFactureChanged(n)}),f.DPFactures=i.bind.DObject.CreateField("Factures",nt,null),f.DPSFactures=i.bind.DObject.CreateField("SFactures",ht,null),f.DPCostmers=i.bind.DObject.CreateField("Costumers",et,null),f.DPProjets=i.bind.DObject.CreateField("Projets",st,null),f.DPFournisseurs=i.bind.DObject.CreateField("Fournisseurs",ot,null),f.DPAgents=i.bind.DObject.CreateField("Agents",bt,null),f.DPSMSs=i.bind.DObject.CreateField("SMSs",n.SMSs),f}(r.sdata.QShopRow);n.QData=oi;si=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return null},t}(r.sdata.QShopRow);n.IsAdmin=si;hi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return null},t}(r.sdata.QShopRow);n.IsSecured=hi,function(n){n[n.Versment=0]="Versment";n[n.Facture=1]="Facture"}(ci=n.TransferType||(n.TransferType={}));ct=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return t._store},t.prototype.Update=function(){},t.prototype.Upload=function(){},t.__fields__=function(){return[this.DPType,this.DPDate,this.DPMontantEntree,this.DPMontantSortie,this.DPTransactionId,this.DPActualSold]},t._store=new i.collection.Dictionary("EtatTransfer"),t.DPType=i.bind.DObject.CreateField("Type",Number,ci.Facture),t.DPDate=i.bind.DObject.CreateField("Date",Date),t.DPMontantEntree=i.bind.DObject.CreateField("MontantEntree",Number,0),t.DPMontantSortie=i.bind.DObject.CreateField("MontantSortie",Number,0),t.DPTransactionId=i.bind.DObject.CreateField("TransactionId",Number,0),t.DPActualSold=i.bind.DObject.CreateField("ActualSold",Number,0),t}(r.sdata.DataRow);n.EtatTransfer=ct;li=function(n){function t(t){return n.call(this,t,ct,function(n){return new ct(n)})||this}return __extends(t,n),t.prototype.FromJson=function(t,i,r,u){return n.prototype.FromJson.call(this,t,i,r,u),this.Recalc(),this},t.prototype.Recalc=function(){this.Sold=(this.TotalSortie||0)-(this.TotalEntree||0)},t.__fields__=function(){return[this.DPTotalEntree,this.DPTotalSortie,this.DPIsVente,this.DPSold]},t.prototype.ReOrder=function(){var r,n,t,i,u;for(this.OrderBy(function(n,t){return t.Date.getTime()-n.Date.getTime()}),r=this.AsList(),n=0,t=r.length-1;t>=0;t--)i=r[t],u=(i.MontantSortie||0)-(i.MontantEntree||0),n+=u,i.ActualSold=this.IsVente?n:-n},t.DPTotalEntree=i.bind.DObject.CreateField("TotalEntree",Number,0,function(n){n.__this.Recalc()}),t.DPTotalSortie=i.bind.DObject.CreateField("TotalSortie",Number,0,function(n){n.__this.Recalc()}),t.DPSold=i.bind.DObject.CreateField("Sold",Number,0),t.DPIsVente=i.bind.DObject.CreateField("IsVente",Boolean,!0),t}(r.sdata.DataTable);n.EtatTransfers=li}(f=t.models||(t.models={})),function(n){var t=function(t){function r(n){return t.call(this,n)||this}return __extends(r,t),r.prototype.getStore=function(){return null},Object.defineProperty(r.prototype,"From",{get:function(){return this.get(r.DPFrom)},set:function(n){this.set(r.DPFrom,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"To",{get:function(){return this.get(r.DPTo)},set:function(n){this.set(r.DPTo,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Subject",{get:function(){return this.get(r.DPSubject)},set:function(n){this.set(r.DPSubject,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Body",{get:function(){return this.get(r.DPBody)},set:function(n){this.set(r.DPBody,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Readed",{get:function(){return this.get(r.DPReaded)},set:function(n){this.set(r.DPReaded,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Date",{get:function(){return this.get(r.DPDate)},set:function(n){this.set(r.DPDate,n)},enumerable:!0,configurable:!0}),r.__fields__=function(){return[this.DPFrom,this.DPTo,this.DPSubject,this.DPBody,this.DPReaded,this.DPDate]},r.ctor=function(){this.DPFrom=i.bind.DObject.CreateField("From",n.Client,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPTo=i.bind.DObject.CreateField("To",n.Client,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPSubject=i.bind.DObject.CreateField("Subject",String);this.DPBody=i.bind.DObject.CreateField("Body",String);this.DPReaded=i.bind.DObject.CreateField("Readed",Boolean,null,null,null,i.bind.PropertyAttribute.NonSerializable);this.DPDate=i.bind.DObject.CreateField("Date",String,null,null,null,i.bind.PropertyAttribute.NonSerializable)},r.New=function(){return new r(i.basic.GuidManager.Next)},r}(r.sdata.QShopRow);n.Mail=t}(f=t.models||(t.models={})),function(n){var f=function(t){function r(n){var i=t.call(this,n)||this;return window.arr?window.arr.push(i):window.arr=[i],i}return __extends(r,t),r.prototype.getStore=function(){return r.pstore},r.__fields__=function(){return[this.DPCommand,this.DPFournisseur,this.DPProduct,this.DPQte,this.DPPrice,this.DPPriceMin,this.DPPriceMax,this.DPDateSel,this.DPProductName,this.DPLabel]},r.ctor=function(){this.DPCommand=i.bind.DObject.CreateField("Command",u,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPFournisseur=i.bind.DObject.CreateField("Fournisseur",n.Fournisseur,null,null,null,i.bind.PropertyAttribute.SerializeAsId);this.DPProduct=i.bind.DObject.CreateField("Product",n.Product,null,this.prototype.ProductChanged,null,i.bind.PropertyAttribute.SerializeAsId);this.DPQte=i.bind.DObject.CreateField("Qte",Number);this.DPPrice=i.bind.DObject.CreateField("Price",Number);this.DPPriceMin=i.bind.DObject.CreateField("PriceMin",Number);this.DPPriceMax=i.bind.DObject.CreateField("PriceMax",Number);this.DPDateSel=i.bind.DObject.CreateField("DateSel",Date);this.DPProductName=i.bind.DObject.CreateField("ProductName",String,void 0,this.prototype.ProductNameChanged);this.DPLabel=i.bind.DObject.CreateField("Label",String,void 0,void 0,void 0,i.bind.PropertyAttribute.Private)},r.prototype.toString=function(){return this.Label||this.Product&&this.Product.toString()},r.prototype.isNullOrWhiteSpace=function(n){return n==null||n.trim()==""},r.prototype.ProductNameChanged=function(n){this.setProduct(this.Product,n._new)},r.prototype.ProductChanged=function(n){this.setProduct(n._new,this.ProductName)},r.prototype.setProduct=function(n,t){this.Label=this.isNullOrWhiteSpace(t)?n&&n.toString()||"":t},r.pstore=new i.collection.Dictionary("CARTICLES"),r}(r.sdata.QShopRow),t,u,e,o;n.CArticle=f;i.bind.Register({Name:"TLabel",Todo:function(n,t){var i=t._new,u=t._old,r=n.getValue("obs");r.Me=i},OnInitialize:function(n){function r(n,t){n instanceof HTMLInputElement?n.value=t||"":n.innerText=t||""}var u=n.dom.getAttribute("get-label")||"Label",f=n.dom.getAttribute("set-label")||"ProductName",t=new i.bind.Observer(n.Scop.Value,[u]);t.OnPropertyChanged(i.bind.Observer.DPValue,function(n,t){r(this.dom,t._new)},n);r(n.dom,t.Value);n.dom instanceof HTMLInputElement&&n.dom.addEventListener("change",function(){var t=n.Scop.Value;t&&(t[f]=n.dom.value)},{capture:!0});n.addValue("obs",t);this.Todo(n,{_new:n.Scop.Value})}});t=function(t){function r(i){return t.call(this,i,n.CArticle,function(n){return new f(n)})||this}return __extends(r,t),Object.defineProperty(r.prototype,"Command",{get:function(){return this.get(r.DPCommand)},set:function(n){this.set(r.DPCommand,n)},enumerable:!0,configurable:!0}),r.__fields__=function(){return[this.DPCommand]},r.ctor=function(){this.DPCommand=i.bind.DObject.CreateField("Command",u)},r.prototype.FromJson=function(n,i,r,u){return this.Clear(),t.prototype.FromJson.call(this,n,i,r,u)},r}(r.sdata.DataTable);n.CArticles=t;u=function(r){function u(n){var i=r.call(this,n)||this;return i.Articles=new t(i),i}return __extends(u,r),u.prototype.getStore=function(){return u.pstore},Object.defineProperty(u.prototype,"Articles",{get:function(){return this.get(u.DPArticles)},set:function(n){this.set(u.DPArticles,n)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Date",{get:function(){return this.get(u.DPDate)},set:function(n){this.set(u.DPDate,n)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"IsOpen",{get:function(){return this.get(u.DPIsOpen)},set:function(n){this.set(u.DPIsOpen,n)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"LockedBy",{get:function(){return this.get(u.DPLockedBy)},set:function(n){this.set(u.DPLockedBy,n)},enumerable:!0,configurable:!0}),u.__fields__=function(){return[this.DPArticles,this.DPDate,this.DPIsOpen,this.DPLockedBy]},u.ctor=function(){this.DPArticles=i.bind.DObject.CreateField("Articles",t);this.DPDate=i.bind.DObject.CreateField("Date",Date);this.DPIsOpen=i.bind.DObject.CreateField("IsOpen",Boolean);this.DPLockedBy=i.bind.DObject.CreateField("LockedBy",n.Agent)},u.pstore=new i.collection.Dictionary("Command"),u}(r.sdata.QShopRow);n.Command=u;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return[]},t.ctor=function(){},t}(r.sdata.DataTable);n.Commands=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return null},t.prototype.Update=function(){},t.prototype.Upload=function(){},t}(r.sdata.DataRow);n.Statstics=o}(f=t.models||(t.models={})),function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.ctor=function(){this.DPPrixAchat=i.bind.DObject.CreateField("PrixAchat",Number,0);this.DPPrixVent=i.bind.DObject.CreateField("PrixVent",Number,0);this.DPCount=i.bind.DObject.CreateField("Count",Number,0);this.DPLabel=i.bind.DObject.CreateField("Label",String,"")},t.__fields__=function(){return[this.DPPrixAchat,this.DPPrixVent,this.DPCount,this.DPLabel]},t.New=function(n,i,r,u){var f=new t;return f.PrixAchat=n,f.PrixVent=i,f.Count=r,f.Label=u,f},t}(i.bind.DObject),r,u,f;n.Ticket=t;r=function(r){function u(){var n=r.call(this)||this;return n.Values=new i.collection.List(t),n}return __extends(u,r),u.prototype.Clear=function(){return this.Values.Clear(),this.Response=null,this},u.ctor=function(){this.DPPrinterName=i.bind.DObject.CreateField("PrinterName",String,undefined);this.DPValues=i.bind.DObject.CreateField("Values",i.reflection.GenericType.GetType(i.collection.List,[t]),undefined)},u.__fields__=function(){return[this.DPPrinterName,this.DPValues,this.DPResponse]},u.test=function(){for(var n=new u,i=0;i<200;i++)n.Values.Add(t.New(12,23,4,"Coude 110"));return n.Values.Add(t.New(12,23,4,"PVC 50")),n.Values.Add(t.New(12,123,4,"Junker 10L")),n.Values.Add(t.New(122,23,14,"Slimane Achour")),n.PrinterName="Microsoft Print to PDF",n},u.prototype.From=function(i){var f,r,u;if(i instanceof n.SFactures){for(r=0;r<i.Count;r++)this.From(i.Get(r));return this}for(f=i.Articles,r=0;r<f.Count;r++)u=f.Get(r),this.Values.Add(t.New(u.PSel,u.Value,u.Qte,u.Product.toString()));return this},u.From=function(i,r){var r=r||new u,o,f,e;if(i instanceof n.SFactures){for(f=0;f<i.Count;f++)this.From(i.Get(f),r);return r}for(o=i.Articles,f=0;f<o.Count;f++)e=o.Get(f),r.Values.Add(t.New(e.PSel,e.Value,e.Qte,e.Product.toString()));return r},u.DPResponse=i.bind.DObject.CreateField("Response",Object,null,null,null,i.bind.PropertyAttribute.NonSerializable),u}(i.bind.DObject);n.Tickets=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return[this.DPPrinters,this.DPSelectedPrinter,this.DPPrintToFile,this.DPResponse]},t.ctor=function(){},t.DPPrinters=i.bind.DObject.CreateField("Printers",i.reflection.GenericType.GetType(i.collection.List,[String]),null,null,null,i.bind.PropertyAttribute.NonSerializable),t.DPSelectedPrinter=i.bind.DObject.CreateField("SelectedPrinter",String),t.DPPrintToFile=i.bind.DObject.CreateField("PrintToFile",Boolean),t.DPResponse=i.bind.DObject.CreateField("Response",Object,null,null,null,i.bind.PropertyAttribute.NonSerializable),t}(i.bind.DObject);n.Printer=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.DPModel=i.bind.DObject.CreateField("Model",String),t.DPData=i.bind.DObject.CreateField("Data",Object),t.DPDataId=i.bind.DObject.CreateField("DataId",Number),t.DPResponse=i.bind.DObject.CreateField("Response",Object),t.DPHandlerId=i.bind.DObject.CreateField("HandlerId",String),t}(i.bind.DObject);n.PrintService=f}(f=t.models||(t.models={})),function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"HandlerId",{get:function(){return this.get(t.DPHandlerId)},set:function(n){this.set(t.DPHandlerId,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.get(t.DPModel)},set:function(n){this.set(t.DPModel,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Data",{get:function(){return this.get(t.DPData)},set:function(n){this.set(t.DPData,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DataId",{get:function(){return this.get(t.DPDataId)},set:function(n){this.set(t.DPDataId,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Response",{get:function(){return this.get(t.DPResponse)},set:function(n){this.set(t.DPResponse,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPHandlerId,this.DPModel,this.DPData,this.DPDataId,this.DPResponse]},t.ctor=function(){this.DPHandlerId=i.bind.DObject.CreateField("HandlerId",String);this.DPModel=i.bind.DObject.CreateField("Model",String);this.DPData=i.bind.DObject.CreateField("Data",i.bind.DObject);this.DPDataId=i.bind.DObject.CreateField("DataId",Number);this.DPResponse=i.bind.DObject.CreateField("Response",Object)},t}(i.bind.DObject);n.PrintData=t}(s=t.Printing||(t.Printing={})),function(n){var t=function(n){function t(){for(var u,t=n.call(this,i.basic.New())||this,f=i.bind.DObject.getFields(t.GetType()),r=0;r<f.length;r++)u=f[r],n.prototype.set.call(t,u,i.basic.Settings.get("UserSetting."+u.Name));return t}return __extends(t,n),t.prototype.getStore=function(){return t._store},t.prototype.Update=function(){},t.prototype.Upload=function(){},t.prototype.onPropertyChanged=function(t){return i.basic.Settings.set("UserSetting."+t.prop.Name,t._new),i.Notification.fire("UserSetting."+t.prop.Name+"Changed",[this,t]),i.Notification.fire("UserSettingChanged",[this,t]),n.prototype.onPropertyChanged.call(this,t)},t._store=new i.collection.Dictionary("UserSettings"),__decorate([i.attributes.property(Boolean),__metadata("design:type",Boolean)],t.prototype,"TopNavBarVisibility",void 0),__decorate([i.attributes.property(Boolean),__metadata("design:type",Boolean)],t.prototype,"OfflineMode",void 0),__decorate([i.attributes.property(Boolean),__metadata("design:type",Boolean)],t.prototype,"AppTitleHidden",void 0),__decorate([i.attributes.property(Boolean,void 0,"show-sp-tooltips"),__metadata("design:type",Boolean)],t.prototype,"ShowSPTooltips",void 0),__decorate([i.attributes.property(Number),__metadata("design:type",Number)],t.prototype,"opened_facture",void 0),__decorate([i.attributes.property(Number),__metadata("design:type",Number)],t.prototype,"opened_sfacture",void 0),__decorate([i.attributes.property(String),__metadata("design:type",String)],t.prototype,"selectedPage",void 0),__decorate([i.attributes.property(String),__metadata("design:type",String)],t.prototype,"opened_factures",void 0),__decorate([i.attributes.property(String),__metadata("design:type",String)],t.prototype,"opened_sfactures",void 0),t}(r.sdata.DataRow);n.UserSetting=t;t.Default=new t}(f=t.models||(t.models={}));i.bind.Register(new i.bind.Job("totalarray",function(n){var t=n.Scop.Value,i=n.dom;i.innerHTML=t==null?'<span style="color:red">0.00 DZD<\/span>':o(t)+" DZD"},null,null,function(n){var t=n.Scop.Value,i=n.dom;i.innerHTML=t==null?'<span style="color:red">0.00 DZD<\/span>':o(t)+" DZD"},null));i.bind.Register(new i.bind.Job("jobi",function(n){var t=n.dom;t.textContent=(n.Scop.Value||0)+" Articles"},null,null,function(n){var t=n.dom;t.textContent=(n.Scop.Value||0)+" Articles"},null))});define("Apps/Login",["require","exports","../lib/Q/sys/Corelib","../lib/q/sys/UI","abstract/Models","abstract/extra/Common"],function(n,t,i,r,u,f){"use strict";function l(){var n=this;i.bind.Register(new i.bind.Job("openlogin",null,null,null,function(t){var i=t.dom;i.addEventListener("click",function(){return n.Open(n._loginPage)})},null));i.bind.Register(new i.bind.Job("login",null,null,null,function(t){e.user.Client||(e.user.Client=new u.models.Client(0));t.dom.addEventListener("click",function(){e.spin.Start("login");n.Login()}.bind(t))},null));i.bind.Register(new i.bind.Job("opensignup",undefined,undefined,undefined,function(t){var i=t.dom;e.user.Client||(e.user.Client=new u.models.Client(0));i.addEventListener("click",function(){n.Open(n._signupPage)})},null));i.bind.Register(new i.bind.Job("signup",function(){},null,null,function(n){n.addEventListener("click","click",function(){var t=n.Scop,i=t.Value;i.ReGenerateEncPwd("eval(code)",i.Pwd);e.requester.Post(u.models.Signup,t.Value,null,function(n,t,i){if(i)var u=r.UI.Modal.ShowDialog("Signup","The Signup was successfully created .Please Send a message with your code to activate the account")})}.bind(n))},null));i.bind.Register(new i.bind.Job("loggedjob",function(n){var t=n.Scop.Value,i=n.dom;i.innerText=t?"YOU ARE LOGGED":"YOU ARE NOT LOGGED"},null,null,function(){},null))}function h(n){i.basic.Settings.set("Identification",n.Identification);i.basic.Settings.set("LoginID",n.Id)}function a(n,t){n.Identification=i.basic.Settings.get("Identification");t&&(n.Id=i.basic.Settings.get("LoginID")||n.Id)}function v(n){e.requester.Get(u.models.Login,e.user,null,function(t,r,u){u?e.user.IsLogged?n&&n(!1):(i.basic.Settings.set("Identification",""),e.user.Identification=undefined,e.user.Username=undefined,e.user.Pwd=undefined,document.cookie="id=;",n&&n(!0)):n(null)},function(n){n.Url="/~Signout"})}function y(n,t,i,r){var f,u=new XMLHttpRequest,e=this;u.onreadystatechange=function(){if(this.readyState==4)if(this.status==200&&this.responseText=="true"){if(this.responseText=="true")return n(f,r);if(this.responseText=="false")return t(f,r);throw"Uknow stat";}else i(f,r)};u.onerror=function(){i(f,r)};f=setInterval(function(){u.open("get",__global.GetApiAddress("/~CheckLogging"));u.setRequestHeader("Access-Control-Allow-Origin","true");try{u.send();u.timeout=1e4}catch(n){}},12e3)}var o,s,e,c;Object.defineProperty(t,"__esModule",{value:!0});__global.ApiServer=new System.basics.Url(envirenment.isChromeApp?"http://127.0.0.1/":location.origin);s=new i.bind.EventListener(o=Math.random()*2099837662);f.GetVars(function(n){return e=n,!1}),function(n){var t=function(n){function t(r){var u=n.call(this,o,s)||this;return u.redirectApp=r,u.auth=i.thread.Dispatcher.cretaeJob(u.Login,[],u,!0),u.autoAuth=i.thread.Dispatcher.cretaeJob(u._AutoLogin,[],u,!0),window.auth=u,e.user.OnMessage(function(n,t){return s.Invoke(o,[t._new])}),s.On=function(n){n?t.Download():u.fullInitialize();u.OnStatStatChanged.PInvok(o,[u,n])},u}return __extends(t,n),Object.defineProperty(t.prototype,"RedirectApp",{get:function(){return this.redirectApp},set:function(){},enumerable:!0,configurable:!0}),t.prototype.IsLogged=function(n,t){n(e.user.IsLogged,t)},t.prototype.createSignupPage=function(){var n=new r.UI.Page(this,"Signup","Signup");n.OnInitialized=function(n){return n.Add(new r.UI.TControl("Client.signup",e.user))};this.AddPage(this._signupPage=n)},t.prototype.createLoginPage=function(){var n=new r.UI.Page(this,"Login","Login");n.OnInitialized=function(n){return n.Add(new r.UI.TControl("Client.login",e.user))};this.AddPage(this._loginPage=n)},t.prototype.AutoLogin=function(){var n=i.basic.Settings.get("Identification");e.user.Identification=n;i.thread.Dispatcher.Push(this.autoAuth)},t.prototype.Login=function(){var n=this,t=e.user.IsLogged;i.Api.RiseApi("Auth",{callback:function(t,i){i&&e.user.IsLogged||n.fullInitialize();n.OnStatStatChanged.PInvok(o,[n,i])},data:this})},t.prototype._AutoLogin=function(){var n=this,t=e.user.IsLogged;i.Api.RiseApi("autoAuth",{callback:function(t,i){i&&e.user.IsLogged||n.fullInitialize();n.OnStatStatChanged.PInvok(o,[n,i])},data:this})},t.Download=function(){if(i.Notification.fire("ReLoadUserSetting",[u.models.UserSetting.Default]),this.dx){e.spin.Pause();return}this.dx=!0;e.__data.Clear();i.Api.RiseApi("log",{callback:null,data:null});e.requester.Push(u.models.IsAdmin,new u.models.IsAdmin,null,function(n,t,r){e.spin.Start("Wait a moment");e.requester.Push(u.models.Categories,e.__data.Categories,null,function(){e.spin.Message="Categories";e.spin.Start("Wait a moment")});typeof __LOCALSAVE__!="undefined"?e.db.Get("Products").table.LoadTableFromDB(e.__data.Products,function(){e.apis.Product.SmartUpdate(new Date(e.db.Get("Products").info.LastUpdate||0))}):e.requester.Request(u.models.Products,"GETCSV",null,null,function(n,t,i,r){e.__data.Products.FromCsv(r.Response)});e.requester.Push(u.models.Costumers,e.__data.Costumers,null,function(){e.spin.Message="Costumers"});r&&e.requester.Push(u.models.Agents,e.__data.Agents,null,function(){e.spin.Message="Agents"});e.requester.Push(u.models.IsAdmin,new u.models.IsAdmin,null,function(){e.spin.Pause();i.Api.RiseApi("log",{callback:null,data:null})})})},t.prototype.initialize=function(){var n=this;e.requester.Request(u.models.IsSecured,"GET",undefined,undefined,function(t,i){__global.https=i;n.AutoLogin()})},t.prototype.fullInitialize=function(){this.finit||(this.IsInit?this._initialize():this.OnInitialized=function(n){return n._initialize()})},t.prototype._initialize=function(){n.prototype.initialize.call(this);this.finit=!0;this.createLoginPage();this.createSignupPage();l.call(this);this.SelectedPage=this._loginPage},t.prototype.Signout=function(){},t.prototype.Logout=function(){v(function(n){n})},t.prototype.OnAttached=function(){if(!this.isf)return this.isf=!0;this.fullInitialize()},t.prototype.OnDetached=function(){},t}(r.UI.AuthApp);n.AuthentificationApp=t}(c=t.Apps||(t.Apps={}));i.Api.RegisterApiCallback({Name:"ReAuth",DoApiCallback:function(n,t,f){e.spin.Start("Authenticating");e.user.Stat=0;e.requester.Push(u.models.Login,e.user,null,function(n,t,u){if(e.spin.Pause(),u){var o=n.data;if(o.IsLogged){i.basic.Settings.set("Identification",o.Identification);f.callback&&f.callback(f,!0);return}r.UI.InfoArea.push('<p class="text-center">Please Check Your <B>Password<\/B> AND <B>UserName<\/B><\/p>',!1,4e3)}else r.UI.InfoArea.push("There no connection to server",!1);this.OnInitialized=function(n){return n.fullInitialize()};f.callback&&f.callback(f,!1)})},Owner:this});i.Api.RegisterApiCallback({Name:"Auth",DoApiCallback:function(n,t,i){function f(n,t,u){if(e.spin.Pause(),u){var f=n.data;if(f.IsLogged){h(f);i.callback&&i.callback(i,!0);return}r.UI.InfoArea.push('<p class="text-center">Please Check Your <B>Password<\/B> AND <B>UserName<\/B><\/p>',!1,4e3)}else r.UI.InfoArea.push("Error de connecter a server",!1);i.callback&&i.callback(i,!1)}e.user.Stat=0;e.requester.Push(u.models.Login,e.user,null,f)},Owner:this});i.Api.RegisterApiCallback({Name:"autoAuth",DoApiCallback:function(n,t,f){function o(n,t,u){if(e.spin.Pause(),u){var o=n.data;if(o.IsLogged){i.basic.Settings.set("Identification",o.Identification);f.callback&&f.callback(f,!0);return}r.UI.InfoArea.push('<p class="text-center">Please Check Your <B>Password<\/B> AND <B>UserName<\/B><\/p>',!1,4e3)}else r.UI.InfoArea.push("Error de connecter a server",!1);f.callback&&f.callback(f,!1)}e.user.Stat=0;e.requester.Costume({Method:0,Url:"~checklogging"},undefined,undefined,function(n,t){if(t===!0){e.spin.Pause();e.user.FromJson({CheckLogging:!0},i.encoding.SerializationContext.GlobalContext,!0);return}a(e.user,!0);e.requester.Request(u.models.Login,"AutoLogin",e.user,e.user,function(n,t,i){if(i){var r=n.data;if(r.IsLogged){e.spin.Pause();h(r);f.callback&&f.callback(f,!0);return}}e.requester.Push(u.models.Login,e.user,null,o)})},undefined)},Owner:this});y(function(){},function(){r.UI.Desktop.Current.OpenSignin()},function(){r.UI.Desktop.Current.OpenSignin()},this)});define("Apps/Calculator/Calc",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.theNum="",t.oldNum="",t}return __extends(t,n),t.prototype.initialize=function(){},t.prototype.OnCompileEnd=function(t){n.prototype.OnCompileEnd.call(this,t);var i=r.query.$$(this._view),u=i.find(r.query.hasClass,"ops").toArray().sort(function(n,t){return Number(n.textContent)-parseInt(t.textContent)}),f=i.find(r.query.hasClass,"num")},t}(i.UI.TControl);t.Calculator=u});define("abstract/QShopApis",["require","exports","../lib/q/sys/Corelib","../lib/q/sys/System","abstract/Models","../lib/q/sys/QModel"],function(n,t,i,r,u,f){"use strict";function o(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return i.join("&")}var y;Object.defineProperty(t,"__esModule",{value:!0});var s=u.models.Clients,e=u.models.Products,h=u.models.Factures,c=u.models.Articles,p=u.models.Clients,l=u.models.Agents,w=u.models.Versments,a=u.models.Categories,v=u.models.Pictures;(function(n){function hr(){new k;new st;new at;new vt;new ti;new ri;new hi;new ci;new li;new ai;new vi;new yi;new ki;new w;new di;new gi;new nt;new ot;new dt;new wt;new bi;new ut;new si;new w;new yt;new nr;new rr;new ii;new pi;new wi;new ht;new ct;new ft;new lt;new it;new gt;new tr;new ir;new et;new ur;new tt;new ni;new pt;new g;new kt;new rt;new ei;new oi;new ui;new fi;new b;new d;new bt;new fr}var t=function(n){function t(t,r,u,f){var e=n.call(this,!0)||this;return e._root=t,e.skipParseResponse=u,r||t.indexOf("/_/")!==0&&(e._root="/_/"+t),f||(e.ERegister(i.net.WebRequestMethod.Get,"GET","Id=@Id",!1),e.ERegister(i.net.WebRequestMethod.Get,"CREATE","Id=@Id",!1),e.ERegister(i.net.WebRequestMethod.Delete,"DELETE","Id=@Id",!1),e.ERegister(i.net.WebRequestMethod.Post,"SAVE",undefined,!0),e.ERegister(i.net.WebRequestMethod.Get,"UPDATE","Id=@Id",!1),e.ERegister(i.net.WebRequestMethod.Post,"VALIDATE","Id=@Id",!0),e.ERegister(i.net.WebRequestMethod.Set,"SetProperty","Id=@Id",!0),e.ERegister(i.net.WebRequestMethod.Create,"CREATE",undefined,!0)),e}return __extends(t,n),Object.defineProperty(t.prototype,"Url",{get:function(){return __global.GetApiAddress(this._root)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ParseResponse",{get:function(){return!this.skipParseResponse},enumerable:!0,configurable:!0}),t.getId=function(n){return n instanceof r.sdata.DataRow?n.Id.toString():typeof n=="number"?n:n.hasOwnProperty("Id")?n.Id:0},t.prototype.addQuestionMark=function(){return!0},t.prototype.GetRequest=function(n,t,r){var u=this.GetMethodShema(t),f;return u&&u.ParamsFormat?f=u.ParamsFormat.apply(r||{}):r&&(f=o(r)),new i.net.RequestUrl(f?this.Url+(this.addQuestionMark()?"?":"")+f:this.Url,null,null,u?u.Method:0,u.SendData)},t.prototype.OnResponse=function(n,t,i){return this.ParseResponse?t&&t.FromJson&&t.FromJson(n,i,!0):t},t}(r.Controller.Api),y,p,b,k,d,g,nt,tt,er,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,or,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,w,di,gi,nr,tr,ir,rr,ur,sr,fr;n.DataRow=t;y=function(n){function t(t,r){var u=n.call(this,!0)||this;return u._root=t,r||t.indexOf("/_/")!==0&&(u._root="/_/"+t),u.ERegister(i.net.WebRequestMethod.Get,"UPDATE","Id=@Id",!1),u.ERegister(i.net.WebRequestMethod.SUPDATE,"SUPDATE","Date=@Date",!1),u.ERegister(i.net.WebRequestMethod.Get,"GETCSV","csv=true",!1),u}return __extends(t,n),Object.defineProperty(t.prototype,"Url",{get:function(){return __global.GetApiAddress(this._root)},enumerable:!0,configurable:!0}),t.prototype.GetRequest=function(n,t,r){var u=this.GetMethodShema(t),f;return u&&u.ParamsFormat?f=u.ParamsFormat.apply(r||{}):r&&(f=o(r)),new i.net.RequestUrl(f?this.Url+"?"+f:this.Url,null,null,u?u.Method:0,u&&u.SendData)},t.prototype.OnResponse=function(n,t,i){var u=Date.now();if(n!=null){t&&(t.Stat=r.sdata.DataStat.Updating,t.FromJson(n,i),t.Stat=r.sdata.DataStat.Updated);return}},t}(r.Controller.Api);n.DataTable=y;p=function(n){function t(t,r){var u=n.call(this,t,r)||this;return u.ERegister(i.net.WebRequestMethod.Get,"OPEN","Id=@Id&Operation=Open",!1),u.ERegister(i.net.WebRequestMethod.Get,"BENIFIT","Id=@Id&Operation=Benifit",!1),u.ERegister(i.net.WebRequestMethod.Close,"CLOSE","Id=@Id&Operation=Close&Force=@Force",!1),u.ERegister(i.net.WebRequestMethod.Get,"ISOPEN","Id=@Id&Operation=IsOpen",!1),u.ERegister(i.net.WebRequestMethod.Open,"OPEN","Id=@Id",!1),u.ERegister(i.net.WebRequestMethod.Print,"PRINT","Id=@Id",!1),u.ERegister(i.net.WebRequestMethod.Close,"FORCECLOSE","Id=@Id&Force=true",!1),u.ERegister(i.net.WebRequestMethod.Post,"SetProperty","Set=@Property&Id=@Id&value=@Value",!1),u.ERegister(i.net.WebRequestMethod.Post,"SetInfo","SetInfo&Id=@Id",!0),u}return __extends(t,n),t}(t);n.FactureBase=p;b=function(n){function t(){return n.call(this,"usersetting")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.UserSetting},t}(t);n.UserSetting=b;k=function(n){function t(){return n.call(this,"Client")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Client},t}(t);n.Client=k;d=function(n){function t(){return n.call(this,"SMS")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.SMS},t}(t);n.SMS=d;g=function(n){function t(){return n.call(this,"Projet")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Projet},t}(t);n.Projet=g;nt=function(n){function t(){var t=n.call(this,"/~login",!0)||this;return t.ERegister(i.net.WebRequestMethod.Get,"AutoLogin","Identification=@Identification&Id=@Id",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Login},t.prototype.GetRequest=function(t,r,u){return r=="AutoLogin"?n.prototype.GetRequest.call(this,t,r,u):new i.net.RequestUrl(this.Url,null,null,i.net.WebRequestMethod.Post)},t}(t);n.Login=nt;tt=function(n){function t(){var t=n.call(this,"Login",!1)||this;return t.ERegister(i.net.WebRequestMethod.Post,"VALIDATE","validate&Id=@Id",!1),t.ERegister(i.net.WebRequestMethod.Post,"LOCK","lock&Id=@Id",!1),t.ERegister(i.net.WebRequestMethod.Post,"REMOVE","remove&Id=@Id",!1),t}return __extends(t,n),t.prototype.GetType=function(){return Number},t}(t);n.LoginO=tt;er=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Login},t}(t);n.OLogin=er;it=function(n){function t(){return n.call(this,"/~IsAdmin",!0)||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.IsAdmin},t.prototype.GetRequest=function(){return new i.net.RequestUrl(this.Url,null,null,i.net.WebRequestMethod.Get)},t}(t);n.IsAdmin=it;rt=function(n){function t(){return n.call(this,"/~IsSecured",!0)||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.IsSecured},t.prototype.GetRequest=function(){return new i.net.RequestUrl(this.Url,null,null,i.net.WebRequestMethod.Get)},t}(t);n.IsSecured=rt;ut=function(n){function t(){return n.call(this,"/~Signup",!0)||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Signup},t.prototype.GetRequest=function(){return new i.net.RequestUrl(this.Url,null,null,i.net.WebRequestMethod.Post)},t}(t);n.Signup=ut;ft=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.GetType=function(){return i.basic.iGuid},t.prototype.GetRequest=function(){return new i.net.RequestUrl(__global.GetApiAddress("/~Guid"),null,null,i.net.WebRequestMethod.Get)},t.prototype.OnResponse=function(n,t){return t},t}(r.Controller.Api);n.Guid=ft;et=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.GetType=function(){return i.basic.SessionId},t.prototype.GetRequest=function(){return new i.net.RequestUrl(__global.GetApiAddress("/~SessionId"),null,null,i.net.WebRequestMethod.Get)},t.prototype.OnResponse=function(n){return i.basic.SessionId.parse(n),n},t}(r.Controller.Api);n.SessionId=et;ot=function(n){function t(){return n.call(this,"/Signout",!0)||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Signout},t.prototype.GetRequest=function(){return new i.net.RequestUrl(this.Url,null,null,i.net.WebRequestMethod.Post)},t}(t);n.Signout=ot;st=function(n){function t(){var t=n.call(this,"Users")||this;return n.call(this,"Users")||this}return __extends(t,n),t.prototype.GetType=function(){return s},t}(y);n.Users=st;ht=function(n){function t(){return n.call(this,"Fournisseur")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Fournisseur},t}(t);n.Fournisseur=ht;ct=function(n){function t(){return n.call(this,"Fournisseurs")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Fournisseurs},t}(y);n.Fournisseurs=ct;lt=function(n){function t(){return n.call(this,"CallBack")||this}return __extends(t,n),t.prototype.GetType=function(){return f.models.Message},t.prototype.GetRequest=function(n){return new i.net.RequestUrl(__global.GetApiAddress("/_/CallBack?Id="+n.Id),null,null,i.net.WebRequestMethod.Post)},t.prototype.OnResponse=function(n,t,i){if(t==null||!t.privateDecompress)return t&&t.FromJson(n,i,!0)},t}(t);n.Message=lt;at=function(n){function t(){var t=n.call(this,"Product")||this;return t.ERegister(i.net.WebRequestMethod.Post,"AVATAR","Operation=@Operation&Name=@Name&Size=@Size&PID=@PID",!0),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Product},t}(t);n.Product=at;vt=function(n){function t(){var t=n.call(this,"Products")||this;return t.ERegister(i.net.WebRequestMethod.Print,"PRINT","",!0),t}return __extends(t,n),t.prototype.GetType=function(){return e},t}(y);n.Products=vt;yt=function(n){function t(){return n.call(this,"Prices")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.FakePrices},t}(y);n.FakePrices=yt;pt=function(n){function t(){var t=n.call(this,"Mails")||this;return t.ERegister(i.net.WebRequestMethod.Get,"UNREADED","from=@From&to=@To&unReader=true",!1),t.ERegister(i.net.WebRequestMethod.Get,"READED","from=@From&to=@To&unReader=false",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Mails},t}(y);n.Mails=pt;or=function(n){function t(){return n.call(this,"Products")||this}return __extends(t,n),t.prototype.GetType=function(){return e},t}(y);n.ProductsUpdater=or;wt=function(n){function t(){return n.call(this,"Clients")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Clients},t}(y);n.Clients=wt;bt=function(n){function t(){var t=n.call(this,"SMSs")||this;return t.ERegister(i.net.WebRequestMethod.Get,"UPDATE","@param",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.SMSs},t}(y);n.SMSs=bt;kt=function(n){function t(){return n.call(this,"Projets")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Projets},t}(y);n.Projets=kt;dt=function(n){function t(){return n.call(this,"FakePrice")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.FakePrice},t}(t);n.FakePrice=dt;gt=function(n){function t(){return n.call(this,"Price")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Price},t}(t);n.Price=gt;ni=function(n){function t(){return n.call(this,"Mail")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Mail},t}(t);n.Mail=ni;ti=function(n){function t(){var t=n.call(this,"Facture")||this;return t.ERegister(i.net.WebRequestMethod.Create,"CREATE","CId=@CId&Type=@Type&Abonment=@Abonment&TType=@Transaction",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Facture},t}(p);n.Facture=ti;ii=function(n){function t(){var t=n.call(this,"SFacture")||this;return t.ERegister(i.net.WebRequestMethod.Create,"CREATE","FId=@FId&AId=@AId&Type=@Type&TType=@Transaction",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.SFacture},t}(p);n.SFacture=ii;ri=function(n){function t(){var t=n.call(this,"Factures")||this;return t.ERegister(i.net.WebRequestMethod.Set,"FREEZED","Freezed=@Freezed",!0),t.ERegister(i.net.WebRequestMethod.Get,"LOADFREEZED","Freezed=true&csv=@csv",!0),t}return __extends(t,n),t.prototype.GetType=function(){return h},t}(y);n.Factures=ri;ui=function(n){function t(){var t=n.call(this,"Command")||this;return t.ERegister(i.net.WebRequestMethod.Create,"CREATE","date=@Date",!1),t.ERegister(i.net.WebRequestMethod.Get,"OPEN","operation=OPEN&Id=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"CLOSE","operation=CLOSE&Id=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"GETARTICLES","operation=GETARTICLES&Id=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"UPDATEDC","",!1),t.ERegister(i.net.WebRequestMethod.Print,"PRINT","",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Command},t}(t);n.Command=ui;fi=function(n){function t(){return n.call(this,"Commands")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Commands},t}(y);n.Commands=fi;ei=function(n){function t(){return n.call(this,"CArticle")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.CArticle},t}(t);n.CArticle=ei;oi=function(n){function t(){var t=n.call(this,"CArticles")||this;return t.ERegister(i.net.WebRequestMethod.Get,"UPDATEDC","",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.CArticles},t}(y);n.CArticles=oi;si=function(n){function t(){return n.call(this,"Users")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Logins},t}(y);n.Logins=si;hi=function(n){function t(){return n.call(this,"Article")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Article},t}(t);n.Article=hi;ci=function(n){function t(){return n.call(this,"Articles")||this}return __extends(t,n),t.prototype.GetType=function(){return c},t}(y);n.Articles=ci;li=function(n){function t(){return n.call(this,"Agent")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Agent},t}(t);n.Agent=li;ai=function(n){function t(){return n.call(this,"Agents")||this}return __extends(t,n),t.prototype.GetType=function(){return l},t}(y);n.Agents=ai;vi=function(n){function t(){return n.call(this,"Versment")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Versment},t}(t);n.Versment=vi;yi=function(n){function t(){var t=n.call(this,"Versments")||this;return t.ERegister(i.net.WebRequestMethod.Get,"VFacture","q=Facture&Facture=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VClient","q=Client&Client=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VPeriod","q=Period&From=@From&to=@To",!1),t.ERegister(i.net.WebRequestMethod.Get,"VCassier","q=Cassier&Cassier=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VObservation","q=Observation&Observation=@Observation",!1),t.ERegister(i.net.WebRequestMethod.Get,"Facture.Total","q=Facture&Facture=@Id&total",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Versments},t}(y);n.Versments=yi;pi=function(n){function t(){return n.call(this,"SVersment")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.SVersment},t}(t);n.SVersment=pi;wi=function(n){function t(){var t=n.call(this,"SVersments")||this;return t.ERegister(i.net.WebRequestMethod.Get,"VFacture","q=Facture&Facture=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VFournisseur","q=Fournisseur&Fournisseur=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VPeriod","q=Period&From=@from&to=@to",!1),t.ERegister(i.net.WebRequestMethod.Get,"VCassier","q=Cassier&Cassier=@Id",!1),t.ERegister(i.net.WebRequestMethod.Get,"VObservation","q=Observation&Observation=@Observation",!1),t.ERegister(i.net.WebRequestMethod.Get,"Facture.Total","q=Facture&Facture=@Id&total",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.SVersments},t}(y);n.SVersments=wi;bi=function(n){function t(){return n.call(this,"Costumers")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Costumers},t}(y);n.Costumers=bi;ki=function(n){function t(){return n.call(this,"Category")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Category},t}(t);n.Category=ki;w=function(n){function t(){return n.call(this,"Categories")||this}return __extends(t,n),t.prototype.GetType=function(){return a},t}(y);n.Categories=w;di=function(n){function t(){return n.call(this,"Picture")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.Picture},t}(t);n.Picture=di;gi=function(n){function t(){return n.call(this,"Pictures")||this}return __extends(t,n),t.prototype.GetType=function(){return v},t}(y);n.Pictures=gi;nr=function(n){function t(){return n.call(this,"SFactures")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.SFactures},t}(y);n.SFactures=nr;tr=function(n){function t(){return n.call(this,"EtatTransfers")||this}return __extends(t,n),t.prototype.GetType=function(){return u.models.EtatTransfers},t}(y);n.EtatTransfers=tr;ir=function(n){function t(){var t=n.call(this,"Settings")||this;return t.ERegister(i.net.WebRequestMethod.Get,"START",null,!1),t.ERegister(i.net.WebRequestMethod.Post,"BACKUP",null,!1),t.ERegister(i.net.WebRequestMethod.Put,"RESTORE",null,!1),t}return __extends(t,n),t.prototype.GetType=function(){return Window},t}(t);n.Settings=ir;rr=function(n){function t(){var t=n.call(this,"Tickets")||this;return t.ERegister(i.net.WebRequestMethod.Print,"PRINT",null,!0),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Tickets},t}(t);n.Tickets=rr;ur=function(n){function t(){var t=n.call(this,"Print")||this;return t.ERegister(i.net.WebRequestMethod.Get,"MODELS","HandlerId=@HandlerId",!1),t.ERegister(i.net.WebRequestMethod.Print,"PRINT",null,!0),t}return __extends(t,n),t.prototype.GetType=function(){return u.Printing.PrintData},t}(t);n.Print=ur;sr=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.GetType=function(){return 0},t.prototype.GetRequest=function(){return t.req.Url=__global.GetApiAddress("/~NewGuid"),t.req},t.prototype.OnResponse=function(n,t){return new i.basic.iGuid(t)},t.req=new i.net.RequestUrl("/~NewGuid",null,null,i.net.WebRequestMethod.Get,!1),t}(r.Controller.Api);n.UUID=sr;fr=function(n){function t(){var t=n.call(this,"statistics",!1,!0,!0)||this;return t.ERegister(i.net.WebRequestMethod.Get,"out","/@method?from=@from&to=@to&pid=@pid&cid=@cid",!1),t.ERegister(i.net.WebRequestMethod.Get,"methods","?methods",!1),t.ERegister(i.net.WebRequestMethod.Get,"params","?method=@method",!1),t}return __extends(t,n),t.prototype.GetType=function(){return u.models.Statstics},t.prototype.addQuestionMark=function(){return!1},t}(t);n.Statistics=fr;n.Load=hr})(y=t.Apis||(t.Apis={}))});define("Desktop/Jobs",["require","exports","../lib/q/sys/Corelib","../lib/q/sys/System","../lib/q/sys/Jobs","abstract/Models","context","abstract/extra/Common","abstract/Models","./../lib/Q/sys/UI","abstract/extra/Basics"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function tt(n,t){return l.requester.Post(f.models.FakePrice,n,null,function(i,r,u){if(u){if(h.UI.InfoArea.push("The Category Successfully Added",!0),t){f.models.FakePrice.pStore.Set(n.Id,n);var e=f.models.FakePrice.getById(n.Id);e==null&&(e=new f.models.FakePrice(n.Id),f.models.FakePrice.pStore.Set(n.Id,e))}n.Commit();return}h.UI.InfoArea.push("AN Expected Error !!!!!<br>while Inserting The Category",!1,8e3);n.Rollback()}),!0}function it(){return h.UI.InfoArea.push("The Modification Aborded",!1,2500),!1}function ft(){}function rt(n,t){t=t==null?"":t;t instanceof s.models.Picture&&(t=t.ImageUrl);n.style.backgroundImage=t==null||t==""?d:'url("'+t+'")'}var l,ut,w,nt,v,b,p,et,a,y,k,d,g;Object.defineProperty(t,"__esModule",{value:!0});o.GetVars(function(n){return l=n,!1});window.__data=l.__data;ut=!0;w=[10,10,10,10,7.5,6,5.1,4.4,3.9,3.4,3.1,2.8,2.6,2.6,2.4,2.3];window.lc=w,function(n){function e(){var r,t=this.self,n=r=t.parentElement,i;n&&(n=n.nextElementSibling,n)&&(i=n.style.display,i=="none"?(n.style.display="",t.classList.remove("glyphicon-triangle-top"),t.classList.add("glyphicon-triangle-bottom")):(n.style.display="none",t.classList.add("glyphicon-triangle-top"),t.classList.remove("glyphicon-triangle-bottom")))}function t(n,t){var i;typeof n!="boolean"?(i=n.getAttribute("activate"),n.setAttribute("activate",i=!(i&&i.Value))):i=n;t.style.backgroundColor=i?"":"var(--qshop-grey-500)"}i.bind.Register({Name:"trade",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var i=n.Scop.Value,r=n.dom,u,t;i!=null?(u=i%1!=0,t=i.toString(),t.length>10&&(t=t.slice(0,10))):t="";r.style.fontSize=w[t.length]+"em";r.textContent=t}});i.bind.Register({Name:"getLastArticleTransactioned",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var r=n.Scop.ParentValue,u=n.Scop.Value,t,f;r&&u&&(t=r instanceof s.models.Article?r.Owner:r.Facture,f=t instanceof s.models.Facture?t.Client:t instanceof s.models.SFacture?t.Fournisseur:undefined,i.Api.RiseApi("getLastArticlePrice",{data:{Dealer:f,Product:u,Before:t.Date,IsAchat:r instanceof s.models.Article},callback:function(t,i){n.dom.innerHTML=i==undefined?"n y a aucune transaction ":"derniere prix : "+i}}))}});i.bind.Register({Name:"openprice",OnInitialize:function(n){n.addEventListener("click","click",function(){var r=n.Scop.Value,t,u;r&&(t=r&&r.Revage,u=!1,t||(t=new f.models.FakePrice(i.basic.New()),t.Product=r,r.Revage=t,u=!0),t?o.funcs.priceModal().edit(t,u,{OnSuccess:{Invoke:tt,Owner:t},OnError:{Invoke:it,Owner:t}}):(u=!0,h.UI.Spinner.Default.Start("Wait"),t=new f.models.FakePrice(t.Id),t.Product=r,l.requester.Get(f.models.FakePrice,t,null,function(n,t,i){i?o.funcs.priceModal().edit(n.data,u,{OnSuccess:{Invoke:tt,Owner:r},OnError:{Invoke:it,Owner:r}}):h.UI.InfoArea.push("Fatal ERROR Occured !!!! ");h.UI.Spinner.Default.Pause()})),r.Revage==null&&(r.Revage=t))})}});i.bind.Register({Name:"openfprice",OnInitialize:function(n){n.addEventListener("click","click",function(){var t=n.Scop.Value;t&&(t.NextRevage?o.funcs.pricesModal().show(function(){},t.ToList()):o.funcs.priceModal().edit(t,!1,null))})}});i.bind.Register({Name:"applyprice",OnInitialize:function(n){var t=n.dom.getAttribute("method");n.addEventListener("click","click",function(){var i=n.Scop.Value,u=i.Facture,r;if(u&&!u.IsOpen)return h.UI.Modal.ShowDialog("Apprentissage","La Facture Is Clossed donc vous ne pouver pas executer cette command",null,"Ok",null);if(r=i.Product,r==null)return h.UI.Modal.ShowDialog("Apprentissage","Vous dever selectioner un produit pour appliquer le prix");switch(t){case"moyen":i.ApplyPrice=s.models.Price.CalclMoyen(r,i);break;case"new":i.ApplyPrice=i;break;case"old":i.ApplyPrice=null;break;case"costum":return i.ApplyPrice=new s.models.FakePrice,i.ClonePrices(i.ApplyPrice,!0),l.apis.Revage.Edit(i.ApplyPrice,void 0);case"percent":h.UI.InfoArea.push("this option is depricated")}})}});i.bind.Register({Name:"openfprice",OnInitialize:function(n){n.addEventListener("click","click",function(){var t=n.Scop.Value;t&&(t.NextRevage?o.funcs.pricesModal().show(function(){},t.ToList()):o.funcs.priceModal().edit(t,!1,null))})}});i.bind.Register({Name:"openfsprice",OnInitialize:function(n){n.addEventListener("click","click",function(){var i=n.Scop.Value,t;if(i){if(t=i.Revage,!t)return h.UI.InfoArea.push("Cannot find Price for this item");t.NextRevage?o.funcs.pricesModal().show(function(){},t.ToList()):l.apis.Revage.Edit(t,void 0)}})}});i.bind.Register({Name:"dopenfprice",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",function(){var t=n.Scop.Value;t?l.apis.Revage.Edit(t,void 0):h.UI.InfoArea.push("Cannot find Price for this item")})}});i.bind.Register({Name:"dopenfsprice",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",function(){var t=n.Scop.Value;t&&o.funcs.pricesModal().show(function(){},t&&t.ToList())})}});i.bind.Register({Name:"dopenfsprice",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",function(){var t=n.Scop.Value;t&&o.funcs.pricesModal().show(function(){},t&&t.ToList())})}});i.bind.Register({Name:"factureStat",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.dom;t.style.backgroundColor=n.Scop.Value?"#0F9D58":"var(--qshop-yellow-700)"}});i.bind.Register({Name:"applyPriceStat",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var i=n.Scop.getParent(),r,t;i=i&&i.Value;r=n.Scop.Value;t=n.dom.parentElement;r?r===i?(t.classList.remove("btn-primary"),t.classList.add("btn-success")):(t.classList.add("btn-primary"),t.classList.remove("btn-success")):t.classList.remove("btn-success","btn-primary")}});i.bind.Register({Name:"smsState",OnInitialize:function(n){this.Todo(n,{_new:!!n.Scop.Value})},Todo:function(n,t){var r=t._new,i=n.dom.parentElement;r?i.classList.remove("sms-no-readed"):i.classList.add("sms-no-readed")}});i.ScopicCommand.Register({Invoke:function(n,t){var i=u.getTargetFrom(t);t.addEventListener("click",function(){i.checked=!i.checked})},Owner:null},null,"checkboxTrigger");i.bind.Register({Name:"sfactureStat",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.dom;t.style.backgroundColor=n.Scop.Value?"#0F9D58":"var(--qshop-yellow-700)"}});i.bind.Register({Name:"clientStat",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.Scop.Value||0;n.dom.parentElement.style.backgroundColor=t==0?"#0F9D58":t>0?"var(--paper-red-500)":"var(--qshop-yellow-500)"}});i.bind.Register({Name:"soldStatus",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.Scop.Value||0,i=n.dom.style;n.dom.innerText=String(t);i.backgroundColor=t==0?"":t>0?"var(--paper-red-500)":"var(--qshop-yellow-500)"}});i.bind.Register({Name:"fournisseurStat",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.Scop.Value||0;n.dom.parentElement.style.backgroundColor=t==0?"#0F9D58":t<0?"var(--paper-red-500)":"var(--qshop-yellow-500)"}});i.bind.Register({Name:"auto-product",OnInitialize:function(n,t){function a(n,t,i){var f=this.Scop.getParent(),u,e;f&&(u=f.Value,u instanceof s.models.FakePrice?(e=u.Facture,u.Stat<=r.sdata.DataStat.Modified&&(u.PSel=i.PSel,u.Value=i.Value,u.PValue=i.PValue,u.HWValue=i.HWValue,u.WValue=i.WValue)):u&&u.setProduct(i));this.Scop.Value=i}var e=n.dom,o=new h.UI.Input(e),u=new h.UI.ProxyAutoCompleteBox(o,l.__data.Products),c=e.getAttribute("item-template"),f;c!=null&&(u.Template=h.UI.Template.ToTemplate(c,!0));o.Parent=h.UI.Desktop.Current;u.OnValueChanged(n,function(t,r,u){f.IsChanging||(f.IsChanging=!0,i.helper.TryCatch(n,a,void 0,[t,r,u]),f.IsChanging=!1)});u.initialize();f={ac:u,IsChanging:!1};n.Scop.BindingMode=i.bind.BindingMode.TwoWay;n.addValue("ac",f);n.Control||(n.Control=u);this.Todo(n,t)},Todo:function(n){var t=n.getValue("ac");t.IsChanging||(t.IsChanging=!0,t.ac.Value=n.Scop.Value,t.IsChanging=!1)}});i.bind.Register({Name:"autocomplet",OnInitialize:function(n){var r=n.dom,s=r.getAttribute("db-source"),c=r.hasAttribute("bind-to-scop"),u=i.bind.Scop.Create(s,n.Scop,1),e=new h.UI.Input(r),o,t,f;if(u)o=u.Value,t=new h.UI.ProxyAutoCompleteBox(e,o),f=r.getAttribute("item-template"),f!=null&&(t.Template=h.UI.Template.ToTemplate(f,!0)),u.OnPropertyChanged(i.bind.Scop.DPValue,function(n,t){this.DataSource=t._new},t),c&&(t.OnValueChanged(n,function(t,i,r){n.Scop.Value=r}),t.Value=n.Scop.Value,n.addValue("ac",t),n.addValue("bts",!0)),e.Parent=h.UI.Desktop.Current,t.initialize(),n.Control||(n.Control=t);else throw"datasource not found";},Todo:function(n){if(n.getValue("bts")){var t=n.getValue("ac");t.Value=n.Scop.Value}}});i.ScopicCommand.Register({Invoke:function(n,t){t.addEventListener("click",{handleEvent:e,self:t})}},null,"collapse");i.ScopicCommand.Register({Invoke:function(n,t){t.addEventListener("click",function(){var i=t.classList.contains("open"),n;i?t.classList.remove("open"):(t.classList.add("open"),n=function(){t.classList.remove("open");document.removeEventListener("click",n,!0)},document.addEventListener("click",n,!0))},!0);var t=t.parentElement}},null,"opendropdown");i.ScopicCommand.Register({Invoke:function(n,t,i){t.innerText=i.Value}},null,"write");i.ScopicCommand.Register({Invoke:function(n,i,r){r=r.getParent();i.addEventListener("click",function(){t(r,i)});t(!1,i)}},null,"activateCrt");i.bind.Register({Name:"auto-category",OnInitialize:function(n,t){var u=n.dom,r=new h.UI.Input(u),i=new h.UI.ProxyAutoCompleteBox(r,l.__data.Categories);r.Parent=h.UI.Desktop.Current;i.OnValueChanged(n,function(t,i,r){n.Scop.Value.Category=r});i.initialize();n.addValue("ac",i);this.Todo(n,t)},Todo:function(n){var i=n.getValue("ac"),t=n.Scop.Value;i.Value=t?t.Category:null},OnScopDisposing:function(n){var t=n.getValue("ac");t.Box.Dispose();t.Dispose()}});i.bind.NamedScop.Create("UserAbonment",f.models.Abonment.Detaillant,3).OnPropertyChanged(i.bind.Scop.DPValue,function(n,t){var r=typeof t._new=="number";r&&b.setAbonment(t._new);t._new instanceof i.basic.EnumValue&&b.setAbonment(t._new.Value)},null);i.bind.Register({Name:"enumoption",OnInitialize:function(n,t){var f,r,o;if(!(n.dom instanceof HTMLInputElement))throw"Dom must be Select";var e=n.dom,s=e.getAttribute("enum"),u=e.getAttribute("enum-type");u!=="string"&&(u="number");f=i.basic.getEnum(s);r=new h.UI.ProxyAutoCompleteBox(new h.UI.Input(n.dom),f);r.Box.Parent=h.UI.Desktop.Current;r.initialize();o={ac:r,lst:f,et:u};n.addValue("params",o);this.Todo(n,t);r.OnValueChanged(r,function(t,i,r){return n.Scop.Value=u==="string"?r?r.Name:f.Get(0):r?r.Value:0})},Todo:function(n){var t=n.getValue("params"),r=n.Scop.Value;t.ac.Value=t.et==="number"?i.basic.EnumValue.GetValue(t.lst,r||0):r}});i.bind.Register({Name:"enum",OnInitialize:function(n,t){var h,r,s,u,f,e,o;if(!(n.dom instanceof HTMLSelectElement))throw"Dom must be Select";for(h=n.Scop,r=n.dom,r.contentEditable="true",s=r.getAttribute("enum")||r.getAttribute("type")||r.getAttribute("rtype"),u=i.basic.getEnum(s),f=0;f<u.Count;f++)e=document.createElement("option"),o=u.Get(f),e.value=String(o.Value),e.text=o.Name,n.dom.appendChild(e);n.addValue("list",u);this.Todo(n,t);n.dom.addEventListener("change",function(){if(!n._store.inter){n._store.inter=!0;try{var t=this.options[this.selectedIndex];t=parseFloat(t&&t.value);n.Scop.Value=isFinite(t)?t:null}catch(i){}n._store.inter=!1}})},Todo:function(n){if(!n._store.inter){n._store.inter=!0;try{var r=n.getValue("list"),t=i.basic.EnumValue.GetValue(r,n.Scop.Value);t=t&&r.IndexOf(t);n.dom.selectedIndex=t}catch(u){}n._store.inter=!1}}});i.bind.Register({Name:"enumstring",OnInitialize:function(n,t){var r=n.dom,u=r.getAttribute("type"),f=i.basic.getEnum(u);n.addValue("params",f);this.Todo(n,t)},Todo:function(n){var i=n.getValue("params"),t=n.Scop.Value;n.dom.textContent=typeof t=="string"?t:i.Get(t||0).Name}});i.bind.Register({Name:"enum2string",OnInitialize:function(n,t){var r=n.dom,u=r.getAttribute("type"),f=i.basic.getEnum(u);n.addValue("params",f);this.Todo(n,t)},Todo:function(n){var i=n.getValue("params"),t=n.Scop.Value;n.dom.textContent=typeof t=="string"?t:i.Get(t||0).Name}});i.bind.Register({Name:"adapter",OnInitialize:function(n){var i=n.dom,r=i.getAttribute("item-template"),t=new h.UI.ListAdapter(i,r);t.Parent=h.UI.Desktop.Current;t.OnInitialized=function(t){return t.Source=n.Scop.Value};n.addValue("cnt",t);n.Control=t},Todo:function(n){var t=n.getValue("cnt");t.Source=n.Scop.Value},OnScopDisposing:function(n){var t=n.getValue("cnt");t.Dispose()}});n.LabelJob=i.bind.Register({Name:"hideIfNull",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var r=n.dom,i=r.parentElement,t=i.style.display,u=n.Scop.Value;if(u==null){if(t=="none")return;n.addValue("display",t);i.style.display="none"}else i.style.display=t=="none"?n.getValue("display"):t}});n.LabelJob=i.bind.Register(new i.bind.Job("prodprice",function(n){var t=n.Scop.Value,r;t=t?t.IGetValue(p||0)||0:0;r=n.dom;r.innerText=i.math.round(t,2)+" DZD"},null,null,function(n,t){this.Todo(n,t);var i;v.push(i={ji:n,job:this});n.addValue("c",i)},function(n){var t=v.indexOf(n.getValue("c"));t>-1&&v.splice(t,1)}));i.bind.Register({Name:"deleteItem",OnInitialize:function(n){n.dom.addEventListener("click",function(){var t=n.Scop,r;if(t instanceof i.bind.Bind&&t.Parent&&(r=t.Parent.Value,r instanceof i.collection.List)){r.Remove(t.Value);return}alert("remove")})}});i.ScopicCommand.Register({Invoke:function(n,t){var i=u.getTargetFrom(t);i!=null&&t.addEventListener("click",{handleEvent:function(){var n=i.classList.contains("in");n?i.classList.remove("in"):i.classList.add("in")}})}},null,"accordion");i.ScopicCommand.Register({Invoke:function(n,t){var r=t.getAttribute("as"),u;if(!r)return h.UI.InfoArea.push("command <template> required : as attribute ");if(u=i.mvc.MvcDescriptor.Get(r),!r)return h.UI.InfoArea.push("the template "+r+"Cannot be found");t.appendChild(u.Create())}},null,"template");i.ScopicCommand.Register({Invoke:function(n,t,r){var u=t.getAttribute("db-data");t.addEventListener("click",function(){var f,v,o,e,a,t,n;switch(u){case"costume":for(n=r.Value,f=n.ApplyPrice===n||n.ApplyPrice==null?new s.models.FakePrice(i.basic.New()):n.ApplyPrice,t=3;t>=0;t--)f.ISetValue(t,n.GetPrice(t));f.PSel=n.PSel;f.Product=n.Product;f.Qte=n.Product.Qte;n.ApplyPrice=f;break;case"current":if(v=r.Value,v instanceof s.models.Product)return;if(e=r.Value,o=e.Product,!o)return h.UI.InfoArea.push("The product of this revage is not setted",!1);for(t=3;t>=0;t--)e.ISetValue(t,o.GetPrice(t));break;case"calc":for(e=r.Value,a=e.PSel,t=3;t>=0;t--)e.ISetValue(t,a=parseFloat(i.math.round(a*1.33,2)));break;case"default":n=r.Value;n.ApplyPrice=n;break;case"update":n=r.Value;l.apis.Revage.Save(n.ApplyPrice,function(t){t.Error===c.basics.DataStat.Success?(n.ApplyPrice=null,h.UI.InfoArea.push("The Product Price successfully Updated .",!0)):h.UI.InfoArea.push("Error Occoured When Updating <h1>Product<\/h1> Price .",!1)});break;case"restore":n=r.Value;n.ApplyPrice=null}},!1)}},null,"prdPrice")}(nt||(nt={}));v=[],function(n){function e(n){var i,u,o,r,f,e;for(p=n||0,i=0,u=t;i<u.length;i++)o=u[i],o.Fraction=n;for(r=0,f=v;r<f.length;r++)e=f[r],e.job.Todo(e.ji,null)}var t=[],r=function(n){function r(t,i){var r=n.call(this,t,i)||this;return r.fraction=-2,r}return __extends(r,n),r.prototype.Initialize=function(){n.prototype.Initialize.call(this)},Object.defineProperty(r.prototype,"Fraction",{set:function(n){var t,i,r;if(this.fraction!==n){if(t=this.source.Value,t){if(i=f.models.FakePrice.GetDProperty(n),!i)return;r=f.models.FakePrice.GetDProperty(this.fraction);this.dbe&&t.removeEvent(r,this.dbe);this.dbe=t.OnPropertyChanged(i,this.OntargetVC,this)}this.fraction=n;this.Update()}},enumerable:!0,configurable:!0}),r.prototype.Convert=function(n){return n?n.IGetValue(this.fraction||0):0},r.prototype.ConvertBack=function(n){var t=this.source.Value;return t&&t.ISetValue(this.fraction||0,n),t},r.prototype.OntargetVC=function(){this.isChanging||(this.isChanging=!0,this.Update(),this.isChanging=!1)},r.prototype.SourceChanged=function(t,i){n.prototype.SourceChanged.call(this,t,i);var r=i._new,u=i._old,e=f.models.FakePrice.GetDProperty(this.fraction);if(this.dbe)if(u)u.removeEvent(e,this.dbe),this.dbe=null;else throw"";r&&(this.dbe=r.OnPropertyChanged(e,this.OntargetVC,this))},r.prototype.Dispose=function(){var u=f.models.FakePrice.GetDProperty(this.fraction),r;this.dbe&&this.source.Value.removeEvent(u,this.dbe);this.source&&this.source.removeEvent(i.bind.Scop.DPValue,this.dbsvc);r=t.indexOf(this);r!==-1&&t.splice(r,1);n.prototype.Dispose.call(this)},r}(i.bind.Filter),u;n.FakePriceFilter=r;i.bind.RegisterFilter({BindingMode:3,Name:"fackeprice",CreateNew:function(n,i,u){var e=new r(n,i);return e.Fraction=u==null?p:isNaN(u)?f.models.Abonment[u]:parseFloat(u),t.push(e),e}});window._=t;window.__=v;n.setAbonment=e;l.user.OnMessage(function(t,r){if(r._new){var f=i.bind.NamedScop.Get("User");u=i.bind.Scop.Create("Client.Abonment",f,i.bind.BindingMode.SourceToTarget);u.addListener(function(t){n.setAbonment(t._new)})}})}(b=t.Filters||(t.Filters={}));p=l.user.Client.Abonment||0;t.LoadJobs=ft;et=/\0([\=\*\-\+\:\/]){0,1}([\-]{0,1}[\d]+(\.[\d]+){0,1})([\%]{0,1})\0/gmi;a={pa:NaN,pv:NaN,reduction:NaN};y=i.bind.Register({Name:"reduction",_OnArtOrPrdChanged:function(n){var t=n.getValue("parent"),i;t=t&&t.Value;i=t&&t.Reduction;n.dom instanceof HTMLInputElement?n.dom.value=isNaN(i)?"":String(i):n.dom.textContent=String(i)},_OnValueTextChanged:function(n){var i=n.dom,t=n.getValue("parent");if(t=t&&t.Value,t){t.setReduction(i.value)?i.classList.remove("error"):i.classList.add("error");return}},Todo:function(n,t){this.lock(n,this,this._OnArtOrPrdChanged,[n,t,!0])},OnInitialize:function(n,t){var i=n.dom,r=n.Scop.getParent();i.addEventListener("change",function(t){y.lock(n,y,y._OnValueTextChanged,[n,t])});n.addValue("parent",r);this.lock(n,y,y._OnArtOrPrdChanged,[n,t])},lock:function(n,t,r,u){if(!n._store.lock){n._store.lock=!0;var f=i.helper.TryCatch(t,r,null,u);return n._store.lock=!1,f}}},!0);k=function(){function n(){this.Name="productcart"}return n.prototype.Todo=function(n,t){var i=n._store,r=t._new,u=t._new.Picture;i.img.style.backgroundImage=u==null?"":"url("+u+")";i.description.textContent=r.Description;i.name.textContent=r.Name;i.price.textContent=r.Revage==null?"0":r.Revage.Value+""},n.prototype.Check=function(){},n.prototype.OnError=function(){},n.prototype.OnScopDisposing=function(){},n.prototype.OnInitialize=function(n,t){var i=n.dom;n._store.img=$("img",i);n._store.name=$("name",i);n._store.description=$("description",i);n._store.price=$("price",i);this.Todo(n,t)},n}();t.ProductCartJob=k;d='url("'+e.context.GetPath("../assets/img/2.png")+'")';i.bind.Register(new k);i.bind.Register({Name:"SelectImage",getTarget:function(n){var t=n.getValue("target");return t?t:(t=u.getTargetFrom(n.dom),n.addValue("target",t),t)},OnInitialize:function(n,t){var r=this,i=n.dom,u;if(!(i instanceof HTMLInputElement))return console.log("dom must be a HtmlInput Element");u=this.getTarget(n);i.type="file";i.multiple=!1;i.accept="image/*";n.addEventListener("change","change",function(){var u=r.getTarget(n),t;u&&i.files&&i.files[0]&&(t=new FileReader,t.onload=function(n){return u.setAttribute("src",n.target.result)},t.readAsDataURL(i.files[0]))});this.Todo(n,t)},Todo:function(n){var i=this.getTarget(n),t=n.Scop.Value;i.src=t==null||t==""?"":"/_/Picture/"+t}});g=function(n){function t(t){var i=n.call(this,"Picture.edit",!1)||this;return i.Adapter=t,i._btn=null,i._img=null,i.scop.Value=i,window.tt=i,i}return __extends(t,n),t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Canceltitle("Close")},Object.defineProperty(t.prototype,"Data",{set:function(){},enumerable:!0,configurable:!0}),t.prototype.Update=function(){var n=t.getValue(this,["Adapter","SelectedItem","Picture"]);this._img.src=n==null||n==""?"":"/_/Picture/"+n},t.getValue=function(n,t){for(var i=0;i<t.length;i++){if(n==null)return undefined;n=n[t[i]]}return n},t.prototype.setName=function(n,t){n==="_img"?this[n]=t:n==="_btn"&&(this[n]=t)},t.prototype.OnImageSubmit=function(){this.Files=this._btn.files},t.prototype.OnKeyDown=function(t){var i;if(t.keyCode===h.UI.Keys.F5&&this.Update(),t.ctrlKey)if(t.keyCode==h.UI.Keys.Down)this.Adapter.SelectedIndex++;else if(t.keyCode==h.UI.Keys.Up)this.Adapter.SelectedIndex--;else if(t.keyCode==h.UI.Keys.Left)i=this.Adapter.Parent.Parent,i instanceof h.UI.Paginator&&i.Previous();else if(t.keyCode==h.UI.Keys.Right)i=this.Adapter.Parent.Parent,i instanceof h.UI.Paginator&&i.Next();else if(t.keyCode==115||t.keyCode==83)this.onSave&&this.onSave(this);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return!0},t.__fields__=function(){return[this.DPFiles,this.DPAdapter]},t.prototype.Open=function(t){this.Files=null;this._btn&&(this._btn.value="");n.prototype.Open.call(this);this.onSave=t},t.prototype.Upload=function(n,t){var r=this.Files&&this.Files[0],u;if(!r)return h.UI.InfoArea.push("Please Select a picture for upload");u=new FileReader;u.onload=function(u){l.requester.Request(s.models.Product,"AVATAR",u.target.result,{Operation:"AVATAR",Name:r.name,Size:r.size,PID:n.Id},function(r,u,f){f&&(n.Picture=u);t&&t({Api:void 0,Data:u,Error:f?i.basic.DataStat.Success:i.basic.DataStat.Fail})})};u.readAsArrayBuffer(this.Files[0])},t.DPAdapter=i.bind.DObject.CreateField("Adapter",h.UI.ListAdapter),t.DPFiles=i.bind.DObject.CreateField("Files",FileList,null),t}(h.UI.Modals.EModalEditer);t.PictureEditor=g;window.pictue=g;i.bind.Register({Name:"image",OnInitialize:function(n,t){this.Todo(n,t)},Todo:function(n){var t=n.Scop.Value,i;t=t==null?"":t;i=n.dom;t instanceof s.models.Picture&&(t=t.ImageUrl);i.style.backgroundImage=t==null||t==""?d:'url("/_/Picture/'+t+'")'}});i.ScopicCommand.Register({Invoke:function(n,t,r){r&&(rt(t,r.Value),r.OnPropertyChanged(i.bind.Scop.DPValue,function(n,i){rt(t,i._new)}))}},null,"image")});define("abstract/adminModels",["require","exports","../lib/Q/sys/Corelib","../lib/Q/sys/System","abstract/Models"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f;(function(n){var f=function(n){function t(){var t=n.call(this)||this;return t.Date=new r.base.DateVecteur,t.DateLivraison=new r.base.DateVecteur,t.Total=new r.base.NumberVecteur,t.Sold=new r.base.NumberVecteur,Object.freeze(t),t}return __extends(t,n),t.__fields__=function(){return[t.DPClient,t.DPVendeur,t.DPDate,t.DPDateLivraison,t.DPTotal,t.DPSold,t.DPIsValidated]},Object.defineProperty(t.prototype,"Client",{get:function(){return this.get(t.DPClient)},set:function(n){this.set(t.DPClient,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Vendeur",{get:function(){return this.get(t.DPVendeur)},set:function(n){this.set(t.DPVendeur,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Date",{get:function(){return this.get(t.DPDate)},set:function(n){this.set(t.DPDate,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DateLivraison",{get:function(){return this.get(t.DPDateLivraison)},set:function(n){this.set(t.DPDateLivraison,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Total",{get:function(){return this.get(t.DPTotal)},set:function(n){this.set(t.DPTotal,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Sold",{get:function(){return this.get(t.DPSold)},set:function(n){this.set(t.DPSold,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsValidated",{get:function(){return this.get(t.DPIsValidated)},set:function(n){this.set(t.DPIsValidated,n)},enumerable:!0,configurable:!0}),t.prototype.Check=function(n){return this.Client&&this.Client!=n.Client?!1:this.Vendeur&&this.Vendeur!=n.Vendeur?!1:this.IsValidated!=null&&this.IsValidated!=n.IsValidated?!1:this.Date.Check(n.Date)?this.DateLivraison.Check(n.DateLivraison)?this.Total.Check(n.Total)?!0:!1:!1:!1},t.prototype.equals=function(n){return n.Client===this.Client&&n.Date===this.Date&&n.DateLivraison===this.DateLivraison&&this.IsValidated===n.IsValidated&&n.Sold===this.Sold&&n.Total===this.Total&&n.Vendeur===this.Vendeur},t.prototype.ToInterface=function(){return{Client:this.Client,Date:this.Date,DateLivraison:this.DateLivraison,IsValidated:this.IsValidated,Sold:this.Sold,Total:this.Total,Vendeur:this.Vendeur,Check:this.Check,equals:this.equals}},t.DPClient=i.bind.DObject.CreateField("Client",u.models.Client),t.DPVendeur=i.bind.DObject.CreateField("Vendeur",u.models.Agent),t.DPDate=i.bind.DObject.CreateField("Date",r.base.DateVecteur),t.DPDateLivraison=i.bind.DObject.CreateField("DateLivraison",r.base.DateVecteur),t.DPTotal=i.bind.DObject.CreateField("Total",r.base.NumberVecteur),t.DPSold=i.bind.DObject.CreateField("Sold",r.base.NumberVecteur),t.DPIsValidated=i.bind.DObject.CreateField("IsValidated",Boolean),t}(i.bind.DObject),t;n.FactureSearch=f;t=function(n){function t(t){var i=n.call(this)||this;return i.fs=t,i}return __extends(t,n),t.prototype.convertFromString=function(){throw"invalide";},t.prototype.Begin=function(){this.ifs=this.Patent},t.prototype.IsMatch=function(n,t){return!this.ifs||this.ifs.Check(t)},t}(i.utils.Filter);n.FSFilter=t})(f=t.ikmodels||(t.ikmodels={})),function(n){var f=function(n){function t(){var t=n.call(this)||this;return t.Date=new r.base.DateVecteur,t.Total=new r.base.NumberVecteur,t.Sold=new r.base.NumberVecteur,Object.freeze(t),t}return __extends(t,n),t.__fields__=function(){return[t.DPFournisseur,t.DPAchteur,t.DPValidateur,t.DPDate,t.DPTotal,t.DPSold,t.DPIsValidated]},Object.defineProperty(t.prototype,"Fournisseur",{get:function(){return this.get(t.DPFournisseur)},set:function(n){this.set(t.DPFournisseur,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Achteur",{get:function(){return this.get(t.DPAchteur)},set:function(n){this.set(t.DPAchteur,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Validateur",{get:function(){return this.get(t.DPValidateur)},set:function(n){this.set(t.DPValidateur,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Date",{get:function(){return this.get(t.DPDate)},set:function(n){this.set(t.DPDate,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Total",{get:function(){return this.get(t.DPTotal)},set:function(n){this.set(t.DPTotal,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Sold",{get:function(){return this.get(t.DPSold)},set:function(n){this.set(t.DPSold,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsValidated",{get:function(){return this.get(t.DPIsValidated)},set:function(n){this.set(t.DPIsValidated,n)},enumerable:!0,configurable:!0}),t.prototype.Check=function(n){return this.Fournisseur&&this.Fournisseur!=n.Fournisseur?!1:this.Achteur&&this.Achteur!=n.Achteur?!1:this.Validateur&&this.Validateur!=n.Validator?!1:this.IsValidated!=null&&this.IsValidated!=n.IsValidated?!1:this.Date.Check(n.Date)?this.Total.Check(n.Total)?!0:!1:!1},t.prototype.equals=function(n){return n.Fournisseur===this.Fournisseur&&n.Date===this.Date&&n.Achteur===this.Achteur&&this.IsValidated===n.IsValidated&&n.Sold===this.Sold&&n.Total===this.Total&&n.Validateur===this.Validateur},t.prototype.ToInterface=function(){return{Fournisseur:this.Fournisseur,Date:this.Date,Achteur:this.Achteur,IsValidated:this.IsValidated,Sold:this.Sold,Total:this.Total,Validateur:this.Validateur,Check:this.Check,equals:this.equals}},t.DPFournisseur=i.bind.DObject.CreateField("Fournisseur",u.models.Fournisseur),t.DPAchteur=i.bind.DObject.CreateField("Achteur",u.models.Agent),t.DPValidateur=i.bind.DObject.CreateField("Vendeur",u.models.Agent),t.DPDate=i.bind.DObject.CreateField("Date",r.base.DateVecteur),t.DPTotal=i.bind.DObject.CreateField("Total",r.base.NumberVecteur),t.DPSold=i.bind.DObject.CreateField("Sold",r.base.NumberVecteur),t.DPIsValidated=i.bind.DObject.CreateField("IsValidated",Boolean),t}(i.bind.DObject),t;n.SFactureSearch=f;t=function(n){function t(t){var i=n.call(this)||this;return i.fs=t,i}return __extends(t,n),t.prototype.convertFromString=function(){throw"invalide";},t.prototype.Begin=function(){this.ifs=this.Patent},t.prototype.IsMatch=function(n,t){return!this.ifs||this.ifs.Check(t)},t}(i.utils.Filter);n.SFSFilter=t}(f=t.ikmodels||(t.ikmodels={}))});define("Desktop/Search",["require","exports","abstract/Models","../lib/Q/sys/Critere"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u;(function(n){var v=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Client)},t}(r.Critere.ComplexCritere),u,f,e,o,s,h,t,c,l,a;n.Client=v;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Login)},t}(r.Critere.ComplexCritere);n.Login=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Category)},t}(r.Critere.ComplexCritere);n.Category=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Client)},t}(r.Critere.ComplexCritere);n.Fournisseur=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Versment)},t}(r.Critere.ComplexCritere);n.Versment=o;s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.Facture)},t}(r.Critere.ComplexCritere);n.Facture=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.SFacture)},t}(r.Critere.ComplexCritere);n.SFacture=h;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return t.generateFieldsFrom(i.models.Product)},t}(r.Critere.ComplexCritere);n.Product=t;c=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return this.generateFieldsFrom(i.models.SMS)},t}(r.Critere.ComplexCritere);n.SMS=c;l=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.__fields__=function(){return t.generateFieldsFrom(i.models.SVersment)},r}(r.Critere.ComplexCritere);n.SVersment=l;a=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.__fields__=function(){return t.generateFieldsFrom(i.models.EtatTransfer)},t}(r.Critere.ComplexCritere);n.Etats=a})(u=t.SearchData||(t.SearchData={}))});define("Desktop/Admin/ListOfFactures",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib","abstract/Models","abstract/extra/Common","abstract/adminModels","../../lib/Q/sys/Filters","abstract/extra/Basics","Desktop/Search","../../lib/q/components/HeavyTable/script","../../lib/Q/components/ActionButton/script","assets/data/data","../../lib/q/sys/Components"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y,w,b,p;Object.defineProperty(t,"__esModule",{value:!0});w=!0;f.GetVars(function(n){return y=n,!1}),function(n){var f=function(n){function t(){var t=n.call(this,"facture_fournisseurs","Journal des achats")||this;return t.actionBtn=new l.components.ActionButton,t.group_tcnt=(new i.UI.Div).applyStyle("icontent-header"),t._caption=document.createTextNode("Les Factures "),t.searchFilter=new o.filters.list.StringFilter,t.frnFilter=new o.filters.list.PropertyFilter(u.models.SFacture.DPFournisseur),t.searchRequest=new e.ikmodels.SFactureSearch,t.service=new p(t),t.OnInitialized=function(){r.Api.RiseApi("loadFournisseurs",{callback:function(){r.Api.RiseApi("loadSFActures",void 0)},data:t})},t}return __extends(t,n),t.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.verser(t==="Regler")},t.prototype.OpenVersments=function(n){this.adapter.SelectedItem?y.apis.SVersment.OpenSVersmentsOfFacture(this.adapter.SelectedItem,function(t,r,u,f){f&&n&&(r?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&y.apis.SVersment.Delete(r,function(n){n.Error===s.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.verser=function(n){var t=this.adapter.SelectedItem;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une Facture pour ajouter une versment");if(n)return y.apis.SVersment.Regler(t,t.Client);y.apis.SVersment.VerserTo(t,t.Client)},t.prototype.OnSearche=function(n,t){this.searchList.Filter!=this.searchFilter&&(this.searchList.Filter=this.searchFilter);this.searchFilter.Patent=new o.filters.list.StringPatent(t)},t.prototype.OnFrnSearch=function(n){this.frnFilter.DP=u.models.SFacture.DPFournisseur;this.frnFilter.Patent=new o.filters.list.PropertyPatent(n);this.searchList.Filter!=this.frnFilter&&(this.searchList.Filter=this.frnFilter)},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.CalculateBenifite=function(){var n=this.adapter.SelectedItem;y.requester.Request(u.models.SFacture,"BENIFIT",n,{Id:n.Id},function(n,t){i.UI.InfoArea.push("<h3 >Benefit est :<\/h3><h1>"+t.Benifit+'DA  <\/h1><br><h3 >Precentage est :<\/h3><h1 style="color:yellow">'+t.Benifit/t.Total*100+"%  <\/h1>")})},t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F3:"Deep Searche",F5:"Update",F9:"Settle Debts",F10:"Versments",Suppr:"Delete",Enter:"Edit"});else if(t.keyCode==66||t.keyCode==98)this.CalculateBenifite();else if(t.keyCode===i.UI.Keys.F2)this.New();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.Open();else if(t.keyCode===i.UI.Keys.F9)this.verser(!0);else if(t.keyCode===i.UI.Keys.F10)this.OpenVersments(!1);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.initializeSBox=function(){var n=this;this.group_tcnt.View.appendChild(this._caption);this.group_tcnt.Add(this.actionBtn);this.Add(this.group_tcnt);this.actionBtn.Source=y.__data.Fournisseurs;this.actionBtn.OnInitialized=function(n){return n.Box.View.setAttribute("handleClose","")};this.actionBtn.Caption.addEventListener("click",function(){return n.OnFrnSearch(n.actionBtn.Value)},null,this)},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.initializeSBox();this.initPaginator()},t.prototype.initPaginator=function(){this&&(this.adapter=new c.Material.HeavyTable(a.data.value.factureAchatTable.def),this.adapter.setOrderHandler({Invoke:this.OrderBy,Owner:this}));this.adapter.AcceptNullValue=!1;this.Add(this.paginator=i.UI.Paginator.createPaginator(this.adapter,this.searchList=y.__data.SFactures.Filtred(this.searchFilter)))},t.prototype.OrderBy=function(n){switch(n.orderBy){case"Ref":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Ref||"").localeCompare(i.Ref||"")});case"Fournisseur":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Fournisseur&&t.Fournisseur.Name||"").localeCompare(i.Fournisseur&&i.Fournisseur.Name||"")});case"Date":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Date&&t.Date.getTime()||0)-(i.Date&&i.Date.getTime()||0)});case"NArticles":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.NArticles-i.NArticles)});case"Montant":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Total-i.Total)});case"Stat":return this.searchList.OrderBy(function(t,i){return n.state.factor*((t.IsOpen&&-1)-(i.IsOpen&&-1))});case"Observation":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Observation||"").localeCompare(i.Observation||"")})}},t.prototype.Search=function(){for(var r,t=y.__data.Costumers.AsList(),n=0,i=t.length;n<i;n++)r=t[n]},t.prototype.GetLeftBar=function(){return this.service.GetLeftBar(this)},t.prototype.GetRightBar=function(){return this.service.GetRightBar(this)},t.prototype.Print=function(){r.Api.RiseApi("PrintSFacture",{data:this.adapter.SelectedItem})},t.prototype.Open=function(){r.Api.RiseApi("OpenSFacture",{data:this.adapter.SelectedItem})},t.prototype.New=function(){r.Api.RiseApi("NewSFacture",{data:null,callback:function(n,t){y.apis.SFacture.EOpenFacture(t)}})},t.prototype.FsSave=function(){r.Api.RiseApi("SaveSFacture",{data:this.adapter.SelectedItem})},t.prototype.Update=function(){y.apis.SFacture.SmartUpdate()},t.prototype.FsUpdate=function(){r.Api.RiseApi("UpdateSFacture",{data:this.adapter.SelectedItem})},t.prototype.Validate=function(){r.Api.RiseApi("ValidateSFacture",{data:this.adapter.SelectedItem})},t.prototype.Delete=function(){r.Api.RiseApi("DeleteSFacture",{data:this.adapter.SelectedItem})},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new h.SearchData.SFacture);this._deepSearch.Open(function(){return n.OnDeepSearchTrigged()})},t.prototype.OnDeepSearchTrigged=function(){this.searchList.Filter!=this._deepSearch?this.searchList.Filter=this._deepSearch:this.searchList.Reset()},t.prototype.getFrnName=function(n){return n&&(n=n.Fournisseur)&&n.FullName||""},t}(i.UI.NavPanel),t,w;n.FacturesReciption=f;t=function(n){function t(){var t=n.call(this,"facture_clientels","Journal des Ventes")||this;return t.actionBtn=new l.components.ActionButton,t.group_tcnt=(new i.UI.Div).applyStyle("icontent-header"),t._caption=document.createTextNode("Les Factures "),t.searchFilter=new o.filters.list.StringFilter,t.clientFilter=new o.filters.list.PropertyFilter(u.models.SFacture.DPFournisseur),t.service=new p(t),t.rt=[{type:"icongroup",value:[{iconName:"attach_money",commandName:"benifice"},{iconName:"card_giftcard",commandName:"versements"},{iconName:"update",commandName:"update"},{iconName:"print",commandName:"print"},{iconName:"import_export",commandName:"switch"}]},{type:"separator"},{type:"menu-item",commandName:"freeze",label:"Freeze",iconName:"visibility_off"},{type:"menu-item",commandName:"unfreeze",label:"UnFreeze",iconName:"visibility"},{type:"menu-item",commandName:"loadfreezed",label:"Load Freezed Factures",iconName:"system_update"}],t._contextMenu=new v.Components.MdContextMenu(t.rt),t._freezedFactures=new u.models.Factures(null),t._freezedFacturesloaded=!1,t.OnInitialized=function(){return r.Api.RiseApi("loadFActures",void 0)},t}return __extends(t,n),t.prototype.CalculateBenifite=function(){var n=this.adapter.SelectedItem;y.requester.Request(u.models.Facture,"BENIFIT",n,{Id:n.Id},function(n,t){i.UI.InfoArea.push("<h3 >Benefit est :<\/h3><h1>"+t.Benifit+'DA  <\/h1><br><h3 >Precentage est :<\/h3><h1 style="color:yellow">'+t.Benifit/t.Total*100+"%  <\/h1>")})},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new h.SearchData.Facture);this._deepSearch.Open(function(){return n.OnDeepSearchTrigged()})},t.prototype.OnSearche=function(n,t){this.searchList.Filter!=this.searchFilter&&(this.searchList.Filter=this.searchFilter);this.searchFilter.Patent=new o.filters.list.StringPatent(t)},t.prototype.OnClientSearch=function(n){this.clientFilter.DP=u.models.Facture.DPClient;this.clientFilter.Patent=new o.filters.list.PropertyPatent(n);this.searchList.Filter!=this.clientFilter&&(this.searchList.Filter=this.clientFilter)},t.prototype.OnDeepSearchTrigged=function(){this.searchList.Filter!=this._deepSearch?this.searchList.Filter=this._deepSearch:this.searchList.Reset()},t.prototype.Update=function(){this.searchList.Source=y.__data.Factures;y.apis.Facture.SmartUpdate()},t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F3:"Deep Searche",F5:"Update",F9:"Settle Debts",F10:"Versments",Suppr:"Delete",Enter:"Edit"});else if(t.keyCode==66||t.keyCode==98)this.CalculateBenifite();else if(t.keyCode===i.UI.Keys.F2)this.New();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.Open();else if(t.keyCode===i.UI.Keys.F9)this.verser(!0);else if(t.keyCode===i.UI.Keys.F10)this.OpenVersments(!1);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.initialize=function(){var t=this,i;n.prototype.initialize.call(this);this.group_tcnt.View.appendChild(this._caption);this.group_tcnt.Add(this.actionBtn);this.Add(this.group_tcnt);this.initPaginator();i=!1;this.adapter.AcceptNullValue=!1;this.actionBtn.Source=y.__data.Costumers;this.actionBtn.Box.View.setAttribute("handleClose","");this.actionBtn.Caption.addEventListener("click",function(){t.OnClientSearch(t.actionBtn.Value)},this)},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Validated},enumerable:!0,configurable:!0}),t.prototype.initPaginator=function(){var n=this;this.paginator=new i.UI.Paginator(10,undefined,!0);this.paginator.OnInitialized=function(){n&&(n.adapter=new c.Material.HeavyTable(a.data.value.factureVenteTable.def),n.adapter.setOrderHandler({Invoke:n.OrderBy,Owner:n}));n.adapter.OnInitialized=function(t){n.paginator.Input=n.searchList=y.__data.Factures.Filtred(n.searchFilter);t.Source=n.paginator.Output};n.paginator.Content=n.adapter};this.Add(this.paginator);this.applyStyle("fitHeight")},t.prototype.OrderBy=function(n){switch(n.orderBy){case"Ref":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Ref||"").localeCompare(i.Ref||"")});case"Client":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Client&&t.Client.Name||"").localeCompare(i.Client&&i.Client.Name||"")});case"Date":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Date&&t.Date.getTime()||0)-(i.Date&&i.Date.getTime()||0)});case"NArticles":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.NArticles-i.NArticles)});case"Montant":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Total-i.Total)});case"Stat":return this.searchList.OrderBy(function(t,i){return n.state.factor*((t.IsOpen&&-1)-(i.IsOpen&&-1))});case"Observation":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Observation||"").localeCompare(i.Observation||"")})}},t.prototype.GetLeftBar=function(){return this.service.GetLeftBar(this)},t.prototype.GetRightBar=function(){return this.service.GetRightBar(this)},t.prototype.Print=function(){r.Api.RiseApi("PrintFacture",{data:this.adapter.SelectedItem})},t.prototype.Open=function(){r.Api.RiseApi("OpenFacture",{data:this.adapter.SelectedItem})},t.prototype.New=function(){r.Api.RiseApi("NewFacture",{data:null,callback:function(){}})},t.prototype.FsSave=function(){r.Api.RiseApi("SaveFacture",{data:this.adapter.SelectedItem})},t.prototype.FsUpdate=function(){r.Api.RiseApi("UpdateFacture",{data:this.adapter.SelectedItem})},t.prototype.Validate=function(){r.Api.RiseApi("ValidateFacture",{data:this.adapter.SelectedItem})},t.prototype.Delete=function(){r.Api.RiseApi("DeleteFacture",{data:this.adapter.SelectedItem})},t.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.verser(t==="Regler")},t.prototype.OpenVersments=function(n){this.adapter.SelectedItem?y.apis.Versment.OpenVersmentsOfFacture(this.adapter.SelectedItem,function(t,r,u,f){f&&n&&(r?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&y.apis.Versment.Delete(r,function(n){n.Error===s.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.verser=function(n){var t=this.adapter.SelectedItem;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une Facture pour ajouter une versment");if(n)return y.apis.Versment.Regler(t,t.Client);y.apis.Versment.VerserTo(t,t.Client)},t.prototype.OnContextMenu=function(n){var t=this;i.UI.Desktop.Current.CurrentApp.OpenContextMenu(this._contextMenu,{callback:function(n){switch(n.selectedItem.commandName){case"freeze":t.FreezeFactures(!0);break;case"unfreeze":t.FreezeFactures(!1);break;case"loadfreezed":t.LoadFreeedFactures();break;case"update":t.Update();break;case"benifice":t.CalculateBenifite();return;case"versements":t.OpenVersments(!1);return;case"print":t.Print();return;case"switch":var i=t._freezedFactures;t.searchList.Source=i=t.searchList.Source===i?y.__data.Factures:i;return}},e:n,ObjectStat:this,x:0,y:0})},t.prototype.LoadFreeedFactures=function(){var n=this;y.requester.Request(u.models.Factures,"LOADFREEZED",this._freezedFactures,{Freezed:!0,csv:!0},function(t,u,f,e){f?(n._freezedFactures.Clear(),n._freezedFactures.FromCsv(e.Response,r.encoding.SerializationContext.GlobalContext.reset()),n.searchList.Source=n._freezedFactures):i.UI.InfoArea.push("Error Occured")})},t.prototype.FreezeFactures=function(n){var t=this,r=this.searchList.Source,f=this._freezedFactures;r===f&&(f=y.__data.Factures);i.UI.Modal.ShowDialog("Freeze Manager","Do you want really to "+(n?"":"un")+"freeze those factures",function(e){if(e.Result===i.UI.MessageResult.ok){var o=t.adapter.Source.AsList().map(function(n){return n.Id});y.requester.Request(u.models.Factures,"FREEZED",o,{Freezed:n},function(n,i,u){var e,h,c,s;if(u){for(e=0,h=o;e<h.length;e++)(c=h[e],s=r.GetById(c),s)&&(r.Remove(s),f.Add(s));t.paginator.Next();t.paginator.Previous()}})}},"Yes","No",null)},t}(i.UI.NavPanel);n.FacturesLivraison=t;w=function(){function n(n){this.getList=n;this.obs=-1;this.ref=-1;this.clt=-1;this.dt=-1;this.nart=-1;this.mnt=-1;this.stat=-1}return Object.defineProperty(n.prototype,"list",{get:function(){return this.getList()},enumerable:!0,configurable:!0}),n.prototype.OrderByObservation=function(){var n=this;this.obs=-this.obs;this.list.OrderBy(function(t,i){return n.obs*(t&&t.Observation||"").localeCompare(i&&i.Observation||"")})},n.prototype.OrderByRef=function(){var n=this;this.ref=-this.ref;this.list.OrderBy(function(t,i){return n.ref*(t.Ref||"").localeCompare(i.Ref||"")})},n.prototype.OrderByClient=function(){var n=this;this.clt=-this.clt;this.list.OrderBy(function(t,i){return n.clt*n.getclt(t).localeCompare(n.getclt(i))})},n.prototype.OrderByDate=function(){var n=this;this.dt=-this.dt;this.list.OrderBy(function(t,i){return n.dt*(n.getdt(t)-n.getdt(i))})},n.prototype.OrderByNArticles=function(){var n=this;this.nart=-this.nart;this.list.OrderBy(function(t,i){return n.nart*(t.NArticles-i.NArticles)})},n.prototype.OrderByMontant=function(){var n=this;this.mnt=-this.mnt;this.list.OrderBy(function(t,i){return n.mnt*(t.Total-i.Total)})},n.prototype.OrderByStat=function(){var n=this;this.stat=-this.stat;this.list.OrderBy(function(t,i){return n.stat*(t.Stat-i.Stat)})},n.prototype.getclt=function(n){var t=n;return t&&(t=t.Client)&&(t=t.FullName)||""},n.prototype.getdt=function(n){var t=n;return t&&(t=t.Date)&&(t=t.getTime())||0},n}()}(b=t.AdminNavs||(t.AdminNavs={}));p=function(){function n(n){this.target=n}return n.prototype.GetLeftBar=function(){var n=this,t;if(this.lb)return this.lb;this.lb=new i.UI.Navbar;t=this.lb.getTemplate;this.rm;this.lb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u};this.lb.OnInitialized=function(t){var r;t.AddRange([new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit"),new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"New"),new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete"),f.funcs.createSparator(),new i.UI.Glyph(i.UI.Glyphs.print,!1,"Print"),f.funcs.createSparator(),r=new i.UI.Glyph(i.UI.Glyphs.creditCard,!1,"Versment Manager"),]);n.rm=new i.UI.RichMenu(undefined,["Regler","Verser","Supprimer","","Ouvrir"],r)}},n.prototype.GetRightBar=function(){var n=this,t;if(this.rb)return this.rb;this.rb=new i.UI.Navbar;t=this.rb.getTemplate;this.rb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u};this.rb.OnInitialized=function(n){return n.AddRange([new i.UI.Glyph(i.UI.Glyphs.refresh,!1,"Update"),new i.UI.Glyph(i.UI.Glyphs.check,!1,"Validate"),new i.UI.Glyph(i.UI.Glyphs.floppyDisk,!1,"Save")])}},n.prototype.callback=function(n,t,r){var u=r.t.target;switch(r.p.Type){case i.UI.Glyphs.refresh:return u.FsUpdate();case i.UI.Glyphs.check:return u.Validate();case i.UI.Glyphs.floppyDisk:return u.FsSave();case i.UI.Glyphs.edit:return u.Open();case i.UI.Glyphs.plusSign:return u.New();case i.UI.Glyphs.fire:return u.Delete();case i.UI.Glyphs.print:return u.Print();case i.UI.Glyphs.creditCard:r.t.rm.Open(t,{Owner:r.t,Invoke:r.t.OnContextMenuFired},null,!0);break;default:i.UI.InfoArea.push("Unrechable Code");return}},n.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.target.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.target.verser(t==="Regler")},n.prototype.Print=function(n,t,i){i.target.Print()},n.prototype.Open=function(n,t,i){i.target.Open()},n.prototype.New=function(n,t,i){i.target.New()},n.prototype.Versement=function(n,t,i){i.rm.Open(t,{Owner:i.target,Invoke:i.target.OnContextMenuFired},null,!0)},n.prototype.FsSave=function(n,t,i){i.target.FsSave()},n.prototype.Update=function(n,t,i){i.target.FsUpdate()},n.prototype.Validate=function(n,t,i){i.target.Validate()},n.prototype.Delete=function(n,t,i){i.target.Delete()},n}()});define("Desktop/Admin/Costumers",["require","exports","./../../lib/Q/sys/UI","abstract/extra/Common","abstract/extra/Basics","../../lib/Q/sys/Filters","Desktop/Search","../../lib/Q/components/HeavyTable/script","assets/data/data"],function(n,t,i,r,u,f,e,o,s){"use strict";var h,c;Object.defineProperty(t,"__esModule",{value:!0});r.GetVars(function(n){return h=n,!1});c=function(n){function t(){var t=n.call(this,"Clients","Clients")||this;return t.searchFilter=new f.filters.list.StringFilter,t._creditCart=new i.UI.Glyph(i.UI.Glyphs.creditCard,!1,"Versments Manager"),t.rm=new i.UI.RichMenu(undefined,["Regler","Verser","Supprimer","","Ouvrir"],t._creditCart),t}return __extends(t,n),t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new f.filters.list.StringPatent(t);i||(this.searchList.Filter=this.searchFilter)},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F9:"Regler Les Versments",F10:"Open Versments",Enter:"Edit",Suppr:"Delete"});else if(t.keyCode===i.UI.Keys.F2)this.AddClient();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.EditClient();else if(t.keyCode===i.UI.Keys.Delete)this.RemoveClient();else if(t.keyCode===i.UI.Keys.F9)this.verser(!0);else if(t.keyCode===i.UI.Keys.F10)this.OpenVersments(!1);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Add(r.funcs.initializeSBox("Clients").container);var t;this.adapter=(t=new o.Material.HeavyTable(s.data.value.clientTable.def)).applyStyle("row");this.paginator=i.UI.Paginator.createPaginator(this.adapter,this.searchList=h.__data.Costumers.Filtred(this.searchFilter),10);this.adapter.AcceptNullValue=!1;this.Add(this.paginator);t.setOrderHandler({Invoke:this.OrderBy,Owner:this})},t.prototype.OrderBy=function(n){switch(n.orderBy){case"Ref":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Id-i.Id)});case"FName":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.FullName||"").localeCompare(i.FullName||"")});case"Tel":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Tel||"").localeCompare(i.Tel||"")});case"TotalM":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.MontantTotal-i.MontantTotal)});case"TotalV":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.VersmentTotal-i.VersmentTotal)});case"TotalS":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.SoldTotal-i.SoldTotal)})}},t.prototype.Update=function(){h.apis.Client.SmartUpdate()},t.prototype.AddClient=function(){h.apis.Client.CreateNew()},t.prototype.RemoveClient=function(){h.apis.Client.Delete(this.adapter.SelectedItem,null)},t.prototype.EditClient=function(){h.apis.Client.Edit(this.adapter.SelectedItem,void 0)},t.prototype.Search=function(){},t.prototype.GetLeftBar=function(){var n=this,t;return this.lb||(this.lb=new i.UI.Navbar,t=this.lb.getTemplate,this.lb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u},this.lb.OnInitialized=function(t){return t.AddRange([new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"Add"),new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit"),new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete"),r.funcs.createSparator(),n._creditCart])}),this.lb},t.prototype.GetRightBar=function(){var n=this,t;return this.rb||(this.rb=new i.UI.Navbar,t=this.rb.getTemplate,this.rb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u},this.rb.OnInitialized=function(n){return n.AddRange([new i.UI.Glyph(i.UI.Glyphs.search,!1,"Add")])}),this.rb},t.ctor=function(){},t.prototype.SendMessageToFacebook=function(){},t.prototype.sendInvitations=function(){},t.prototype.callback=function(n,t,r){switch(r.p.Type){case i.UI.Glyphs.plusSign:r.t.AddClient();break;case i.UI.Glyphs.edit:r.t.EditClient();break;case i.UI.Glyphs.fire:r.t.RemoveClient();break;case i.UI.Glyphs.search:r.t.Search();break;case i.UI.Glyphs.creditCard:r.t.rm.Open(t,{Owner:r.t,Invoke:r.t.OnContextMenuFired},null,!0);break;default:i.UI.InfoArea.push("Unrechable Code");return}},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new e.SearchData.Client);this._deepSearch.Open(function(){return n.searchList.Filter=n._deepSearch})},t.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.verser(t==="Regler")},t.prototype.OpenVersments=function(n){this.adapter.SelectedItem?h.apis.Versment.OpenVersmentsOfClient(this.adapter.SelectedItem,function(t,r,f,e){e&&n&&(r?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&h.apis.Versment.Delete(r,function(n){n.Error===u.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.verser=function(n){var t=this.adapter.SelectedItem;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une Client pour ajouter une versment");if(n)return h.apis.Versment.Regler(null,t);h.apis.Versment.VerserTo(null,t)},t}(i.UI.NavPanel);t.Clients=c});define("Desktop/Admin/Fournisseurs",["require","exports","../../lib/Q/sys/UI","abstract/extra/Common","../../lib/Q/sys/Corelib","abstract/extra/Basics","../../lib/Q/sys/Filters","Desktop/Search","../../lib/Q/components/HeavyTable/script","assets/data/data"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c,l;Object.defineProperty(t,"__esModule",{value:!0});r.GetVars(function(n){return c=n,!1});l=function(n){function t(){var t=n.call(this,"Fournissurs","Fournisseurs")||this;return t.searchFilter=new e.filters.list.StringFilter,t._creditCart=new i.UI.Glyph(i.UI.Glyphs.creditCard,!1,"Add"),t.rm=new i.UI.RichMenu(undefined,["Regler","Verser","Supprimer","","Ouvrir"],t._creditCart),i.UI.Desktop.Current.KeyCombiner.On("O","M",function(){alert("Success")},t,t),t.OnInitialized=function(){return u.Api.RiseApi("loadFournisseurs",void 0)},t}return __extends(t,n),Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Add(r.funcs.initializeSBox("Fournisseurs").container);var t;this.adapter=(t=new s.Material.HeavyTable(h.data.value.fournisseurTable.def)).applyStyle("row");this.paginator=i.UI.Paginator.createPaginator(this.adapter,this.searchList=c.__data.Fournisseurs.Filtred(this.searchFilter),10);this.Add(this.paginator);t.setOrderHandler({Invoke:this.OrderBy,Owner:this})},t.prototype.OrderBy=function(n){switch(n.orderBy){case"Id":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Id-i.Id)});case"Name":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Name||"").localeCompare(i.Name||"")});case"Tel":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.Tel||"").localeCompare(i.Tel||"")});case"TotalM":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.MontantTotal-i.MontantTotal)});case"TotalV":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.VersmentTotal-i.VersmentTotal)});case"TotalS":return this.searchList.OrderBy(function(t,i){return n.state.factor*(t.SoldTotal-i.SoldTotal)})}},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new o.SearchData.Fournisseur);this._deepSearch.Open(function(){return n.searchList.Filter=n._deepSearch})},t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F3:"Deep Searche",F5:"Update",F9:"Settle Debts",F10:"Versments",Suppr:"Delete",Enter:"Edit"});else if(t.keyCode===i.UI.Keys.F2)this.AddFournisseur();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.EditFournisseur();else if(t.keyCode===i.UI.Keys.Delete)this.RemoveFournisseur();else if(t.keyCode===i.UI.Keys.F9)this.verser(!0);else if(t.keyCode===i.UI.Keys.F10)this.OpenVersments(!1);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new e.filters.list.StringPatent(t);i||(this.searchList.Filter=this.searchFilter)},t.prototype.Update=function(){c.apis.Fournisseur.SmartUpdate()},t.prototype.AddFournisseur=function(){c.apis.Fournisseur.CreateNew(function(){})},t.prototype.RemoveFournisseur=function(){c.apis.Fournisseur.Delete(this.adapter.SelectedItem)},t.prototype.EditFournisseur=function(){c.apis.Fournisseur.Edit(this.adapter.SelectedItem)},t.prototype.GetLeftBar=function(){var n=this,t;return this.lb||(this.lb=new i.UI.Navbar,t=this.lb.getTemplate,this.lb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u},this.lb.OnInitialized=function(n){return n.AddRange([new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"Add"),new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit"),new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete")])}),this.lb},t.prototype.GetRightBar=function(){var n=this,t;return this.rb||(this.rb=new i.UI.Navbar,t=this.rb.getTemplate,this.rb.getTemplate=function(r){var f=new i.UI.Anchore(r),u=t(f);return u.addEventListener("click",n.callback,{t:n,p:r}),u},this.rb.OnInitialized=function(t){return t.AddRange([n._creditCart])}),this.rb},t.prototype.callback=function(n,t,r){var u=r.t;switch(r.p.Type){case i.UI.Glyphs.plusSign:u.AddFournisseur();break;case i.UI.Glyphs.edit:u.EditFournisseur();break;case i.UI.Glyphs.fire:u.RemoveFournisseur();break;case i.UI.Glyphs.search:u.OnDeepSearch();break;case i.UI.Glyphs.creditCard:r.t.rm.Open(t,{Owner:u,Invoke:r.t.OnContextMenuFired},null,!0)}},t.prototype.OnContextMenuFired=function(n,t){t==="Ouvrir"||t==="Supprimer"?this.OpenVersments(t==="Supprimer"):(t==="Regler"||t==="Verser")&&this.verser(t==="Regler")},t.prototype.OpenVersments=function(n){this.adapter.SelectedItem?c.apis.SVersment.OpenSVersmentsOfFournisseur(this.adapter.SelectedItem,function(t,r,u,e){e&&n&&r&&i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&c.apis.SVersment.Delete(r,function(n){n.Error===f.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler")}):i.UI.Modal.ShowDialog("Info","Selectioner un fournisseur",void 0,"OK",null,null)},t.prototype.verser=function(n){var t=this.adapter.SelectedItem;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une Fournisseur pour ajouter une versment");if(n)return c.apis.SVersment.Regler(null,t);c.apis.SVersment.VerserTo(null,t)},t}(i.UI.NavPanel);t.Fournisseurs=l});define("Desktop/Admin/Logins",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib","abstract/Models","abstract/extra/Common","Desktop/Search","../../lib/Q/sys/Filters"],function(n,t,i,r,u,f,e,o){"use strict";var v,s,c,l,a,h;Object.defineProperty(t,"__esModule",{value:!0});v=!0;f.GetVars(function(n){return s=n,!1});c=function(){function n(){}return n.prototype.GetLeftBar=function(n){var t=this,r;return this.lb||(this.lb=new i.UI.Navbar,this.permission=new i.UI.Glyph(i.UI.Glyphs.flag,!1,"Permissions"),this.validate=new i.UI.Glyph(i.UI.Glyphs.check,!1,"Validate"),this.lock=new i.UI.Glyph(i.UI.Glyphs.lock,!1,"Lock"),r=this.lb.getTemplate,this.lb.getTemplate=function(n){var f=new i.UI.Anchore(n),u=r(f);return u.addEventListener("click",t.callback,{t:t,p:n}),u},this.lb.OnInitialized=function(n){return n.AddRange([t.permission,t.validate,t.lock])}),this._targer=n,this.lb},n.prototype.callback=function(n,t,r){var u=r.t._targer;if(u)switch(r.p.Type){case i.UI.Glyphs.flag:u.ChangePermission();return;case i.UI.Glyphs.check:u.Validate();return;case i.UI.Glyphs.lock:u.Lock();return;default:throw"Unreachable Code";}},n.prototype.callback_right=function(n,t,r){var u=r.t._targer;if(u)switch(r.p.Type){case i.UI.Glyphs.plusSign:u.AddUser();return;case i.UI.Glyphs.listAlt:u.Edit();return;case i.UI.Glyphs.trash:u.Delete();return;case i.UI.Glyphs.search:u.Search();return;case i.UI.Glyphs.filter:u.Filter();default:throw"Unreachable Code";}},n.prototype.GetRightBar=function(n){var t=this,r;return this.rb||(this.rb=new i.UI.Navbar,this.add=new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"Add"),this.edit=new i.UI.Glyph(i.UI.Glyphs.listAlt,!1,"Edit"),this.delete=new i.UI.Glyph(i.UI.Glyphs.trash,!1,"Delete"),this.srch=new i.UI.Glyph(i.UI.Glyphs.search,!1,"Search"),this.filter=new i.UI.Glyph(i.UI.Glyphs.filter,!1,"Filter"),r=this.rb.getTemplate,this.rb.getTemplate=function(n){var f=new i.UI.Anchore(n),u=r(f);return u.addEventListener("click",t.callback_right,{t:t,p:n}),u},this.rb.OnInitialized=function(n){return n.AddRange([t.filter,t.srch,f.funcs.createSparator(),t.add,t.edit,t.delete])}),this._targer=n,this.rb},Object.defineProperty(n.prototype,"Target",{set:function(n){this._targer=n},enumerable:!0,configurable:!0}),n}();l=function(n){function t(){var t=n.call(this,"regular_users","Regular Comptes")||this;return t.adapter=new i.UI.ListAdapter("Client.Validation","UnRegUser.row"),t.searchFilter=new o.filters.list.StringFilter,t.Title="Regular Comptes",t}return __extends(t,n),t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new e.SearchData.Login);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new o.filters.list.StringPatent(t);i?this.searchList.Reset():this.searchList.Filter=this.searchFilter},t.prototype.OnKeyDown=function(t){this.adapter.OnKeyDown(t)||n.prototype.OnKeyDown.call(this,t)},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.Add(this.adapter);this.adapter.OnInitialized=function(){return t.Update()};this.searchList=s.validateLogins.Filtred(this.searchFilter)},t.prototype.Update=function(){var n=this;s.validateLogins.Clear();s.requester.Get(u.models.Logins,s.validateLogins,null,function(t,i,r){r&&(n.adapter.Source=n.searchList)},function(n){return n.Url="/_/Users?Valide=True"})},t.prototype.GetLeftBar=function(){return h.GetLeftBar(this)},t.prototype.GetRightBar=function(){return h.GetRightBar(this)},Object.defineProperty(t.prototype,"SelectedUser",{get:function(){return this.adapter.SelectedItem},enumerable:!0,configurable:!0}),t.prototype.ChangePermission=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Lock=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("lockuser",{data:n})},t.prototype.Validate=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("validateuser",{data:n})},t.prototype.Delete=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("removeuser",{data:n})},t.prototype.Edit=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.AddUser=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Filter=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Search=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t}(i.UI.NavPanel);t.RegularUsers=l;a=function(n){function t(){var t=n.call(this,"blocked_users","Blocked Comptes")||this;return t.adapter=new i.UI.ListAdapter("Client.Validation","RegUser.row"),t.searchFilter=new o.filters.list.StringFilter,t.Title="Blocked Comptes",t}return __extends(t,n),t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new e.SearchData.Login);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},t.prototype.OnSearche=function(n,t){this.searchFilter.Patent=new o.filters.list.StringPatent(t)},t.prototype.OnKeyDown=function(t){this.adapter.OnKeyDown(t)||n.prototype.OnKeyDown.call(this,t)},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.Add(this.adapter);this.adapter.OnInitialized=function(){return t.Update()};this.searchList=s.invalidateLogins.Filtred(this.searchFilter)},t.prototype.Update=function(){var n=this;s.invalidateLogins.Clear();s.requester.Get(u.models.Logins,s.invalidateLogins,null,function(t,i,r){r&&(n.adapter.Source=n.searchList)},function(n){n.Url="/_/Users?Valide=False"})},t.prototype.GetLeftBar=function(){return h.GetLeftBar(this)},t.prototype.GetRightBar=function(){return h.GetRightBar(this)},t.prototype.ChangePermission=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Lock=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("lockuser",{data:n})},t.prototype.Validate=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("validateuser",{data:n})},t.prototype.Delete=function(){var n=this.SelectedUser;n&&r.Api.RiseApi("removeuser",{data:n})},t.prototype.Edit=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.AddUser=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Filter=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},t.prototype.Search=function(){i.UI.InfoArea.push("The Functionality Is Not Implimented Yet")},Object.defineProperty(t.prototype,"SelectedUser",{get:function(){return this.adapter.SelectedItem},enumerable:!0,configurable:!0}),t}(i.UI.NavPanel);t.UnRegularUsers=a;h=new c});define("Desktop/Admin/Products",["require","exports","../../lib/Q/sys/UI","abstract/extra/Common","abstract/Models","../../lib/Q/sys/Filters","../../lib/Q/sys/Corelib","Desktop/Search","Componenets/Forms","Desktop/Jobs","Componenets/PStat"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l,a,v,y;Object.defineProperty(t,"__esModule",{value:!0});r.GetVars(function(n){return l=n,!1});a=function(n){function t(){var t=n.call(this,"products","Produits")||this;return t.btn_add=r.extern.crb("plus","Add","primary"),t.btn_edit=r.extern.crb("pencile","Edit","success"),t.btn_remove=r.extern.crb("trash","Remove","danger"),t.group_cnt=(new i.UI.Div).applyStyle("pull-right","flat"),t.group_tcnt=(new i.UI.Div).applyStyle("icontent-header"),t.adapter=new i.UI.ListAdapter("Products.table",null),t._caption=document.createTextNode("Products"),t.searchFilter=new f.filters.list.StringFilter,t.serv=new y,t.__order=new v(t),t}return __extends(t,n),t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new f.filters.list.StringPatent(t);i?this.searchList.Reset():this.searchList.Filter=this.searchFilter},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new o.SearchData.Product);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F3:"Deep Searche",F5:"Update",F9:"Add Revage",F10:"Edit Revage",Suppr:"Delete",Enter:"Edit"});else if(t.keyCode===i.UI.Keys.F2)this.btnAddClick();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)t.ctrlKey?this.showAvatar():this.btnEditClick();else if(t.keyCode===i.UI.Keys.Delete)this.btnRemoveClick();else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.Update=function(){l.apis.Product.SmartUpdate()},t.prototype.initsec=function(){var n=this.group_cnt.View;n.appendChild(this.btn_add);n.appendChild(this.btn_edit);n.appendChild(this.btn_remove);this.group_tcnt.View.appendChild(this._caption);this.group_tcnt.Add(this.group_cnt);this.Add(this.group_tcnt);this.initPaginator();this.btn_add.addEventListener("click",{handleEvent:function(){this.self.btnAddClick()},self:this});this.btn_edit.addEventListener("click",{handleEvent:function(){this.self.btnEditClick()},self:this});this.btn_remove.addEventListener("click",{handleEvent:function(){this.self.btnRemoveClick()},self:this});this.adapter.AcceptNullValue=!1},t.prototype.initPaginator=function(){var n=this;this.paginator=new i.UI.Paginator(10);this.paginator.OnInitialized=function(){n.adapter.OnInitialized=function(t){var i=n.searchList=e.collection.ExList.New(l.__data.Products,n.searchFilter);t.Source=e.collection.ExList.New(i,n.paginator.Filter);n.paginator.BindMaxToSourceCount(i)};n.paginator.Content=n.adapter};this.Add(this.paginator)},t.prototype.btnAddClick=function(){l.apis.Product.CreateNew()},t.prototype.btnEditClick=function(){l.apis.Product.Edit(this.adapter.SelectedItem,null)},t.prototype.btnRemoveClick=function(){l.apis.Product.Delete(this.adapter.SelectedItem,null)},t.prototype.initEvents=function(){this.btn_add.addEventListener("click",{handleEvent:function(n){this.self.btnAddClick(n)},self:this});this.btn_edit.addEventListener("click",{handleEvent:function(n){this.self.btnEditClick(n)},self:this});this.btn_remove.addEventListener("click",{handleEvent:function(n){this.self.btnRemoveClick(n)},self:this})},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.initsec();i.UI.Desktop.Current.KeyCombiner.On("S","R",function(n){var i=this,t;n.Cancel=!0;t=c.Statistique.Views.ListOfArticles.OpenQuery();t.OnInitialized=function(n){return n.SelectedProduct=i.adapter.SelectedItem}},this,this);i.UI.Desktop.Current.KeyCombiner.On("S","D",function(n){c.Statistique.Views.ListOfArticles.Open();n.Cancel},this,this)},t.prototype.OnPrint=function(){var r,i,t;for(n.prototype.OnPrint.call(this),r=this.adapter.Source.Source.AsList(),i=new Array(r.length),t=0;t<i.length;t++)i[t]=r[t].Id;l.requester.Request(u.models.Products,"PRINT",JSON.stringify(i.join("|")),void 0,function(n,t){if(t.Response&&t.Response.Success){var i=__global.ApiServer.Combine("/_/$?Id="+t.Response.FileName).FullPath;s.Forms.PDFViewer.Show(i)}})},t.prototype.selectavatar=function(){var t=this,n;this.pictureEditor||(this.pictureEditor=new h.PictureEditor(this.adapter),n=!0);this.pictureEditor.Open(function(n){n.Upload(t.adapter.SelectedItem,function(n){n.Error==e.basic.DataStat.Success?i.UI.InfoArea.push("La picture successfully uploaded"):n.Error==e.basic.DataStat.OperationCanceled?i.UI.InfoArea.push("L'Operation Annulé"):i.UI.InfoArea.push("Une Error occure !!!!!!!!!")})});n&&(this.pictureEditor.OnInitialized=function(n){return n.SetVisible(i.UI.MessageResult.ok,!1)})},t.prototype.showAvatar=function(){var i,n,t;this.s||(i=this.s=e.bind.Scop.Create("SelectedItem",this.adapter,e.bind.BindingMode.SourceToTarget,this.__Controller__),i.OnPropertyChanged(e.bind.Scop.DPValue,function(n,t){var i=t._new,r;s.Forms.ImageModal.Default.IsOpen&&(r=i&&i.Picture,s.Forms.ImageModal.Default.Open(r==undefined||r==""?"":"/_/Picture/"+r,i&&i.toString()))},this),s.Test1());n=this.adapter.SelectedItem;n&&(t=n&&n.Picture,s.Forms.ImageModal.Default.Open(t==undefined||t==""?"":"/_/Picture/"+t,n&&n.toString()))},t.prototype.GetLeftBar=function(){return this.serv.GetLeftBar(this)},t.prototype.GetRightBar=function(){return this.serv.GetRightBar(this)},t}(i.UI.NavPanel);t.ProductsNav=a;v=function(){function n(n){this.prd=n;this.ctg=-1;this.nm=-1;this.dim=-1;this.ser=-1;this.qlt=-1;this.qte=-1;this.prx=-1}return Object.defineProperty(n.prototype,"list",{get:function(){return this.prd.adapter.Source},enumerable:!0,configurable:!0}),n.prototype.OrderByCategory=function(){var t=this,n;this.ctg=-this.ctg;n=function(n){return n&&(n=n.Category)&&n.Name||""};this.list.OrderBy(function(i,r){return t.ctg*n(i).localeCompare(n(r))})},n.prototype.OrderByName=function(){var n=this;this.nm=-this.nm;this.list.OrderBy(function(t,i){return n.nm*(t.Name||"").localeCompare(i.Name||"")})},n.prototype.OrderByDimention=function(){var n=this;this.dim=-this.dim;this.list.OrderBy(function(t,i){return n.dim*(t.Dimention||"").localeCompare(i.Dimention||"")})},n.prototype.OrderBySerieName=function(){var n=this;this.ser=-this.ser;this.list.OrderBy(function(t,i){return n.ser*(t.SerieName||"").localeCompare(i.SerieName||"")})},n.prototype.OrderByQuality=function(){var n=this;this.qlt=-this.qlt;this.list.OrderBy(function(t,i){return n.qlt*(t.Quality-i.Quality)})},n.prototype.OrderByQte=function(){var n=this;this.qte=-this.qte;this.list.OrderBy(function(t,i){return n.qte*(t.Qte-i.Qte)})},n.prototype.OrderByPrice=function(){var n=this;this.prx=-this.prx;this.list.OrderBy(function(t,i){return n.prx*(t.Value-i.Value)})},n}();y=function(){function n(){}return n.prototype.handleSerices=function(n,t,r){var u=r.t.target,f;if(u){f=i.UI.Glyphs;switch(r.c){case f.edit:u.btnEditClick();break;case f.plusSign:u.btnAddClick();break;case f.fire:u.btnRemoveClick();break;case f.picture:u.selectavatar()}}},n.prototype.GetLeftBar=function(n){var t=this,u;return this.target=n,this.lb||(u=this.lb=new i.UI.Navbar,r.funcs.setTepmlate(u,this,this.handleSerices),u.OnInitialized=function(n){t._edit=new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit");t._new=new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"New");t._delete=new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete");n.AddRange([t._new,t._edit,t._delete,r.funcs.createSparator(),])}),this.lb},n.prototype.GetRightBar=function(n){var u=this,t;return this.target=n,this.rb||(t=this.rb=new i.UI.Navbar,r.funcs.setTepmlate(t,this,this.handleSerices),t.OnInitialized=function(n){n.AddRange([u.add2stock=new i.UI.Glyph(i.UI.Glyphs.flash,!1,"Add 2 Stock"),r.funcs.createSparator(),u.picture=new i.UI.Glyph(i.UI.Glyphs.picture,!1,"Select Avatar")])}),this.rb},n}()});define("Desktop/Admin/FacturesNonValider",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib","abstract/extra/Common","abstract/extra/Basics","../../lib/Q/sys/Filters","Desktop/Search"],function(n,t,i,r,u,f,e,o){"use strict";var s,h;Object.defineProperty(t,"__esModule",{value:!0});u.GetVars(function(n){return s=n,!1});h=function(n){function t(t){var r=n.call(this,"factures_nonvalider","Factures Non Valider")||this;return r.app=t,r.adapter=new i.UI.ListAdapter("Factures.InValidation","Factures.row"),r.searchFilter=new e.filters.list.StringFilter,r.Title="Les Facture Non Validé",r}return __extends(t,n),t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new e.filters.list.StringPatent(t);i?this.searchList.Reset():this.searchList.Filter=this.searchFilter},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new o.SearchData.Facture);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.OnKeyDown=function(t){if(!this.adapter.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",F3:"Deep Searche",F5:"Update",F9:"Settle Debts",F10:"Versments",Suppr:"Delete",Enter:"Edit"});else if(t.keyCode===i.UI.Keys.F2)this.New();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.Open();else if(t.keyCode===i.UI.Keys.Delete)this.Delete();else if(t.keyCode===i.UI.Keys.F9)this.verser(!0);else if(t.keyCode===i.UI.Keys.F10)this.OpenVersments(!1);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.Open=function(){r.Api.RiseApi("OpenFacture",{data:this.adapter.SelectedItem})},t.prototype.Delete=function(){r.Api.RiseApi("DeleteFacture",{data:this.adapter.SelectedItem})},t.prototype.New=function(){r.Api.RiseApi("NewFacture",{data:null,callback:function(){}})},t.prototype.OpenVersments=function(n){this.adapter.SelectedItem?s.apis.Versment.OpenVersmentsOfFacture(this.adapter.SelectedItem,function(t,r,u,e){e&&n&&(r?i.UI.Modal.ShowDialog("Confirmation","Voulez- vous vraiment supprimer ce veremnet",function(n){n.Result===i.UI.MessageResult.ok&&s.apis.Versment.Delete(r,function(n){n.Error===f.basics.DataStat.Success?i.UI.InfoArea.push("Ce Virement Est bien Supprimé",!0,5e3):i.UI.InfoArea.push("Une erreur s'est produite lorsque nous avons supprimé cette version",!0,5e3)})},"Supprimer","Annuler"):i.UI.InfoArea.push("Vous ne sélectionnez aucun Virement"))}):i.UI.InfoArea.push("You Must Set first the client")},t.prototype.verser=function(n){var t=this.adapter.SelectedItem;if(!t)return i.UI.Modal.ShowDialog("ERROR","Selecter une Facture pour ajouter une versment");if(t.IsOpen)return i.UI.Modal.ShowDialog("Error","Close the facture for you can make a versment");if(n)return s.apis.Versment.Regler(t,t.Client);s.apis.Versment.VerserTo(t,t.Client)},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.Add(this.adapter);this.initJobs();this.adapter.OnInitialized=function(n){return n.Source=t.searchList=s.__data.Factures.Filtred(t.searchFilter)};this.adapter.AcceptNullValue=!1},t.prototype.initJobs=function(){var n=this,t=new r.encoding.SerializationContext(!0);r.bind.GetJob("SelectPage");r.bind.Register({Name:"openfacture",OnInitialize:function(t){t.addEventListener("dblclick","dblclick",function(){var i=t.Scop.Value;n.app.OpenPage("Facture")})}});r.bind.Register({Name:"facturevalidate",OnInitialize:function(n){n.addEventListener("onclick","dblclick",function(){var t=n.Scop.Value;s.apis.Facture.Validate(t,!1,function(n,r,u){u===f.basics.DataStat.Success?(t.Freeze(),s.invalidateFactures.Remove(t),i.UI.InfoArea.push("The Facture Is Valiated",!0)):i.UI.InfoArea.push("Error Occured When Validating The Facture",!1)})})}})},t.prototype.Update=function(){s.apis.Facture.SmartUpdate()},t}(i.UI.NavPanel);t.FactureNav=h});define("Desktop/Admin/Categories",["require","exports","../../lib/Q/sys/UI","abstract/extra/Common","../../lib/Q/sys/Corelib","../../lib/Q/sys/Filters","Desktop/Search"],function(n,t,i,r,u,f,e){"use strict";var o,s,h;Object.defineProperty(t,"__esModule",{value:!0});r.GetVars(function(n){return o=n,!1});s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","!",'"',"#","%","'","(",")",",","/",";"];h=function(n){function t(){var t=n.call(this,"categories","Categories")||this;return t.btn_add=r.extern.crb("plus","Add","primary"),t.btn_edit=r.extern.crb("pencile","Edit","success"),t.btn_remove=r.extern.crb("trash","Remove","danger"),t.group_cnt=(new i.UI.Div).applyStyle("pull-right","flat"),t.group_tcnt=(new i.UI.Div).applyStyle("icontent-header"),t.adapter=new i.UI.ListAdapter("Categories.table","Category.row"),t._caption=document.createTextNode("Categories"),t.searchFilter=new f.filters.list.StringFilter,t}return __extends(t,n),t.prototype.Update=function(){o.apis.Category.SmartUpdate()},t.prototype.initsec=function(){var n=this.group_cnt.View;n.appendChild(this.btn_add);n.appendChild(this.btn_edit);n.appendChild(this.btn_remove);this.group_tcnt.View.appendChild(this._caption);this.group_tcnt.Add(this.group_cnt);this.Add(this.group_tcnt);this.paginator=new i.UI.Paginator(12);this.Add(this.paginator)},t.prototype.OnSearche=function(n,t){var i=this.searchList.Filter==this.searchFilter;this.searchFilter.Patent=new f.filters.list.StringPatent(t);i?this.searchList.Reset():this.searchList.Filter=this.searchFilter},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},set:function(){},enumerable:!0,configurable:!0}),t.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({F2:"Add New",Enter:"Edit",Suppr:"Delete"});else if(t.keyCode===i.UI.Keys.Right)this.paginator.Next();else if(t.keyCode===i.UI.Keys.Left)this.paginator.Previous();else if(t.keyCode===i.UI.Keys.F2)this.btnAddClick();else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)this.btnEditClick();else if(t.keyCode===i.UI.Keys.Delete)this.btnRemoveClick();else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.btnAddClick=function(){o.apis.Category.CreateNew()},t.prototype.btnEditClick=function(){o.apis.Category.Edit(this.adapter.SelectedItem)},t.prototype.btnRemoveClick=function(){o.apis.Category.Delete(this.adapter.SelectedItem)},t.prototype.initEvents=function(){this.btn_add.addEventListener("click",{handleEvent:function(n){this.self.btnAddClick(n)},self:this});this.btn_edit.addEventListener("click",{handleEvent:function(n){this.self.btnEditClick(n)},self:this});this.btn_remove.addEventListener("click",{handleEvent:function(n){this.self.btnRemoveClick(n)},self:this})},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.initsec();this.initEvents();this.paginator.OnInitialized=function(){t.adapter.OnInitialized=function(n){var i=t.searchList=u.collection.ExList.New(o.__data.Categories,t.searchFilter);n.Source=u.collection.ExList.New(i,t.paginator.Filter);t.paginator.BindMaxToSourceCount(i)};t.paginator.Content=t.adapter};this.adapter.AcceptNullValue=!1},t.prototype.GetLeftBar=function(){var n=this,t;return this.lb||(t=this.lb=new i.UI.Navbar,r.funcs.setTepmlate(t,this,this.handleSerices),t.OnInitialized=function(t){n._edit=new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit");n._new=new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"New");n._delete=new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete");t.AddRange([n._new,n._edit,n._delete])}),this.lb},t.prototype.handleSerices=function(n,t,r){var u=i.UI.Glyphs;switch(r.c){case u.edit:return r.t.btnEditClick();case u.plusSign:return r.t.btnAddClick();case u.fire:return r.t.btnRemoveClick();default:throw"NotImplimented";}},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new e.SearchData.Category);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},t}(i.UI.NavPanel);t.CategoryNav=h});define("Desktop/Admin/Revages",["require","exports","../../lib/Q/sys/UI","../../lib/Q/sys/Corelib","abstract/Models","abstract/extra/Common","../../lib/Q/sys/Filters","Desktop/Search"],function(n,t,i,r,u,f,e,o){"use strict";function c(n,t){var i;t?n.Type==u.models.TransferType.Facture?(i=s.__data.SFactures.GetById(n.TransactionId),i&&r.Api.RiseApi("OpenSFacture",{data:i})):s.apis.SVersment.Show(s.apis.SVersment.Get(n.TransactionId),void 0,!1):n.Type==u.models.TransferType.Facture?(i=s.__data.Factures.GetById(n.TransactionId),i&&r.Api.RiseApi("OpenFacture",{data:i})):s.apis.Versment.Show(s.apis.Versment.Get(n.TransactionId),undefined,!1)}function v(n,t){t?n.Type==u.models.TransferType.Facture?s.apis.SFacture.Delete(!0,s.__data.SFactures.GetById(n.TransactionId),null):s.apis.SVersment.Delete(s.apis.SVersment.Get(n.TransactionId)):n.Type==u.models.TransferType.Facture?s.apis.Facture.Delete(!0,s.__data.Factures.GetById(n.TransactionId),null):s.apis.Versment.Delete(s.apis.Versment.Get(n.TransactionId))}var s,h,l,a;Object.defineProperty(t,"__esModule",{value:!0});f.GetVars(function(n){return s=n,!1});h=function(n){function t(t,r,u,f){var e=n.call(this,t,r)||this;return e.tableTemplate=f,e.HasSearch=i.UI.SearchActionMode.Validated,e.serv=new a,e}return __extends(t,n),t.prototype.OnKeyDown=function(t){var r;if(!this.adapter.OnKeyDown(t))if(t.keyCode==i.UI.Keys.F1?this.getHelp({Enter:"Open Transaction",Suppr:"Delete Transaction",F3:"Deep Searche",F4:"New Etat"}):t.keyCode===i.UI.Keys.F4?this.btnOpen():t.keyCode==i.UI.Keys.Enter?(r=this.adapter.SelectedItem,r&&this.Open(r)):t.keyCode===i.UI.Keys.Delete&&(r=this.adapter.SelectedItem,r&&this.Delete()),t.keyCode==i.UI.Keys.Left)this.paginator.Previous();else if(t.keyCode==i.UI.Keys.Right)this.paginator.Next();else return n.prototype.OnKeyDown.call(this,t);return t.preventDefault(),t.stopPropagation(),!0},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.adapter=new i.UI.ListAdapter(this.tableTemplate);this.adapter.AcceptNullValue=!1;this.adapter.ItemStyle=[];this.paginator=new i.UI.Paginator(21);this.paginator.OnInitialized=function(){t.adapter.OnInitialized=function(n){n.Source=t.paginationList=r.collection.ExList.New(t.searchList=r.collection.ExList.New(t.getSource(),new e.filters.list.StringFilter),t.paginator.Filter);t.paginator.BindMaxToSourceCount(t.searchList)};t.paginator.Content=t.adapter};this.head=new i.UI.TControl("templates.transferHeader",this.getSource());this.Add(this.head);this.Add(this.paginator)},t.prototype.OnDeepSearch=function(){var n=this;this._deepSearch||(this._deepSearch=new o.SearchData.Etats);this._deepSearch.Open(function(){var t=n.searchList.Filter==n._deepSearch;n.searchList.Filter=n._deepSearch;t&&n.searchList.Reset()})},t.prototype.setSource=function(n){this.head.Data=n;this.searchList&&(this.searchList.Source=n)},t.prototype.OnSearche=function(n,t){this.searchList.Filter.Patent=new e.filters.list.StringPatent(t)},t.prototype.GetLeftBar=function(){return this.serv.GetLeftBar(this)},t.prototype.GetRightBar=function(){return this.serv.GetRightBar(this)},t}(i.UI.NavPanel);t.EtatBases=h;l=function(n){function t(t){var i=n.call(this,t?"fournisseurEtat":"clientEtat",t?"Situation Fournisseur":"Situation  Clientele",t?"Situation  Fournisseur":"Situation  Clientele",t?"etatTransfers.atable":"etatTransfers.table")||this;return i.isFrn=t,i.source=new u.models.EtatTransfers(null),i}return __extends(t,n),t.prototype.Delete=function(){v(this.adapter.SelectedItem,this.isFrn)},t.prototype.Open=function(n){c(n,this.isFrn)},t.prototype.btnDeleteVersment=function(){},t.prototype.btnAddVersment=function(){throw new Error("Method not implemented.");},t.prototype.btnSearch=function(){throw new Error("Method not implemented.");},t.prototype.btnVersmentOfOwner=function(){throw new Error("Method not implemented.");},t.prototype.Update=function(){var n=this.source.Owner;n instanceof u.models.Client?this.ExecuteCLient(n):n instanceof u.models.Fournisseur?this.ExecuteFournisseur(n):this.btnOpen()},t.prototype.btnOpen=function(){var n=this;this.isFrn?s.apis.Fournisseur.Select(function(t){t.Error==r.basic.DataStat.Success&&n.ExecuteFournisseur(t.Data)},null):s.apis.Client.Select(function(t){t.Error==r.basic.DataStat.Success&&n.ExecuteCLient(t.Data)},null)},t.prototype.check=function(){throw new Error("Method not implemented.");},t.prototype.getSource=function(){return this.source},t.prototype.ExecuteCLient=function(n){var t=this;this.setSource(this.source);this.source.Clear();s.requester.Request(u.models.EtatTransfers,"GET",this.source,{Id:n.Id,IsAchat:!1},function(){t.source.Owner=n;t.source.ReOrder()})},t.prototype.ExecuteFournisseur=function(n){var t=this;this.source.Clear();s.requester.Request(u.models.EtatTransfers,"GET",this.source,{Id:n.Id,IsAchat:!0},function(){t.source.Owner=n;t.source.ReOrder()})},t}(h);t.Etats=l;a=function(){function n(){}return n.prototype.handleSerices=function(n,t,r){var u=r.t.target,f;if(u){f=i.UI.Glyphs;switch(r.c){case f.search:return u.btnOpen()}}},n.prototype.GetLeftBar=function(n){var r=this,t;return this.target=n,this.lb||(t=this.lb=new i.UI.Navbar,f.funcs.setTepmlate(t,this,this.handleSerices),t.OnInitialized=function(n){return n.AddRange([r._search=new i.UI.Glyph(i.UI.Glyphs.search,!1,"Search")])}),this.lb},n.prototype.GetRightBar=function(n){var r=this,t;return this.target=n,this.rb||(t=this.rb=new i.UI.Navbar,f.funcs.setTepmlate(t,this,this.handleSerices),t.OnInitialized=function(n){r._delete=new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Delete");n.AddRange([r._delete])}),this.rb},n}();r.ScopicCommand.Register({Invoke:function(n,t,i){return t.addEventListener("click",function(){return c(i.Value)}),!1}},null,"openTransaction");r.ScopicCommand.Register({Invoke:function(n,t,i){return t.addEventListener("click",function(){return c(i.Value,!0)}),!1}},null,"openaTransaction")});define("Modules/Charts",["require","exports","../lib/q/sys/Corelib","../lib/q/sys/UI","../lib/Chart.bundle.js"],function(n,t,i,r,u){"use strict";var f,e;Object.defineProperty(t,"__esModule",{value:!0});f=function(n){function t(t){var r=n.call(this,t||document.createElement("canvas"))||this;return r._hidden=[],r.__data=[],r.plots={},r.Change(function(){return r.Reset(),r.DataSource=new i.collection.List(Object),r.Labels=new i.collection.List(String),void 0}),r}return __extends(t,n),t.prototype.OnDataSourceChanged=function(n){for(var t in this.plots)this.plots[t].list.Source=n._new;this.Update()},t.prototype.OnChartTypeChanged=function(n){this.chart.config.type=n._new;this.Reset()},t.prototype.initialize=function(){},t.prototype.GetPlot=function(n){return this.plots[n]},t.prototype.AddPlot=function(n,t,r){this.RemovePlot(n);var u={data:r,title:n,selector:t,list:new i.collection.TransList(Number,{ConvertA2B:t,ConvertB2A:void 0},this),Dispose:function(){this.list.Source=void 0;this.list.Dispose();delete this.data;delete this.list;delete this.selector;delete this.title}};r.label=n;u.list.Source=this.DataSource;this.plots[n]=u},t.prototype.RemovePlot=function(n){var t=this.plots[n];delete this.plots[n];t&&t.Dispose()},t.prototype.Change=function(n,t,r){this._pauseUpdate=!0;r=r||[];r.unshift(this);var u=i.helper.TryCatch(t,n,void 0,r)===!0;this._pauseUpdate=!1;u||this.Update()},t.prototype.Update=function(){var t,i,n;if(!this._pauseUpdate&&!this._pauseReset&&this.IsInit){t=[];for(i in this.plots)n=this.plots[i],n.data.data=n.list.AsList(),t.push(n.data);this.chart.config.data={datasets:t,labels:this.Labels.AsList()};this.chart.update();this.chart.resize()}},t.prototype.Reset=function(){var n=this;if(!this._pauseReset){if(!this.IsInit){this._pauseReset=!0;this.OnInitialized=function(n){delete n._pauseReset;n.Reset()};return}try{this.chart&&this.chart.destroy()}catch(t){}this.chart=null;this.chart=new u.Chart(this.View,{type:this.ChartType||"line",data:{datasets:[],labels:[]},options:this.Options});this.chart.config.options.responsive=!0;this.chart.config.options.onClick=function(t,i){n.Change(function(){var n,t,r;if(!i.length)return!0;for(n=0,t=i;n<t.length;n++)r=t[n],this.Labels.RemoveAt(r._index),this.DataSource.RemoveAt(r._index)},n)};this.Update()}},Object.defineProperty(t.prototype,"Plots",{get:function(){return this.plots},enumerable:!0,configurable:!0}),t.prototype.ClearPlots=function(){this.Change(function(){for(var n in this.plots)try{this.RemovePlot(n)}catch(t){}return this.plots={},void 0},this)},__decorate([i.attributes.property(String,"line",void 0,t.prototype.OnChartTypeChanged),__metadata("design:type",String)],t.prototype,"ChartType",void 0),__decorate([i.attributes.property(i.collection.List,void 0,void 0,t.prototype.OnDataSourceChanged),__metadata("design:type",i.collection.List)],t.prototype,"DataSource",void 0),__decorate([i.attributes.property(i.collection.List,void 0,void 0),__metadata("design:type",i.collection.List)],t.prototype,"Labels",void 0),t}(r.UI.JControl);t.UIChart=f;e=function(){function n(){}return n.DrawNonNumeric=function(){},n.DrawArea=function(n,t,i,r,f){var s=n.getContext("2d"),e,o;if(s.clearRect(0,0,n.width,n.height),e={backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)"},!(e.data instanceof Array))throw"data in dataset null not allowed";for(o in r)e[o]=r[o]||e[o];return new u.Chart(s,{type:t,data:{labels:i,datasets:[e]},options:f})},n}();t.CharTemplates=e;i.attributes.ComponentParser("ichart",function(n){var i=n.Dom,t=document.createElement("canvas"),r=t.getContext("2d"),f=new u.Chart(r,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"# of Votes",data:[12,19,3,5,2,3],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}});return window.myChart=f,i.appendChild(t),{Break:!1}});i.attributes.ComponentParser("chart",function(n){var u=n.Dom,i=document.createElement("canvas"),t=new f(i);return u.appendChild(i),t.Parent=n.parent.Control||n.Control||r.UI.Desktop.Current,n.e.Control=t,t.Options={scales:{yAxes:[{ticks:{beginAtZero:!0}}]}},{Break:!1}})});define("Idea/FileManager",["require","exports","template|../assets/templates/FileManager.html","abstract/extra/Common","../lib/Q/sys/Filters","abstract/Models","assets/data/data","../lib/q/components/HeavyTable/script","../lib/q/sys/Components","abstract/Models","./../lib/Chart.bundle.js","../lib/q/Core","Modules/Charts"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var p,y,b,v,tt,w,k,d,g,nt,rt,it,ut;Object.defineProperty(t,"__esModule",{value:!0});p=new l.collection.Dictionary("quee_sync_frame");r.GetVars(function(n){return y=clone(n),!1});b={files:new l.collection.Dictionary("files"),folders:new l.collection.Dictionary("folders")};ValidateImport(a.CharTemplates),function(n){var s,r,u,t,i,e,o;(function(n){n[n.None=0]="None";n[n.View=1]="View";n[n.Read=3]="Read";n[n.Write=7]="Write";n[n.Delete=15]="Delete";n[n.Permissions=31]="Permissions"})(s=n.Permission||(n.Permission={}));r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return t.store},t.prototype.Update=function(){},t.prototype.Upload=function(){},t.store=new l.collection.Dictionary("PFiles"),__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"FileName",void 0),__decorate([l.attributes.property(f.models.Client),__metadata("design:type",f.models.Client)],t.prototype,"Client",void 0),__decorate([l.attributes.property(Number,0),__metadata("design:type",Number)],t.prototype,"Permission",void 0),t}(l.sdata.DataRow);n.PermissionFile=r;u=function(n){function t(t){var i=n.call(this)||this;return i.Name=t,i}return __extends(t,n),t.prototype.toString=function(){return this.Name},__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Name",void 0),t}(l.bind.DObject);n.Segment=u;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return b.files},t.prototype.toString=function(){return this.Name},__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Name",void 0),__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Type",void 0),__decorate([l.attributes.property(Number),__metadata("design:type",Number)],t.prototype,"Size",void 0),__decorate([l.attributes.property(Date),__metadata("design:type",Date)],t.prototype,"Date",void 0),t}(l.sdata.QShopRow);n.File=t;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getStore=function(){return b.folders},__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Name",void 0),t}(l.sdata.QShopRow);n.Folder=i;e=function(i){function r(){return i.call(this,void 0,n.File,function(n){return new t(n)})||this}return __extends(r,i),r}(l.sdata.DataTable);n.Files=e;o=function(t){function r(){return t.call(this,void 0,n.Folder,function(n){return new i(n)})||this}return __extends(r,t),r}(l.sdata.DataTable);n.Folders=o}(v=t.models||(t.models={}));tt=function(t){function r(){var n=t.call(this,i.template.Folder.Manager,l.UI.TControl.Me)||this;return n._imageCapture=new it.ImageCapture,n.list=new l.collection.List(v.PermissionFile),n.xm=new d(n.list),n.rt=[{type:"icongroup",value:[{iconName:"content_copy",commandName:"cmd-copy"},{iconName:"content_paste",commandName:"cmd-paste"},{iconName:"content_cut",commandName:"cmd-cut"},{iconName:"settings",commandName:"cmd-settings"}]},{type:"separator"},{type:"menu-item",commandName:"open_file",label:"Open",iconName:"visibility"},{type:"menu-item",commandName:"cmd-download",label:"Download",iconName:"file_download"},{type:"menu-item",commandName:"take-photo",label:"Take Photo",iconName:"add_a_photo"},{type:"menu-item",commandName:"cmd-upload",label:"Upload",iconName:"cloud_upload"},],n._contextMenu=new s.Components.MdContextMenu(n.rt),n.Files=new l.collection.ExList(v.File),n.Folders=new v.Folders,n.Path=new l.collection.List(v.Segment),n.XFiles=new v.Files,n.Files.Filter=new u.filters.list.StringFilter,n.Files.Source=n.XFiles,n}return __extends(r,t),r.prototype.OnSearch=function(n,t){this.Files.Filter.Patent=new u.filters.list.StringPatent(t)},r.prototype.OnCurrentUrlChanged=function(){this.Update()},r.prototype.OnCurrentUrlCheck=function(n){var t=n._new,i=n._old;if(t&&(t=this.reduce(t)),t&&i&&t.IsEquals(i)){n._new=i;return}n._new=t},r.prototype.setName=function(n,t,i){switch(n){case"_folders":this._folders=i;this._folders.AcceptNullValue=!1;break;case"_files":this._files=i;this._folders.AcceptNullValue=!0;this.initializeDrop();break;case"_path":this._path=i;break;default:return}},r.prototype.initializeDrop=function(){var t=this,n=this.View;n.addEventListener("drop",function(n){n.stopPropagation();n.preventDefault();for(var i=0;i<n.dataTransfer.files.length;i++)t.Upload(n.dataTransfer.files.item(i))});n.addEventListener("dragover",function(n){n.stopPropagation();n.preventDefault();n.dataTransfer.dropEffect="copy"})},r.prototype.GoBack=function(){var n=this.CurrentUrl;n&&(n=n.ParentDirectory,n)&&(this.CurrentUrl=n)},r.prototype.OpenFolder=function(n){if(n){var t=this.CurrentUrl;t=t?t.Combine(n.Name+"/"):new System.basics.Url(n.Name+"/");this.CurrentUrl=t}},r.prototype.GoToFolder=function(n,t,i){this.OpenFolder(i.Value)},r.prototype.FolderKeyDown=function(n,t,i){return n.keyCode===13?this.OpenFolder(i.Value):n.keyCode===l.UI.Keys.Delete?this.DeleteFolder(i.Value):void 0},r.prototype.DeleteFolder=function(){},r.prototype.reduce=function(n){for(var r,t=[],u=n.path,i=0;i<u.length;i++){r=u[i];switch(r){case"..":t.pop();break;case"":t.splice(0,t.length);break;case".":break;default:t.push(r)}}return new System.basics.Url(t.join("/")+(t.length?"/":""))},r.prototype.getUrl=function(n){for(var r=this.Path.AsList(),i="./",t=0;t<n;t++)i+=r[t].Name+"/";return i},r.prototype.GoToUrl=function(n,t,i){var u=i.Value,f,r;u&&(f=this.CurrentUrl,r=this.getUrl(this.Path.IndexOf(u)+1),r)&&(this.CurrentUrl=new System.basics.Url(r))},r.prototype.OpenFile=function(n,t,i){var r=i.Value,u;r&&(u=this.CurrentUrl.Combine(r.Name),l.UI.Modal.ShowDialog(u.FullPath,"You Just clicked to download a file"))},r.prototype.Update=function(){var n=this,t=this.CurrentUrl;y.requester.Costume({Url:"/_/explore?dir="+t.FullPath,Method:l.net.WebRequestMethod.Get},null,null,function(i,u){n.Folders.Clear();n.XFiles.Clear();n.Path.Clear();t.path.length?(n.Folders.Add(r.backFolder),n.Path.Add(r.backSegment)):n.Path.Add(r.currentSegment);n.Folders.FromCsv(u.Folders||[]);n.XFiles.FromCsv(u.Files||[]);n.Path.AddRange(t.path.map(function(n){return new v.Segment(n)}));u.IsDeleted&&(n.CurrentUrl=t.ParentDirectory)},this)},r.prototype.XTakePhoto=function(){var n=this,t=new FileReader,i=Date.now();t.addEventListener("loadend",function(){var r=n._imageCapture._videoRecorder;n.UploadVideoBlob(t.result,"Video_"+r.RecordID+"-"+i+".mp4",r.Cursor)});this._imageCapture._videoRecorder.OnPropertyChanged(this._imageCapture._videoRecorder.GetDPCurrentDataProperty(),function(n,i){t.readAsArrayBuffer(i._new)});this._imageCapture.Open(function(t){if(t.modalResult.Result==l.UI.MessageResult.ok){var i=prompt("Entry the name of file","Image_"+Date.now()+".png");i?n.UploadBlob(t.Buffer,i.lastIndexOf(".png")===i.length-4?i:i+".png"):l.UI.InfoArea.push("Operation canceled",!0)}})},r.prototype.OnKeyDown=function(n){var t=n.keyCode;if(t===l.UI.Keys.F9)return this.XTakePhoto(),!0;if(t===37||t===39)return this.selectedCNT=this._files,this.selectedCNT.View.focus(),Object.defineProperty(n,"keyCode",{value:t+1}),this._files.OnKeyDown(n);if(t===38||t===40)return this.selectedCNT=this._folders,this.selectedCNT.View.focus(),this._folders.OnKeyDown(n);if(t==9?this.selectedCNT=this.selectedCNT===this._folders?this._files:this._folders:this.selectedCNT||(this.selectedCNT=this._folders),this.selectedCNT.View.focus(),!this.selectedCNT.OnKeyDown(n)){if(t===27)this.selectedCNT.SelectedIndex=-1;else if(t===13){if(this.selectedCNT===this._folders)return this.OpenFolder(this._folders.SelectedItem);this.loadPermissions()}else t===9&&n.stopPropagation();return!0}},r.prototype.loadPermissions=function(){var n=this,t=this._files.SelectedItem,i=this.CurrentUrl,r=t&&t.Name||".";y.requester.Request(v.PermissionFile,"LISTPERMISSIONS",void 0,{dir:i.FullPath,file:r,cid:0,per:31},function(u,f){var a=1,e={Client:void 0,FileName:void 0,Permission:0},s,o,h,c;n.list.Clear();for(s in f)(o=f[s],h=parseInt(s),isNaN(h))||(c=new v.PermissionFile(a++),e.Client=h,e.FileName=r,typeof o=="number"&&typeof v.Permission[o]=="string")&&(e.Permission=o,c.FromJson(e,l.encoding.SerializationContext.GlobalContext),n.list.Add(c));l.UI.Modal.ShowDialog("Permissions",n.xm.InitVars(i,t),function(){},"Close",null,null)})},r.prototype.initialize=function(){t.prototype.initialize.call(this);this.CurrentUrl=new System.basics.Url("./")},r.ctor=function(){n("style|../assets/FileManager/font-awesome/css/font-awesome.min.css");this.backFolder.Name=".."},r.prototype.getContentOf=function(){},r.prototype.GoNext=function(){},r.prototype.NewFile=function(){},r.prototype.XUploadFile=function(){var n=r.button,i,t;r.button||(r.button=n=document.createElement("input"),i=this,n.addEventListener("input",function(){for(var t=0;t<this.files.length;t++)i.Upload(this.files[t]);try{n.files=null}catch(e){}}));n.type="file";t=document.createEvent("MouseEvent");t.initEvent("click",!1,!1);n.dispatchEvent(t)},r.prototype.UploadFile=function(){this.XUploadFile()},r.prototype.UploadVideoBlob=function(n,t,i){var r=this,u=this.CurrentUrl;y.requester.Costume({Url:"/_/explore?push&seek="+i+"&id=-1&slice_id=-1&dir="+u.FullPath+"&file="+t+"&size="+n.byteLength+"&lastm="+new Date(Date.now()).toISOString()+"&type=image/png&slice_start=0&slice_size="+n.byteLength,Method:l.net.WebRequestMethod.Post,HasBody:!0},n,null,function(n,i,u){var s,f,e,h,o;if(u){for(s=t.toLowerCase(),f=0,e=r.Files.AsList();f<e.length;f++)if(h=e[f],h.Name.toLowerCase()==s)return;o=new v.File(r.Files.Count+1);o.Name=t;r.Files.Add(o)}},this)},r.prototype.UploadBlob=function(n,t){var i=this,r=this.CurrentUrl;l.UI.Spinner.Default.Start("Uploading "+t);y.requester.Costume({Url:"/_/explore?id=-1&slice_id=-1&dir="+r.FullPath+"&file="+t+"&size="+n.byteLength+"&lastm="+new Date(Date.now()).toISOString()+"&type=image/png&slice_start=0&slice_size="+n.byteLength,Method:l.net.WebRequestMethod.Post,HasBody:!0},n,null,function(n,u,f){var h,e,o,c,s;if(l.UI.Spinner.Default.Pause(),f){for(l.UI.InfoArea.push("L'image "+t+" est bien enregister"),h=t.toLowerCase(),e=0,o=i.Files.AsList();e<o.length;e++)if(c=o[e],c.Name.toLowerCase()==h)return;s=new v.File(i.Files.Count+1);s.Name=t;i.Files.Add(s)}else l.UI.InfoArea.push("Fatal error when upload file "+t+" to directory "+r.FullPath,!1)},this)},r.prototype.Upload=function(n){function u(n){var i=this,t;console.log(n.percentage);t=n.file;y.requester.Costume({Url:"/_/explore?id="+n.sender.id+"&slice_id="+n.slice.id+"&dir="+r.FullPath+"&file="+n.file.name+"&size="+t.size+"&lastm="+t.lastModified+"&type="+t.type+"&slice_start="+n.slice.start+"&slice_size="+n.data.byteLength,Method:l.net.WebRequestMethod.Post,HasBody:!0},n.data,null,function(r,u,f){l.UI.Spinner.Default.Start("Uploading "+t.name+" : "+n.percentage+"%");f?(n.percentage>=100&&l.UI.Spinner.Default.Pause(),n.onSuccess()):l.UI.InfoArea.push("Fatal error when upload file "+t.name+" to directory "+i.CurrentUrl.FullPath,!1)},this)}var t=this,r=this.CurrentUrl,i=new g(n,u);i.OnDone=function(n){for(var f,r,e=n.file.name.toLowerCase(),i=0,u=t.Files.AsList();i<u.length;i++)if(f=u[i],f.Name.toLowerCase()==e)return;r=new v.File(t.Files.Count+1);r.Name=n.file.name;t.Files.Add(r);n.sender.Dispose()};i.StartUpload()},r.prototype.XDownloadFile=function(n){var i,n,r,t;(n||(i=this.CurrentUrl,n=this._files.SelectedItem,n instanceof v.File))&&(r=i.Combine(n.Name),t=document.createElement("a"),t.href="/_/explore?file="+r.FullPath+"&dwn",t.download="Download.jpg",t.click())},r.prototype.DownloadFile=function(){this.XDownloadFile()},r.prototype.OnContextMenu=function(n){var t=this;this._files.View.contains(n.target)&&l.UI.Desktop.Current.CurrentApp.OpenContextMenu(this._contextMenu,{callback:function(n){return t.OnContextMenuCallback(n,n.selectedItem)},e:n,ObjectStat:this._files.SelectedItem,x:0,y:0})},r.prototype.OnContextMenuCallback=function(n,t){if(t.type==="separator"||t.type==="label")return n.cancel=!0;switch(t.commandName){case"cmd-copy":l.UI.InfoArea.push("La command "+t.commandName+" n'est pas implimenter (DEMO VERSION)",!1,1e3);break;case"cmd-paste":l.UI.InfoArea.push("La command "+t.commandName+" n'est pas implimenter (DEMO VERSION)",!1,1e3);break;case"cmd-cut":l.UI.InfoArea.push("La command "+t.commandName+" n'est pas implimenter (DEMO VERSION)",!1,1e3);break;case"cmd-delete":l.UI.InfoArea.push("La command "+t.commandName+" n'est pas implimenter (DEMO VERSION)",!1,1e3);break;case"cmd-settings":this.loadPermissions();break;case"cmd-download":this.XDownloadFile();break;case"cmd-upload":this.XUploadFile();break;case"take-photo":this.XTakePhoto()}},r.backFolder=new v.Folder(-1),r.backSegment=new v.Segment(".."),r.currentSegment=new v.Segment("."),__decorate([l.attributes.property1(System.basics.Url,{changed:r.prototype.OnCurrentUrlChanged,check:r.prototype.OnCurrentUrlCheck}),__metadata("design:type",System.basics.Url)],r.prototype,"CurrentUrl",void 0),__decorate([l.attributes.property(l.collection.List),__metadata("design:type",l.collection.List)],r.prototype,"Path",void 0),__decorate([l.attributes.property(l.collection.ExList),__metadata("design:type",l.collection.ExList)],r.prototype,"Files",void 0),__decorate([l.attributes.property(v.Folders),__metadata("design:type",v.Folders)],r.prototype,"Folders",void 0),__decorate([l.attributes.property(Boolean),__metadata("design:type",Boolean)],r.prototype,"IsOpening",void 0),r}(l.UI.TControl);t.FileManager=tt;w=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return this.Label||this.Name},__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Name",void 0),__decorate([l.attributes.property(String),__metadata("design:type",String)],t.prototype,"Label",void 0),__decorate([l.attributes.property(l.collection.List),__metadata("design:type",l.collection.List)],t.prototype,"Params",void 0),t}(l.bind.DObject);k=function(n){function t(){var t=n.call(this,i.template.Folder.stat,l.UI.TControl.Me)||this;return t._handlers={},t.Actions=new l.collection.List(Object),t.Value=t,t.initHandlers(),t}return __extends(t,n),t.prototype.register=function(n){this._handlers[n.Name.toLowerCase()]=n},t.prototype.initHandlers=function(){function r(t,i,r){n(t);var u=t.chart.DataSource,f=t.chart.Labels;u.AddRange(r);f.AddRange(i)}function n(n){var r=n.chart,i=n.chart.DataSource,t;i&&i.Clear();t=n.chart.Labels;t&&t.Clear()}function u(n){var t=Object.keys(n),i=t.indexOf("@ref");return i!==-1&&t.splice(i,1),t}var i=new h.models.Client(-1),f;i.Name="unknown";f=new h.models.Product(-1);f.Name="unknown";this.register({Name:"NFactureAchatsBydate",Swap:function(n){for(var f,e=u(n),r=new Array(e.length),t=0;t<r.length;t++)f=e[t],r[t]={client:h.models.Client.getById(parseInt(f)||-1)||i,nFactures:n[f]};return r},Clear:n,Draw:function(n){n.chart.ClearPlots();n.handler.Clear(n);n.chart.AddPlot("N° Factures Acheter par clients",function(n,t,i){return i.nFactures},t.options);n.handler.Update(n)},Update:function(n){for(var u,i=n.data,f=new Array(i.length),e=new Array(i.length),t=0;t<i.length;t++)u=i[t],e[t]=u.client&&u.client.FirstName||"unknown",f[t]=u;r(n,e,f)},OnAction:function(n,t){var r,i,u,f;if(t==="Total"){for(r=0,i=0,u=n.data;i<u.length;i++)f=u[i],r+=f.nFactures;l.UI.InfoArea.push("N° Factures est "+r)}else t=="Trie Par N° Factures (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.nFactures-t.nFactures}),this.handler.Update(this),!1},n):t=="Trie Par N° Factures (Down)"&&n.chart.Change(function(){return this.data.sort(function(n,t){return t.nFactures-n.nFactures}),this.handler.Update(this),!1},n)},Actions:["Total","Trie Par N° Factures (UP)","Trie Par N° Factures (Down)"]});this.register({Name:"TotalAchatsByClient",Clear:n,Swap:function(n){for(var f,e=u(n),r=new Array(e.length),t=0;t<r.length;t++)f=e[t],r[t]={client:h.models.Client.getById(parseInt(f)||-1)||i,total:n[f]};return r},Draw:function(n){var i=n.chart;i.ClearPlots();n.handler.Clear(n);i.AddPlot("Total des bon achats par clients",function(n,t,i){return i.total},t.options);n.handler.Update(n)},Update:function(n){for(var u,i=n.data,f=new Array(i.length),e=new Array(i.length),t=0;t<i.length;t++)u=i[t],e[t]=u.client&&u.client.FirstName||"unknown",f[t]=u;r(n,e,f)},OnAction:function(n,t){var r,i,u,f;if(t==="Total"){for(r=0,i=0,u=n.data;i<u.length;i++)f=u[i],r+=f.total;l.UI.InfoArea.push("<h1>Montant Total des Factures est<br> "+r+"<\/h1>",!0,5e3)}else t=="Trie Par Total (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.total-t.total}),this.handler.Update(this),!1},n):t=="Trie Par Total (Down)"&&n.chart.Change(function(){return this.data.sort(function(n,t){return t.total-n.total}),this.handler.Update(this),!1},n)},Actions:["Total","Trie Par Total (UP)","Trie Par Total (Down)"]});this.register({Name:"TotalVersmentByClient",Clear:n,Swap:function(n){for(var f,e=u(n),r=new Array(e.length),t=0;t<r.length;t++)f=e[t],r[t]={client:h.models.Client.getById(parseInt(f)||-1)||i,versment:n[f]};return r},Draw:function(n){n.chart.ClearPlots();n.handler.Clear(n);n.chart.AddPlot("Total des versements par clients",function(n,t,i){return i.versment},t.options);n.handler.Update(n)},Update:function(n){for(var u,i=n.data,f=new Array(i.length),e=new Array(i.length),t=0;t<i.length;t++)u=i[t],e[t]=u.client&&u.client.FirstName||"unknown",f[t]=u;r(n,e,f)},OnAction:function(n,t){var r,i,u,f;if(t==="Total des Versement"){for(r=0,i=0,u=n.data;i<u.length;i++)f=u[i],r+=f.versment;l.UI.InfoArea.push("<h1>Total des versement est<br> "+r+"<\/h1>",!0,5e3)}else t=="Trie Par Versement (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.versment-t.versment}),this.handler.Update(this),!1},n):t=="Trie Par Versement (Down)"&&n.chart.Change(function(){return this.data.sort(function(n,t){return t.versment-n.versment}),this.handler.Update(this),!1},n)},Actions:["Total des Versement","Trie Par Versement (UP)","Trie Par Versement (Down)"]});this.register({Name:"ProduitAcheter",Clear:n,Swap:function(n){for(var r,e=u(n),i=new Array(e.length),t=0;t<i.length;t++)r=e[t],i[t]={product:h.models.Product.getById(parseInt(r)||-1)||f,data:n[r]};return i},Draw:function(n){var i=n.chart;i.ClearPlots();n.handler.Clear(n);i.AddPlot("Qte total",function(n,t,i){return i[0]},t.options);i.AddPlot("Total Acheter",function(n,t,i){return i[1]},t.options);i.AddPlot("Benifice Total ",function(n,t,i){return i[2]},t.options);n.handler.Update(n)},OnAction:function(n,t){var i,u,r;if(t==="Total"){var f=0,e=0,o=0;for(i=0,u=n.data;i<u.length;i++)r=u[i],f+=r.data[0],e+=r.data[1],o+=r.data[2];l.UI.InfoArea.push("<h1>Qte total Acheter est "+f+"<br>Montant Total est "+e+"<br>Benifice Total est "+o+"<\/h1>",!0,5e3)}else t=="Trie Par Qte (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.data[0]-t.data[0]}),this.handler.Update(this),!1},n):t=="Trie Par Qte (Down)"?n.chart.Change(function(){return this.data.sort(function(n,t){return t.data[0]-n.data[0]}),this.handler.Update(this),!1},n):t=="Trie Par Montant (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.data[1]-t.data[1]}),this.handler.Update(this),!1},n):t=="Trie Par Montant (Down)"?n.chart.Change(function(){return this.data.sort(function(n,t){return t.data[1]-n.data[1]}),this.handler.Update(this),!1},n):t=="Trie Par Benifice (UP)"?n.chart.Change(function(){return this.data.sort(function(n,t){return n.data[2]-t.data[2]}),this.handler.Update(this),!1},n):t=="Trie Par Benifice (Down)"&&n.chart.Change(function(){return this.data.sort(function(n,t){return t.data[2]-n.data[2]}),this.handler.Update(this),!1},n)},Actions:["Total","Trie Par Qte (UP)","Trie Par Qte (Down)","Trie Par Montant (UP)","Trie Par Montant (Down)","Trie Par Benifice (UP)","Trie Par Benifice (Down)"],Update:function(n){for(var u,i=n.data,f=new Array(i.length),e=new Array(i.length),t=0;t<i.length;t++)u=i[t],e[t]=u.product&&u.product.toString()||"unknown",f[t]=u.data;r(n,e,f)}})},t.prototype.OnAction=function(n){n._new&&(this.currentArgs.handler.OnAction(this.currentArgs,n._new),l.thread.Dispatcher.call(this,function(){this.CurrentAction=null}))},t.prototype._hasValue_=function(){return!0},t.prototype.setName=function(n,t,i,r){var u=this;this[n]=i;l.bind.NamedScop.Create("ChartTypes",new l.collection.List(String,["bar","bubble","doughnut","horizontalBar","line","pie","polarArea","radar","scatter"]));n==="_charttype"&&r.Scop.OnPropertyChanged(l.bind.Scop.DPValue,function(n,t){u.ChartType=t._new},this)},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.OnCompiled=function(){return y.requester.Request(h.models.Statstics,"methods",void 0,void 0,function(n,t,i){if(i){var r=t&&t.__list__;r&&(r=r.map(function(n){return(new w).FromJson(n,l.encoding.SerializationContext.GlobalContext.reset())}),l.bind.NamedScop.Create("productStatistics").Value=new l.collection.List(Object,r))}})}},t.ctor=function(){l.bind.NamedScop.Create("productStatistics",void 0,l.bind.BindingMode.TwoWay)},t.prototype.Update=function(){function t(n){return n&&n.Id||-1}var n=this,i={Client:this.Client,Product:this.Product,Method:this.Method,From:this.From,To:this.To};y.requester.Request(h.models.Statstics,"out",void 0,{from:this.From.toISOString(),to:this.To.toISOString(),cid:t(this.Client),pid:t(this.Product),method:this.Method&&this.Method.Name||"TotalAchatsByClient"},function(t,r,u){n._chart.Change(function(n,t){var f=(i.Method&&i.Method.Name||"TotalAchatsByClient").toLowerCase(),r=this._handlers[f],u;if(r)t=r.Swap(t),u={chart:this._chart,sender:this,handler:r,data:t,previousArgs:this.currentArgs},l.helper.TryCatch(r,r.Draw,void 0,[u]),this.Actions.Clear(),this.Actions.AddRange(r.Actions),this.currentArgs=u;else return!0},n,[r,u])})},t.prototype.Refresh=function(){this._chart.Update()},t.prototype.OnKeyDown=function(n){var t=this.currentArgs;if(t)switch(n.keyCode){case l.UI.Keys.F1:t.handler.OnAction(t,"arg1")}},Object.defineProperty(t,"options",{get:function(){return clone({backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1})},enumerable:!0,configurable:!0}),t.prototype.OnChartTypeChanged=function(n){this._chart.ChartType=n._new},__decorate([l.attributes.property(w,void 0,void 0),__metadata("design:type",w)],t.prototype,"Method",void 0),__decorate([l.attributes.property(String,void 0,void 0,t.prototype.OnAction),__metadata("design:type",String)],t.prototype,"CurrentAction",void 0),__decorate([l.attributes.property(Date,new Date),__metadata("design:type",Date)],t.prototype,"From",void 0),__decorate([l.attributes.property(Date,new Date),__metadata("design:type",Date)],t.prototype,"To",void 0),__decorate([l.attributes.property(h.models.Product),__metadata("design:type",h.models.Product)],t.prototype,"Product",void 0),__decorate([l.attributes.property(h.models.Client,void 0,void 0,function(){}),__metadata("design:type",h.models.Client)],t.prototype,"Client",void 0),__decorate([l.attributes.property(String,"",void 0,t.prototype.OnChartTypeChanged),__metadata("design:type",String)],t.prototype,"ChartType",void 0),__decorate([l.attributes.property(l.collection.List),__metadata("design:type",l.collection.List)],t.prototype,"Actions",void 0),t}(l.UI.TControl);t.StatView=k;d=function(n){function t(t){var i=n.call(this,e.data.value.FilePermissionsTable.def)||this;return i.Source=t,i}return __extends(t,n),t.prototype.InitVars=function(n,t){return this.dir=n,this.file=t,this},t.prototype.OnKeyDown=function(n){if(n.keyCode===l.UI.Keys.F2)this.Source.Add(new v.PermissionFile(l.basic.GuidManager.Next));else return!1;return!0},t.prototype.DeletePermission=function(n,t,i){var u=this,r=i.Value;y.requester.Request(v.PermissionFile,"DELETEPERMISSION",void 0,{dir:this.dir.FullPath,file:this.file.Name,cid:r.Client.Id,per:r.Permission},function(n,t,i){if(i)u.Source.Remove(r);else return l.UI.InfoArea.push("The attribute doesnt deleted !!!!",!1);l.UI.InfoArea.push("The attribute deleted !!!!",!0)})},t.prototype.SavePermission=function(n,t,i){var r=i.Value;if(r.Client==null)return l.UI.InfoArea.push("The client cannot be null");y.requester.Request(v.PermissionFile,"SETPERMISSION",void 0,{dir:this.dir.FullPath,file:this.file&&this.file.Name,cid:r.Client.Id,per:r.Permission},function(n,t,i){if(i)l.UI.InfoArea.push("The attribute saved !!!!",!0);else return l.UI.InfoArea.push("The attribute doesnt saved !!!!",!1)})},t}(o.Material.HeavyTable);t.PermissionsTable=d;g=function(){function n(n,t,i){i===void 0&&(i=102400);this.file=n;this.onSliceCreated=t;this.slice_size=i;this.reader=new FileReader;this.id=l.basic.GuidManager.Next+"UP"+l.basic.GuidManager.Next}return n.prototype.Dispose=function(){this.reader=null;this.file=null},n.prototype.StartUpload=function(){this.nextBlobSlice(0)},n.prototype.nextBlobSlice=function(n){var t=this,i=n+this.slice_size,r=this.file.slice(n,i);this.reader.onloadend=function(r){if(r.target.readyState===FileReader.DONE){var u={sender:t,data:r.target.result,get file(){return this.sender.file},slice:{start:n,size:t.slice_size,next:i,id:l.basic.GuidManager.Next+"slice34"},get percentage(){var t=n+this.slice.size;return Math.floor(t/this.file.size*100)},onError:function(t){t&&this.sender.nextBlobSlice(n)},onSuccess:function(){var n=this.slice.start+this.slice.size,t=Math.floor(n/this.file.size*100);this.slice.next<this.file.size?this.sender.nextBlobSlice(this.slice.next):this.sender.OnDone(this)}};t.onSliceCreated(u)}};this.reader.readAsArrayBuffer(r)},n.prototype.UploadBlob=function(){},n}();t.BlobReader=g;nt=function(n){function t(t){var i=n.call(this)||this;if(i.quee=[],i._isExecuting=!1,!i.handler||!i.handler.Invoke)throw"argument (handler) null";return i.handler={Invoke:t.Invoke,Owner:t.Owner},Object.preventExtensions(i),i}return __extends(t,n),t.prototype.push=function(n){this.quee.push(n);this._isExecuting||this.EndOperation(void 0)},t.prototype.EndOperation=function(n){if(p.Get(this)!==n)throw new Error("Unknown frame");if(this.quee.length){this._isExecuting=!0;this.CurrentData=this.quee.shift();var n={data:this.CurrentData,quee:this};p.Set(this,n);l.helper.TryCatch(this.handler.Owner||this,this.handler.Invoke,function(n,t){t.quee.EndOperation(t)},[n])}else this._isExecuting=!1,this.CurrentData=void 0,p.Set(this,void 0)},__decorate([l.attributes.property(Object),__metadata("design:type",Object)],t.prototype,"CurrentData",void 0),t}(l.bind.DObject);t.SyncQuee=nt,function(n){function i(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return i.join("&")}var t=function(n){function t(){var t=n.call(this,!0)||this;return t._root="/_/explore",t.ERegister(l.net.WebRequestMethod.Open,"LISTPERMISSIONS","method=list&dir=@dir&file=@file",!1),t.ERegister(l.net.WebRequestMethod.Open,"SETPERMISSION","method=set&dir=@dir&file=@file&cid=@cid&per=@per",!1),t.ERegister(l.net.WebRequestMethod.Open,"DELETEPERMISSION","method=delete&dir=@dir&file=@file&cid=@cid",!1),t}return __extends(t,n),Object.defineProperty(t.prototype,"Url",{get:function(){return __global.GetApiAddress(this._root)},enumerable:!0,configurable:!0}),t.prototype.GetType=function(){return v.PermissionFile},t.prototype.GetRequest=function(n,t,r){var u=this.GetMethodShema(t),f;return u&&u.ParamsFormat?f=u.ParamsFormat.apply(r||{}):r&&(f=i(r)),new l.net.RequestUrl(f?this.Url+"?"+f:this.Url,null,null,u?u.Method:0,u.SendData)},t.prototype.OnResponse=function(n,t){return t},t}(l.Controller.Api);n.PermissionApi=t;new t}(rt=t.API||(t.API={})),function(n){var t=function(n){function t(t){t===void 0&&(t=1e3);var i=n.call(this)||this;return i.intervalFrame=t,i._chunks=[],i._handler={handleEvent:function(n){switch(n.type){case"error":return this.owner.OnError(n);case"warning":return this.owner.OnWarning(n);case"stop":return this.owner.OnStop(n);case"pause":return this.owner.OnPause(n);case"resume":return this.owner.OnResume(n);case"start":return this.owner.OnPlay(n);case"stop":return this.owner.OnStop(n)}},owner:i},i}return __extends(t,n),Object.defineProperty(t.prototype,"NativeStat",{get:function(){return this._recorder.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsRecording",{get:function(){return this._recorder?this._recorder.state==="recording":!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsInactive",{get:function(){return this._recorder?this._recorder.state==="inactive":!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsPaused",{get:function(){return this._recorder?this._recorder.state==="paused":!0},enumerable:!0,configurable:!0}),t.prototype.Play=function(){if(this.IsPaused)return this.Resume();this.IsInactive&&this._recorder&&this._recorder.start()},t.prototype.Pause=function(){if(this.IsRecording)return this._recorder&&this._recorder.pause()},t.prototype.Stop=function(){this.IsInactive||this._recorder&&this._recorder.stop()},t.prototype.Resume=function(){if(this.IsInactive)return this.Play();this.IsRecording||this._recorder&&this._recorder.resume()},t.prototype._startThread=function(){clearInterval(this.thread);this._recorder&&(this.thread=setInterval(function(n){n.onThread()},this.intervalFrame||200,this))},t.prototype._stopThread=function(){this.thread=clearInterval(this.thread)},t.prototype.onThread=function(){this._recorder&&this._recorder.requestData()},t.prototype.grabDate=function(){this._recorder&&this._recorder.requestData()},t.prototype.OnPause=function(){this.grabDate();this.State="paused";this._stopThread()},t.prototype.OnStop=function(){this.State="inactive";this._stopThread()},t.prototype.OnResume=function(){this.State="recording";this._startThread()},t.prototype.OnPlay=function(){this.State="recording";this.RecordID++;this._startThread()},t.prototype.OnError=function(){this.State=this.NativeStat},t.prototype.OnWarning=function(){this.State=this.NativeStat},t.prototype.handleEvent=function(n){n.data.size!=0&&(this.CurrentData=n.data)},t.getCodec=function(){for(var i,n=0,t=this.codecs;n<t.length;n++)if(i=t[n],MediaRecorder.isTypeSupported(i))return i},t.prototype.onSuccessStream=function(n){var i,r,u;for(this.Stream=n,this._recorder=new MediaRecorder(n,{mimeType:t.getCodec()}),this._recorder.addEventListener("dataavailable",this),this.Avaible=!0,i=0,r=t.events;i<r.length;i++)u=r[i],this._recorder.addEventListener(u,this._handler)},t.prototype.onFailStream=function(){this.Avaible=!1},t.prototype.OnStateChanged=function(n){if(this._recorder.state!==n._new)switch(n._new){case"inactive":this.Stop();break;case"paused":this.Pause();break;case"recording":this.Play()}},t.prototype.OnBlobChanaged=function(n){this.FragmentID++;n._old&&(this.Cursor+=n._old.size)},t.prototype.GetDPCurrentDataProperty=function(){return this.GetProperty("CurrentData")},t.prototype.OnRecordIDChanged=function(){this.FragmentID=0},t.prototype.TakePicture=function(n){var i,t,r,u;this.picture||(this.picture={_video:document.createElement("video"),_canvas:document.createElement("canvas")});n.video&&!n.canvas&&(n.canvas=document.createElement("canvas"));i=n.video||this.picture._video;t=n.video?n.canvas:this.picture._canvas;t.width=i.videoWidth;t.height=i.videoHeight;t.getContext("2d").drawImage(i,0,0);r=this;u=t.toBlob(function(t){function u(){n.detacheVideoSource&&(n.video.srcObject=void 0);n.callback&&n.callback({sender:r,blob:t,args:n,error:!0})}var i=new FileReader;i.onload=function(i){n.detacheVideoSource&&(n.video.srcObject=void 0);n.callback&&n.callback({sender:r,blob:t,buffer:i.target.result,error:!1,args:n})};i.onerror=u;i.onabort=u;i.readAsArrayBuffer(t)},"image/png")},t.getImage=function(n){var t=this,i=n.canvas.toBlob(function(t){function r(){n.callback&&n.callback({sender:void 0,blob:t,args:n,error:!0})}var i=new FileReader;i.onload=function(i){n.callback&&n.callback({sender:void 0,blob:t,buffer:i.target.result,error:!1,args:n})};i.onerror=r;i.onabort=r;i.readAsArrayBuffer(t)},"image/png")},t.prototype.Dispose=function(){var n,i,r;if(this.Initialized!==!1){this._stopThread();this.Stop();try{this.Stream&&(this.Stream.getTracks().every(function(n){return n.stop(),!1}),this.Stream.stop(),this.Stream=null)}catch(u){}if(this._recorder)for(n=0,i=t.events;n<i.length;n++)r=i[n],this._recorder.removeEventListener(r,this._handler);this._recorder=void 0;this.Stream=void 0;this.Initialized=!1}},t.prototype.Setup=function(){if(!this.Initialized){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,n=function(n){return n instanceof MediaStream?this.onSuccessStream(n):this.onFailStream(n)}.bind(this);t?navigator.getUserMedia({video:{width:{exact:640},height:{exact:480}}},n,n):alert("The browser does not support Media Interface");this.Initialized=!0}},t.events=["error","pause","resume","start","stop","warning"],t.labels={paused:"Resume Recorder",inactive:"Start Recorder",recording:"Pause Recorder"},t.codecs=["video/webm;codecs=vp9","video/webm;codecs=h264","video/webm;codecs=vp8"],__decorate([l.attributes.property(String,"inactive",void 0,t.prototype.OnStateChanged),__metadata("design:type",String)],t.prototype,"State",void 0),__decorate([l.attributes.property(Number,0,void 0,t.prototype.OnRecordIDChanged),__metadata("design:type",Object)],t.prototype,"RecordID",void 0),__decorate([l.attributes.property(Number,0),__metadata("design:type",Object)],t.prototype,"FragmentID",void 0),__decorate([l.attributes.property(Blob,void 0,void 0,t.prototype.OnBlobChanaged),__metadata("design:type",Blob)],t.prototype,"CurrentData",void 0),__decorate([l.attributes.property(Number,0),__metadata("design:type",Number)],t.prototype,"Cursor",void 0),__decorate([l.attributes.property(Boolean),__metadata("design:type",Boolean)],t.prototype,"Avaible",void 0),__decorate([l.attributes.property(Boolean,undefined),__metadata("design:type",Boolean)],t.prototype,"Initialized",void 0),__decorate([l.attributes.property(MediaStream),__metadata("design:type",MediaStream)],t.prototype,"Stream",void 0),t}(l.bind.DObject),r;n.VideoRecorder=t;r=function(n){function r(){var r=n.call(this,i.template.Folder.Picture,l.UI.TControl.Me)||this;return r._videoRecorder=new t,window.icc=r,r}return __extends(r,n),r.prototype.__takePic=function(n,t){this.IsPlaying?(this.pause(),t.dom.textContent="Resume"):(t.dom.textContent="Pause",this.play())},r.prototype.__recordeVid=function(n,t){this._videoRecorder.IsRecording?(this._videoRecorder.Pause(),t.dom.textContent="Resume Video"):(this._videoRecorder.Play(),t.dom.textContent="Recording")},r.prototype.setName=function(n,t){var i=this;switch(n){case"_video":this._video=t;this._videoRecorder.OnPropertyChanged(this._videoRecorder.GetProperty("Stream"),function(n,t){i._video.srcObject=t._new;i.play()},this);this._video.srcObject=this._videoRecorder.Stream;default:return}},Object.defineProperty(r.prototype,"IsPlaying",{get:function(){return!!(this._video.currentTime>0&&!this._video.paused&&!this._video.ended&&this._video.readyState>2)},enumerable:!0,configurable:!0}),r.prototype.TakePicture=function(n){this._videoRecorder.TakePicture({callback:function(t){n({sender:t.args.objectStat,blob:t.blob,Buffer:t.buffer})},video:this._video,canvas:this._canvas,detacheVideoSource:!1,objectStat:this})},r.prototype.Open=function(n){var r=this,t=[],i={sender:this,blob:void 0,Buffer:void 0,modalResult:void 0,grabContent:function(n){var i=this;if(Object.isFrozen(this))return n(this);(t.push(n),t.length>1)||this.sender.TakePicture(function(n){var r,u,f;for(Object.freeze(i),r=0,u=t;r<u.length;r++){f=u[r];try{f(n)}catch(e){}}t=void 0})}};return this.OnCompiled=function(n){return n._videoRecorder.Setup()},l.UI.Modal.ShowDialog("Image Capture",this,function(t){t.Result===l.UI.MessageResult.ok?i.grabContent(function(i){i.sender._videoRecorder.Dispose();i.sender.pause();i.modalResult=t;n&&n(i)}):(i.sender._videoRecorder.Dispose(),n({blob:void 0,Buffer:void 0,sender:r,modalResult:t,grabContent:function(){}}))},"Save","Discart",null),this},r.prototype.play=function(n){this.IsPlaying||this._video.play().then(function(t){return typeof n=="function"&&n(!0,t)}).catch(function(t){return typeof n=="function"&&n(!0,t)})},r.prototype.pause=function(){this.Number=[Math.random()*Math.PI];this._video.paused||this._video.pause()},r.prototype.refresh=function(){this._videoRecorder.Dispose();this._videoRecorder.Setup()},r.prototype.trim=function(n){return n.substr(3)},r.prototype.test=function(n){return n+" from test"},__decorate([l.attributes.property(String),__metadata("design:type",String)],r.prototype,"Path",void 0),__decorate([l.attributes.property(Array,0),__metadata("design:type",Array)],r.prototype,"Number",void 0),r}(l.UI.TControl);n.ImageCapture=r}(it=t.media||(t.media={})),function(n){var t=function(){function n(){this.Quee=new nt({Invoke:this.OnDataAvaible,Owner:this})}return n.prototype.OnDataAvaible=function(n){this.syncAr=n;this.Upload(n)},n.prototype.Upload=function(n){var t=new FileReader;t.addEventListener("loadend",function(n){var t=n.target.result});t.readAsArrayBuffer(n.data)},n}();n.FileUploader=t}(ut=t.IO||(t.IO={}))});define("Desktop/Admin/Agents",["require","exports","../../lib/Q/sys/UI","abstract/extra/Common","../../lib/Q/sys/corelib","Idea/FileManager"],function(n,t,i,r,u,f){"use strict";var e,o,s;Object.defineProperty(t,"__esModule",{value:!0});r.GetVars(function(n){return e=n,!1});o=function(n){function t(){var t=n.call(this,"agents_info","Agents")||this;return t.Title="Agents",t}return __extends(t,n),Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.NoSearch},set:function(){},enumerable:!0,configurable:!0}),t.prototype.Update=function(){e.apis.Agent.SmartUpdate()},t.prototype.OnKeyDown=function(t){if(!this.adapter.OnKeyDown(t))if(t.keyCode===i.UI.Keys.F1)this.getHelp({Enter:"Edit",Suppr:"Delete",F2:"Add New"});else if(t.keyCode===i.UI.Keys.F2)e.apis.Agent.CreateNew(function(n){n.Error!==u.basic.DataStat.Success?i.UI.InfoArea.push("The "+n.Data.toString()+" not Saved"):i.UI.InfoArea.push("The "+n.Data.toString()+" successfully created")});else if(this.adapter.SelectedIndex!=-1)if(t.keyCode===13)e.apis.Agent.Edit(this.adapter.SelectedItem,function(n){n.Error!==u.basic.DataStat.Success?i.UI.InfoArea.push("The "+n.Data.toString()+" not Saved"):i.UI.InfoArea.push("The "+n.Data.toString()+" successfully Saved")});else if(t.keyCode===i.UI.Keys.Delete)e.apis.Agent.Delete(this.adapter.SelectedItem,null);else return n.prototype.OnKeyDown.call(this,t);else return n.prototype.OnKeyDown.call(this,t);return t.stopPropagation(),t.preventDefault(),!0},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.adapter=new i.UI.ListAdapter("Agents.table");this.adapter.AcceptNullValue=!1;this.Add(this.adapter);this.adapter.OnInitialized=function(n){return n.Source=e.__data.Agents}},t.prototype.GetLeftBar=function(){var t=this;if(!this.lb){var n=new i.UI.Navbar,r=new i.UI.Glyph(i.UI.Glyphs.plusSign,!1,"Add"),u=new i.UI.Glyph(i.UI.Glyphs.edit,!1,"Edit"),f=new i.UI.Glyph(i.UI.Glyphs.fire,!1,"Remove"),e=n.getTemplate;n.getTemplate=function(n){var r=e(new i.UI.Anchore(n));return n.Enable===!1?r.Enable=!1:r.addEventListener("click",t.handleSerices,{t:t,c:n.Type}),r};n.OnInitialized=function(n){return n.AddRange([r,u,f])};this.lb=n}return this.lb},t.prototype.handleSerices=function(n,t,r){var u=i.UI.Glyphs;switch(r.c){case u.plusSign:return e.apis.Agent.CreateNew();case u.edit:return e.apis.Agent.Edit(r.t.adapter.SelectedItem,null);case u.fire:return e.apis.Agent.Delete(r.t.adapter.SelectedItem,null)}},t}(i.UI.NavPanel);t.Agents=o;s=function(n){function t(){var t=n.call(this,"statistics_panel","Statistiques")||this;return t.Title="Statistiques",t}return __extends(t,n),t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Add(this._content=new f.StatView)},t}(i.UI.NavPanel);t.StatisticsPanel=s});define("Desktop/Admin/Command",["require","exports","../../lib/Q/sys/UI","abstract/Models","assets/data/data","../../lib/q/components/HeavyTable/script","abstract/extra/Common","../../lib/Q/sys/corelib","Componenets/Forms","Componenets/PStat"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c,l;Object.defineProperty(t,"__esModule",{value:!0});e.GetVars(function(n){return c=clone(n),!1}),function(n){var t=function(n){function t(){var t=n.call(this,"Command","Command")||this;return t.x=new i.UI.Modals.EModalEditer("templates.carticleedit",!1),t}return __extends(t,n),t.prototype._hasValue_=function(){return!0},t.prototype.initialize=function(){var r=this,t,e;n.prototype.initialize.call(this);o.Api.RiseApi("loadFournisseurs",void 0);t=this.adapter=new f.Material.HeavyTable(u.data.value.CommandDef.def).applyStyle("fitHeight");this.Add(this.adapter=t);this.Update();e=this.x.OnKeyDown;this.x.pressKey=function(n,t,i){n.keyCode==116&&(n.preventDefault(),n.stopImmediatePropagation(),n.stopPropagation(),r.GetLastArticlePrice(i.Value))};i.UI.Desktop.Current.KeyCombiner.On("S","R",function(n){var i=this,t;n.Cancel=!0;t=h.Statistique.Views.ListOfFakePrices.OpenQuery();t.OnInitialized=function(n){return n.SelectedProduct=i.adapter.SelectedItem.Product}},this,this)},t.prototype.OnKeyDown=function(t){if(this.Value.IsOpen){if(t.keyCode==13)return this.NewArticle();if(t.keyCode==113)return this.EditArticle();if(t.keyCode==46)return this.DeleteArticle(this.adapter.SelectedItem)}var i=this.adapter.OnKeyDown(t);return i?i:n.prototype.OnKeyDown.call(this,t)},t.prototype.OpenInfo=function(n,t,i){var u=h.Statistique.Views.ListOfFakePrices.Default,r=i.Value;this.GetLastArticlePrice(r)},t.prototype.GetLastArticlePrice=function(n){o.Api.RiseApi("getLastArticlePrice",{data:{Dealer:undefined,Product:n.Product,Before:new Date(Date.now()+2231536e6),IsAchat:!0,asRecord:!0},callback:function(t,i){i?(n.Price=i.PSel||n.Product.PSel,n.Fournisseur=c.__data.Fournisseurs.GetById(i.Facture.Fournisseur),n.Qte||(n.Qte=i.Qte)):c.apis.Fournisseur.Select(function(t){t.Error==o.basic.DataStat.Success&&(n.Fournisseur=t.Data)})}})},t.prototype.NewArticle=function(){var n=this,t=function(u){n._editArticle(u,function(f,e){if(e.E.Result==i.UI.MessageResult.ok){if(u.Label==null||u.Label.trim()==""){e.E.StayOpen();return}c.requester.Request(r.models.CArticle,"SAVE",u,void 0,function(i,r,f){f?(n.adapter.Source.Add(u),n.adapter.SelectedItem=u):t(u)})}})};o.basic.GuidManager.New(function(i){var u=new r.models.CArticle(i);u.Product=null;u.Fournisseur=null;u.Command=n.Value;t(u)},null)},t.prototype.EditArticle=function(){var n=this.adapter.SelectedItem;n&&this._editArticle(n,function(t,u){u.E.Result==i.UI.MessageResult.ok&&c.requester.Request(r.models.CArticle,"SAVE",n,void 0,function(n,t,r){r||i.UI.InfoArea.push("UnExpected Error")})})},t.prototype._editArticle=function(n,t){this.x.edit(n,!1,t,this.Value.IsOpen)},t.prototype.DeleteArticle=function(n){var t=this;c.requester.Request(r.models.CArticle,"DELETE",void 0,{Id:n.Id},function(i,r,u){u&&t.adapter.Source.Remove(n)})},t.prototype.Update=function(){var n=this;this.Value||(this.Value=new r.models.Command(o.basic.New()),this.adapter.Source=this.Value.Articles);c.requester.Request(r.models.Command,"UPDATEDC",this.Value,void 0,function(){c.requester.Request(r.models.CArticles,"UPDATEDC",n.adapter.Source,void 0,function(){})})},Object.defineProperty(t.prototype,"Source",{get:function(){return this.adapter.getScop().Value},enumerable:!0,configurable:!0}),t.prototype.OnPrint=function(){c.requester.Request(r.models.Command,"PRINT",{},void 0,function(n,t){if(t.Response&&t.Response.Success){var i=__global.ApiServer.Combine("/_/$?Id="+t.Response.FileName).FullPath;s.Forms.PDFViewer.Show(i)}})},t}(i.UI.NavPanel);n.Command=t}(l=t.views||(t.views={}));o.bind.Register({Name:"loadCArticle",OnInitialize:function(){},Todo:function(n,t){var i=n.Scop.getParent().Value,r=t?t._new:i.Product;r&&o.Api.RiseApi("getLastArticlePrice",{data:{Dealer:undefined,Product:r,Before:new Date(Date.now()+3333333333333333333),IsAchat:!0,asRecord:!0},callback:function(n,t){t&&(i.Price=t.PSel||r.PSel,i.Fournisseur=c.__data.Fournisseurs.GetById(t.Facture.Fournisseur),i.Qte||(i.Qte=t.Qte))}})}})});define("Desktop/Services/QServices",["require","exports","../../lib/Q/sys/UI","abstract/Models","abstract/extra/Common"],function(n,t,i,r,u){"use strict";var f,e;Object.defineProperty(t,"__esModule",{value:!0});u.GetVars(function(n){return f=n,!1}),function(n){function t(n){this.s&&this.s.Callback(n.Source)}function u(n,t){var i=document.createElement("sapn");return i.classList.add("glyphicon","bgr","glyphicon-"+n),i.title=t,i}var l=function(n){function r(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(r,n),r.prototype.initialize=function(){n.prototype.initialize.call(this);this.Items.Add(new i.UI.CItem("add","Add","#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("modify","Modify","#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("remove","Remove","#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("suggest","Suggests","#",this.OnItemSelectedDlgt))},r.prototype.ApplyTo=function(n){this.s=n},r}(i.UI.Navbar),e,o,s,h,c;n.SearchServices=l;e=function(n){function r(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(r,n),r.prototype.initialize=function(){n.prototype.initialize.call(this);this.OnItemSelected=this.OnItemSelected;this.Items.Add(new i.UI.CItem("save",u("save","Save"),"#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("refresh",u("refresh","Refresh"),"#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("check",u("check","Validate"),"#",this.OnItemSelectedDlgt))},r.prototype.OnItemSelected=function(n){this.s&&this.s.Callback(n.Source)},r.prototype.ApplyTo=function(n){this.s=n},r}(i.UI.Navbar);n.RFactureServices=e;o=function(n){function u(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(u,n),u.prototype.initialize=function(){var u=this,t,e;n.prototype.initialize.call(this);this.Items.Add(new i.UI.CItem("add",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.edit,"Add Products"),"#",this.OnItemSelectedDlgt));f.user.OnMessage(function(n,t){e(t._new)});e=function(n){n&&f.requester.Push(r.models.IsAdmin,new r.models.IsAdmin,null,function(n,r,f){if(f)t=t||new i.UI.CItem("select",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.user,"Select Client"),"#",u.OnItemSelectedDlgt),u.Items.IndexOf(t)==-1&&u.Items.Insert(1,t);else{if(!t)return;var e;(e=u.Items.IndexOf(t))!==-1&&u.Items.RemoveAt(e)}})};e(f.user.IsLogged);this.Items.Add(new i.UI.CItem("delete",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.fire,"Delete This Facture"),"#",this.OnItemSelectedDlgt))},u.prototype.ApplyTo=function(n){this.s=n},u}(i.UI.Navbar);n.FactureService=o;s=function(n){function i(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(i,n),i.prototype.initialize=function(){n.prototype.initialize.call(this)},i.prototype.ApplyTo=function(n){return this.s=n,this},i}(i.UI.Navbar);n.CostumersService=s;h=function(n){function r(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(r,n),r.prototype.initialize=function(){n.prototype.initialize.call(this);this.Items.Add(new i.UI.CItem("select",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.shareAlt,"Open this Facture","bgr"),"#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("new",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.plusSign,"Ceate New Facture "),"#",this.OnItemSelectedDlgt))},r.prototype.ApplyTo=function(n){this.s=n},r}(i.UI.Navbar);n.FacturesService=h;c=function(n){function r(){var i=n.call(this)||this;return i.OnItemSelectedDlgt={Invoke:t,Owner:i},i}return __extends(r,n),r.prototype.initialize=function(){n.prototype.initialize.call(this);this.Items.Add(new i.UI.CItem("new",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.plusSign,"Create New Client"),"#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("edit",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.edit,"Edit"),"#",this.OnItemSelectedDlgt));this.Items.Add(new i.UI.CItem("delete",i.UI.Glyph.CreateGlyphDom(i.UI.Glyphs.fire,"Delete"),"#",this.OnItemSelectedDlgt))},r.prototype.ApplyTo=function(n){this.s=n},r}(i.UI.Navbar);n.MyClientsService=c}(e=t.Services||(t.Services={}))});define("Desktop/SMS",["require","exports","../lib/q/sys/UI","../lib/q/sys/Corelib","abstract/Models","abstract/extra/Common","Desktop/Services/QServices","abstract/extra/Basics","assets/data/data","../lib/q/components/HeavyTable/script","Idea/FileManager"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function a(n){return new r.utils.CostumeFilter(n)}var l,w,v,y,p;Object.defineProperty(t,"__esModule",{value:!0});f.GetVars(function(n){return l=n,!1});w=i.UI.help.createTemplate(s.data.value.smsTable.def);v=function(n){function t(t){function r(n){return(n=n.From)&&n.FullName||""}function u(n){return(n=n.To)&&n.FullName||""}function f(n){return(n=n.Date)&&n.getTime()||0}function e(n){return n.Title||""}function o(n){return n.Message||""}var i=n.call(this,s.data.value.smsTable.def)||this;return i.Source=t,i.View.style.overflowX="auto",i.setOrderHandler({Owner:i,Invoke:function(n){switch(n.orderBy){case"IsReaded":return i.Source.OrderBy(function(t,i){return n.state.factor*((i.IsReaded?1:0)-(t.IsReaded?1:0))});case"From":return i.Source.OrderBy(function(t,i){return n.state.factor*r(t).localeCompare(r(i))});case"To":return i.Source.OrderBy(function(t,i){return n.state.factor*u(t).localeCompare(u(i))});case"Date":return i.Source.OrderBy(function(t,i){return n.state.factor*(f(t)-f(i))});case"Title":return i.Source.OrderBy(function(t,i){return n.state.factor*e(t).localeCompare(e(i))});case"Message":i.Source.OrderBy(function(t,i){return n.state.factor*o(t).localeCompare(o(i))})}}}),i}return __extends(t,n),Object.defineProperty(t.prototype,"Paginator",{get:function(){return this._paginator?this._paginator:(this._paginator=i.UI.Paginator.createPaginator(this,this.Source),this._paginator)},enumerable:!0,configurable:!0}),t}(h.Material.HeavyTable);t.SMSsView=v;y=function(n){function t(){var i=n.call(this,"SMS","SMS")||this;if(i.allSMS=new u.models.SMSs("All Message","all"),i.fs=new e.Services.SearchServices,t.Default)throw new Error("this is SignleIton Class");return t.Default=i,i}return __extends(t,n),t.prototype.initializeVars=function(){this.converter={ConvertA2B:function(n,t,r){return new i.UI.TabControlItem(r.category,r)},ConvertB2A:function(n,t,i){return i.Content}};this.smsByCategory=new r.collection.List(u.models.SMSs);this.smssToTabItem=new r.collection.TransList(Object,this.converter);this.smssToTabItem.Source=this.smsByCategory;this._paginator=(this._smssView=new v(null)).Paginator;window.pg=this._paginator;this.smsTabControl=new i.UI.UniTabControl("smsTabControl","SMS Manager",this.smssToTabItem,this._paginator,function(n,t,i){return t.Input=i.Content,i.Title});this._smssView.AcceptNullValue=!1},t.prototype.getSuggessions=function(){return l.__data.Products},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.initializeVars();this.Add(this.smsTabControl);this.smsTabControl.OnTabClosed.On=function(n){n.Cancel=!0};this.initializeTabs()},t.prototype.initializeTabs=function(){function f(f,e){var s=t.allSMS,o,h,c;f?(o=function(n){return n&&n.Id},h=o(e),n||(n=s.Filtred(a(function(n,t){return!t.IsReaded&&o(t.To)===h})),n.category="InBox Unreaded",n.Tag="NonReaded",i=s.Filtred(a(function(n,t){return t.IsReaded&&o(t.To)===h})),i.category="InBox Readed",i.Tag="Readed",r=s.Filtred(a(function(n,t){return!t.IsReaded&&o(t.From)===h})),r.category="OutBox Non Readed",r.Tag="SendedNonReaded",u=s.Filtred(a(function(n,t){return t.IsReaded&&o(t.From)===h})),u.category="OutBox Readed",u.Tag="Sended",c=[n,r,i,u,s],t.smsByCategory.AddRange(c)),l.apis.Sms.Update(t.allSMS)):t.allSMS.Clear()}var n,i,r,u,t;l.user.OnMessage(function(n,t){f(t._new,t.__this.Client)});l.apis.Client.GetMyId(function(n){f(l.user.IsLogged,n.Data)});t=this},t.prototype.OnKeyDown=function(n){return n.keyCode==i.UI.Keys.F2?(this.addNewSMS(),!0):(n.keyCode===i.UI.Keys.Enter?this.showSMS():n.keyCode===i.UI.Keys.Delete&&this.deleteSMS(),this.smsTabControl.OnKeyDown(n))},t.prototype.deleteSMS=function(){var n=this._smssView.SelectedItem,t=this._paginator.Input;n&&l.apis.Sms.Delete(n,function(n){var i=n.Data;n.Error===o.basics.DataStat.Success&&t.Remove(i)})},t.prototype.showSMS=function(){var n=this._smssView.SelectedItem;n&&l.apis.Sms.EditData.edit(n,!1,function(n,t){var f=t.Data;t.Data.Rollback(t.BackupData);t.CommitOrBackupHandled=!0;f.IsReaded||t.E.Result!=i.UI.MessageResult.ok||l.requester.Request(u.models.SMS,r.net.WebRequestMethod.Post,void 0,{Id:t.Data.Id,MakeReaded:!0},function(n,i,r){r&&(t.Data.IsReaded=!0)})},!0)},t.prototype.addNewSMS=function(){var n=this,t=new Date;t.toLocaleString();l.apis.Sms.CreateNew(function(t){if(t.Error===o.basics.DataStat.Success){n.allSMS.Add(t.Data);var r=t.Data.To;i.UI.Modal.ShowDialog("Success","Votre message a "+(r&&r.FullName)+" est bien envoyer",void 0,"OK",null,null)}})},t.prototype.OnSearche=function(){},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},enumerable:!0,configurable:!0}),t.prototype.GetLeftBar=function(){return null},t.prototype.Update=function(){var n=this,t=this.smsTabControl.SelectedItem.Content;if(t===this.allSMS)return l.apis.Sms.Update(this.allSMS);i.UI.Modal.ShowDialog("","Do you want to update all sms",function(t){switch(t.Result){case i.UI.MessageResult.ok:return l.apis.Sms.Update(n.allSMS);case i.UI.MessageResult.cancel:var r=n.smsTabControl.SelectedItem.Content;l.apis.Sms.Update(r,r.Tag);return}},"Yes","No","Abort")},t}(i.UI.NavPanel);t.SMSPage=y;p=function(n){function t(){var t=n.call(this,"File Manager","Explorer")||this;return t.manager=new c.FileManager,t}return __extends(t,n),t.prototype.OnKeyDown=function(n){return this.manager.OnKeyDown(n)},t.prototype.initialize=function(){n.prototype.initialize.call(this);var t=new i.UI.Dom("text");this.Add(t);this.Add(this.manager)},t.prototype.Update=function(){this.manager.Update()},t.prototype.OnSearche=function(n,t){return this.manager.OnSearch(n,t)},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},enumerable:!0,configurable:!0}),t.prototype.OnContextMenu=function(t){return this.manager.OnContextMenu(t)||n.prototype.OnContextMenu.call(this,t)},t}(i.UI.NavPanel);t.FilePage=p});define("Desktop/AdminPage",["require","exports","../lib/q/sys/UI","../lib/q/sys/Corelib","abstract/Models","Desktop/Jobs","Desktop/Admin/ListOfFactures","Desktop/Admin/Costumers","Desktop/Admin/Fournisseurs","Desktop/Admin/Facture","Desktop/Admin/Logins","Desktop/Admin/Products","Desktop/Admin/Categories","Desktop/Admin/Revages","Desktop/Admin/Agents","Componenets/Forms","Desktop/Admin/Command","abstract/extra/Common","Desktop/SMS"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";var g,d,nt;Object.defineProperty(t,"__esModule",{value:!0});f.LoadJobs();g=r.bind.NamedScop.Get("UserAbonment");b.GetVars(function(n){return d=n,!1}),function(n){var b=function(n){function t(t){var i=n.call(this,t,"Administration","Administration")||this;return i.factureHistory=new g,i.sfactureHistory=new nt,i.ca=i.sfactureHistory,i.cv=i.factureHistory,i}return __extends(t,n),t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.Caption="";this.app.HideTopNavBar(!0);i.UI.Desktop.Current.KeyCombiner.On("O","T",function(){this.app.HideTopNavBar(!this.app.IsTopNavBarhidden())},void 0,this);i.UI.Desktop.Current.KeyCombiner.On("O","S",function(){this.initStat||(this.initStat=!0,this.SetSeparator(),this.SetPanel(new c.RegularUsers),this.SetPanel(new c.UnRegularUsers),this.SetSeparator(),this.SetPanel(new y.Agents),this.SetSeparator())},void 0,this);this.createPanel(new e.AdminNavs.FacturesLivraison,"CJ").createPanel(this.factureHistory.Control,"CB").createPanel(new o.Clients,"CL").createPanel(new v.Etats(!1),"CE").createPanel().createPanel(new e.AdminNavs.FacturesReciption,"FJ").createPanel(this.sfactureHistory.Control,"FB").createPanel(new s.Fournisseurs,"FL").createPanel(new v.Etats(!0),"FE").createPanel().createPanel(new l.ProductsNav,"SP").createPanel(new a.CategoryNav,"SC").createPanel(new w.views.Command,"SM").createPanel().createPanel(new y.StatisticsPanel).createPanel(new k.SMSPage).createPanel(new k.FilePage);r.bind.Register({Name:"openafacture",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",function(){var i=n.Scop.Value;t.cv.Open(i);t.factureHistory.Show(i);t.Select(t.factureHistory.Control.Name)})}});r.bind.Register({Name:"openasfacture",OnInitialize:function(n){n.addEventListener("dblclick","dblclick",function(){var i=n.Scop.Value;t.ca.Open(i);t.Select("facture_achat")})}});this.initAchatCmd();this.initVentsCmd();this.initVersmentCmd();this.initSVersmentCmd()},t.prototype.createPanel=function(n,t){return n==undefined?this.SetSeparator():(t&&t.length==2&&(t=t.toUpperCase(),i.UI.Desktop.Current.KeyCombiner.On(t[0],t[1],this._select,this,n),n.ToolTip="CTRL+"+t[0]+", CTRL+"+t[1]),this.SetPanel(n)),this},t.prototype._select=function(n,t){n.Cancel=!0;t.target.SelectedItem=t.Owner},t.prototype.initAchatCmd=function(){var n=this,t;r.Api.RegisterApiCallback({Name:"OpenSFacture",DoApiCallback:function(t,i,r){n.ca.Open(r.data);n.Select("facture_achat")},Owner:this});r.Api.RegisterApiCallback({Name:"SaveSFacture",DoApiCallback:function(n,t,u){var e=u.data,f=d.apis.SFacture;f.Check(e)&&f.Save(u.data,undefined,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1>Successfully<\/H1> Saved",!0);break;case r.basic.DataStat.DataCheckError:i.UI.InfoArea.push('Check your <h1 style="color:yellow">Data<\/h1>  of <h2 style="color:red">Facture<\/h2> <br> UnSaved',!1);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}})},Owner:this});r.Api.RegisterApiCallback({Name:"DeleteSFacture",DoApiCallback:function(n,t,u){i.UI.Modal.ShowDialog("Confirmation","Do you want realy to delete this facture",function(n){if(n.Result===i.UI.MessageResult.ok){var t=d.apis.SFacture;t.Delete(!0,u.data,function(n,t,u){u==r.basic.DataStat.Success?i.UI.InfoArea.push("The Facture Successfully Deleted"):i.UI.InfoArea.push("An Error Happened When deleting The Facture")})}},"DELETE","CANCEL")},Owner:this});r.Api.RegisterApiCallback({Name:"NewSFacture",DoApiCallback:function(i,r,u){t||(t=new p.Forms.InitSFacture);var e=d.apis.SFacture,f=function(t,i){(u.callback&&u.callback(u,t),i)&&(d.__data.SFactures.Add(t),n.ca.Open(t),n.Select("facture_achat"))};t.Show(f)},Owner:this});r.Api.RegisterApiCallback({Name:"UpdateSFacture",DoApiCallback:function(n,t,r){var u=r.data;u||i.UI.InfoArea.push("Please . Select one facture");u.IsOpen?i.UI.Modal.ShowDialog("Confirmation","This Facture IsOpened .If You Update It You Will loss all changes data<br> Do you wand realy to Update it",function(n){n.Result===i.UI.MessageResult.ok&&d.apis.SFacture.Update(u)},"Update"):d.apis.SFacture.Update(u)},Owner:this});r.Api.RegisterApiCallback({Name:"ValidateSFacture",DoApiCallback:function(n,t,u){var e=u.data,f=d.apis.SFacture;f.Check(e)&&f.Validate(u.data,undefined,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1>Successfully<\/H1> Validated",!0);break;case r.basic.DataStat.DataCheckError:i.UI.InfoArea.push('Check your <h1 style="color:yellow">Data<\/h1>  of <h2 style="color:red">Facture<\/h2> <br> UnValidated',!1);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}})},Owner:this});r.Api.RegisterApiCallback({Name:"PrintSFacture",DoApiCallback:function(n,t,u){var f=u.data,e=d.apis.SFacture;e.Check(f)&&(f.IsOpen?i.UI.InfoArea.push("We annot print The Facture While It's open"):e.Print(u.data,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1> Is Printing Successfully<\/H1> Saved",!0);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}}))},Owner:this})},t.prototype.initVentsCmd=function(){var n=this,t;r.Api.RegisterApiCallback({Name:"OpenFacture",DoApiCallback:function(t,i,r){n.cv.Open(r.data);n.factureHistory.Show(r.data);n.Select(n.factureHistory.Control.Name)},Owner:this});r.Api.RegisterApiCallback({Name:"SaveFacture",DoApiCallback:function(n,t,u){var e=u.data,f=d.apis.Facture;f.Check(e)&&f.Save(u.data,undefined,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1>Successfully<\/H1> Saved",!0);break;case r.basic.DataStat.DataCheckError:i.UI.InfoArea.push('Check your <h1 style="color:yellow">Data<\/h1>  of <h2 style="color:red">Facture<\/h2> <br> UnSaved',!1);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}})},Owner:this});r.Api.RegisterApiCallback({Name:"DeleteFacture",DoApiCallback:function(n,t,u){i.UI.Modal.ShowDialog("Confirmation","Do you want realy to delete this facture",function(n){if(n.Result==i.UI.MessageResult.ok){var t=d.apis.Facture;t.Delete(!0,u.data,function(n,t,u){u==r.basic.DataStat.Success?i.UI.InfoArea.push("The Facture Successfully Deleted"):i.UI.InfoArea.push("An Error Happened When deleting The Facture")})}},"DELETE","CANCEL")},Owner:this});r.Api.RegisterApiCallback({Name:"NewFacture",DoApiCallback:function(i,r,u){var e=d.apis.Facture,f=function(t,i){i&&(d.__data.Factures.Add(t),u.callback&&u.callback(u,t),n.cv.Open(t),n.Select("facture_vent"))};t||(t=new p.Forms.InitFacture);t.Show(f)},Owner:this});r.Api.RegisterApiCallback({Name:"UpdateFacture",DoApiCallback:function(n,t,r){var u=r.data;u||i.UI.InfoArea.push("Please . Select one facture");u.IsOpen?i.UI.Modal.ShowDialog("Confirmation","This Facture IsOpened .If You Update It You Will loss all changes data<br> Do you wand realy to Update it",function(n){n.Result==i.UI.MessageResult.ok&&d.apis.Facture.Update(u)},"Update"):d.apis.Facture.Update(u)},Owner:this});r.Api.RegisterApiCallback({Name:"ValidateFacture",DoApiCallback:function(n,t,u){var e=u.data,f=d.apis.Facture;f.Check(e)&&f.Validate(u.data,undefined,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1>Successfully<\/H1> Validated",!0);break;case r.basic.DataStat.DataCheckError:i.UI.InfoArea.push('Check your <h1 style="color:yellow">Data<\/h1>  of <h2 style="color:red">Facture<\/h2> <br> UnValidated',!1);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}})},Owner:this});r.Api.RegisterApiCallback({Name:"PrintFacture",DoApiCallback:function(n,t,u){var f=u.data,e=d.apis.Facture;f.IsOpen?i.UI.InfoArea.push("We annot print The Facture While It's open"):e.Print(u.data,function(n,t,u){switch(u){case r.basic.DataStat.Success:i.UI.InfoArea.push("The Facture <h1> Is Printing Successfully<\/H1> Saved",!0);break;default:i.UI.InfoArea.push("UnExpected Error Occurred ",!1)}})},Owner:this})},t.prototype.initVersmentCmd=function(){r.Api.RegisterApiCallback({Name:"OpenVersment",DoApiCallback:function(n,t,i){d.apis.Versment.Edit(i.data)},Owner:this});r.Api.RegisterApiCallback({Name:"DeleteVersment",DoApiCallback:function(n,t,i){d.apis.Versment.Delete(i.data)},Owner:this});r.Api.RegisterApiCallback({Name:"NewVersment",DoApiCallback:function(n,t,i){d.apis.Versment.New(function(n){var t=n.Data;i&&i.data?(t.Client=i.data,d.apis.Versment.Edit(t,function(n){i.callback&&i.callback(i,n.Data)})):d.apis.Client.Select(function(n){var i=n.Data;i&&n.Error===r.basic.DataStat.Success&&(t.Client=i,d.apis.Versment.Edit(t))},null)})},Owner:this});r.Api.RegisterApiCallback({Name:"UpdateVersments",DoApiCallback:function(n,t,i){d.apis.Versment.Update(i.data)},Owner:this})},t.prototype.initSVersmentCmd=function(){r.Api.RegisterApiCallback({Name:"OpenSVersment",DoApiCallback:function(n,t,i){d.apis.SVersment.Edit(i.data)},Owner:this});r.Api.RegisterApiCallback({Name:"DeleteSVersment",DoApiCallback:function(n,t,i){d.apis.SVersment.Delete(i.data)},Owner:this});r.Api.RegisterApiCallback({Name:"NewSVersment",DoApiCallback:function(n,t,i){d.apis.SVersment.New(function(n){var t=n.Data;t.Fournisseur=i.data;d.apis.SVersment.Edit(t)})},Owner:this});r.Api.RegisterApiCallback({Name:"UpdateSVersments",DoApiCallback:function(n,t,i){d.apis.SVersment.Update(i.data)},Owner:this})},t.prototype.OnKeyDown=function(t){if(t.keyCode==112)i.UI.showSPTooltips(!r.basic.Settings.get("show-sp-tooltips"));else return n.prototype.OnKeyDown.call(this,t);return!0},t}(i.UI.NavPage),f;n.AdminPage=b;f=function(){function n(){}return n.initialize=function(){return new i.UI.TabControl("TabControl","Tab Control",[{Title:"Fournisseurs",Content:new s.Fournisseurs},{Title:"Clients",Content:new o.Clients},{Title:"Products",Content:new l.ProductsNav},])},n.initialize1=function(){var n=new h.FactureVent,u=new r.collection.TransList(i.UI.TabControlItem,new t,null),f;u.Source=d.__data.Factures;f=new i.UI.UniTabControl("UniTabControl","UniTab Control",u,n,function(t,i,r){var u=r.Content;return n.Open(u),r.Title=u.Client&&(u.Client.Name||u.Client.FullName)||u.Ref})},n}();n.Test=f;var t=function(){function n(){}return n.prototype.ConvertA2B=function(n,t,r,u){return new i.UI.TabControlItem(u.Client&&(u.Client.Name||u.Client.FullName)||u.Ref,r)},n.prototype.ConvertB2A=function(n,t,i){return i.Content},n}(),g=function(){function n(){var n=this;this.History=new r.collection.List(u.models.Facture);this.factureView=new h.FactureVent;this.transList=new r.collection.TransList(Object,new t,this);this.transList.Source=this.History;this.tabControl=new i.UI.UniTabControl("facture_vent","Bon Livraison",this.transList,this.factureView,this.OnItemSelected);this.tabControl.OnInitialized=function(){return n.OnLoad()};this.tabControl.OnTabClosed.Add(function(n){var t=n.Target.Content;n.Stat=="closing"&&t.IsOpen&&(i.UI.InfoArea.push("La facture "+t.Ref+" est ouvert. fermez la d'abord"),n.Cancel=!0)})}return n.prototype.translator=function(n,t,r){return new i.UI.TabControlItem(r.Client&&(r.Client.Name||r.Client.FullName)||r.Ref,r)},n.prototype.OnhistoryChanged=function(){r.basic.Settings.set("opened_factures",this.History.AsList().map(function(n){return n.Id}))},n.prototype.OnLoad=function(){var o=this,e=d.__data.Factures,u=r.basic.Settings.get("opened_factures"),s=this.tabControl.SelectedItem,n,t,f,i;if(u instanceof Array)for(n=0;n<u.length;n++)t=e.GetById(u[n]),t&&this.History.IndexOf(t)==-1&&this.History.Add(t);if(f=r.basic.Settings.get("opened_facture"),f&&s==null){if(i=e.GetById(f),i&&this.History.IndexOf(i)==-1)return;this.Show(i)}this.reloadTitles();this.History.Listen=function(){return o.OnhistoryChanged()}},n.prototype.reloadTitles=function(){var i=this.transList.AsList(),r=this.History.AsList(),t,n;if(r&&i)for(t=0;t<i.length;t++)(n=r[t],n)&&(i[t].Title=n.Client&&(n.Client.Name||n.Client.FullName)||n.Ref);this.transList.Get(0)},n.prototype.OnItemSelected=function(n,t,i){var u=i&&i.Content;return t.Open(u),r.basic.Settings.set("opened_facture",u.Id&&u.Id),i.Title=u.Client&&(u.Client.Name||u.Client.FullName)||u.Ref},n.prototype.Show=function(n){var i=this,t=this.History.IndexOf(n);t===-1&&(this.History.Add(n),t=this.History.Count-1);this.tabControl.IsInit?this.tabControl.SelectedItem=this.transList.Get(t):this.tabControl.OnInitialized=function(n){return n.SelectedItem=i.transList.Get(t)}},Object.defineProperty(n.prototype,"Control",{get:function(){return this.tabControl},enumerable:!0,configurable:!0}),n.prototype.Open=function(n){this.Show(n)},n}(),nt=function(){function n(){var n=this;this.History=new r.collection.List(u.models.SFacture);this.factureView=new h.FactureAchat;this.transList=new r.collection.TransList(Object,new t,this);this.transList.Source=this.History;this.tabControl=new i.UI.UniTabControl("facture_achat","Bon Réception",this.transList,this.factureView,this.OnItemSelected);this.tabControl.OnInitialized=function(){return n.OnLoad()};this.tabControl.OnTabClosed.Add(function(n){var t=n.Target.Content;n.Stat=="closing"&&t.IsOpen&&(i.UI.InfoArea.push("La facture "+t.Ref+" est ouvert. fermez la d'abord"),n.Cancel=!0)})}return n.prototype.translator=function(n,t,r){return new i.UI.TabControlItem(r.Fournisseur&&(r.Fournisseur.Name||r.Fournisseur.Tel)||r.Ref,r)},n.prototype.OnhistoryChanged=function(){r.basic.Settings.set("opened_sfactures",this.History.AsList().map(function(n){return n.Id}))},n.prototype.OnLoad=function(){var o=this,e=d.__data.SFactures,u=r.basic.Settings.get("opened_sfactures"),s=this.tabControl.SelectedItem,n,t,f,i;if(u instanceof Array)for(n=0;n<u.length;n++)t=e.GetById(u[n]),t&&this.History.IndexOf(t)==-1&&this.History.Add(t);if(f=r.basic.Settings.get("opened_sfacture"),f&&s){if(i=e.GetById(f),i&&this.History.IndexOf(i)==-1)return;this.Show(i)}this.reloadTitles();this.History.Listen=function(){return o.OnhistoryChanged()}},n.prototype.reloadTitles=function(){var i=this.transList.AsList(),r=this.History.AsList(),t,n;if(r&&i)for(t=0;t<i.length;t++)(n=r[t],n)&&(i[t].Title=n.Fournisseur&&(n.Fournisseur.Name||n.Fournisseur.Tel)||n.Ref);this.transList.Get(0)},n.prototype.OnItemSelected=function(n,t,i){var u=i&&i.Content;return t.Open(u),r.basic.Settings.set("opened_sfacture",u.Id&&u.Id),i.Title=u.Fournisseur&&(u.Fournisseur.Name||u.Fournisseur.Tel)||u.Ref},n.prototype.Open=function(n){this.Show(n)},n.prototype.Show=function(n){var t=this.History.IndexOf(n),i;t===-1&&(this.History.Add(n),t=this.History.Count-1);this.tabControl.IsInit?this.tabControl.SelectedItem=this.transList.Get(t):(i=this.transList.Get(t),this.tabControl.OnInitialized=function(n){return n.SelectedItem=i})},Object.defineProperty(n.prototype,"Control",{get:function(){return this.tabControl},enumerable:!0,configurable:!0}),n}()}(nt=t.Admin||(t.Admin={}))});define("Desktop/Pages",["require","exports","../lib/q/sys/UI","../lib/q/sys/Corelib","abstract/extra/Common","../lib/q/sys/Filters","Desktop/Services/QServices","abstract/extra/Basics","Desktop/Search"],function(n,t,i,r,u,f,e,o,s){"use strict";var c,l,h,a;Object.defineProperty(t,"__esModule",{value:!0});l=new r.bind.EventListener(c=Math.random()*2099837662);u.GetVars(function(n){return h=n,!1}),function(n){var t=function(n){function t(t){var i=n.call(this,t,"Recherche","Search")||this;return i.fs=new e.Services.SearchServices,i}return __extends(t,n),t.prototype.getSuggessions=function(){return h.__data.Products},t.prototype.initialize=function(){var t=this;n.prototype.initialize.call(this);this.paginator=new i.UI.Paginator(60);this.paginator.OnInitialized=function(){(t.pstore=new i.UI.ListAdapter("Products.card",window.outerWidth<768?"Product.DynCard1":"Product.card")).OnInitialized=function(n){n.Source=t.paginationList=r.collection.ExList.New(t.searchList=r.collection.ExList.New(h.__data.Products,new f.filters.list.StringFilter),t.paginator.Filter);t.paginator.BindMaxToSourceCount(t.searchList)};t.paginator.Content=t.pstore};this.Add(this.paginator)},t.prototype.OnKeyDown=function(t){var u=this;switch(t.keyCode){case i.UI.Keys.Left:if(t.ctrlKey)this.paginator.Previous();else return this.pstore.SelectedIndex--,!0;break;case i.UI.Keys.Right:if(t.ctrlKey)this.paginator.Next();else return this.pstore.SelectedIndex++,!0;break;case i.UI.Keys.Home:if(t.ctrlKey){this.paginator.paginator.Index=0;break}return n.prototype.OnKeyDown.call(this,t);case i.UI.Keys.End:if(t.ctrlKey){this.paginator.paginator.Index=1e6;break}return n.prototype.OnKeyDown.call(this,t);case i.UI.Keys.Enter:return i.UI.InfoArea.push("L'option n'est pas disponiple en Verssion  d'essayer"),!0;default:return n.prototype.OnKeyDown.call(this,t)}return r.UIDispatcher.OnIdle(function(){u.pstore.SelectedIndex=0}),t.preventDefault(),t.stopImmediatePropagation(),!0},t.prototype.OnSearche=function(n,t){this.HasSearch;this.searchList.Filter.Patent=new f.filters.list.StringPatent(t)},Object.defineProperty(t.prototype,"HasSearch",{get:function(){return i.UI.SearchActionMode.Instantany},enumerable:!0,configurable:!0}),t.prototype.GetLeftBar=function(){return null},t.prototype.Update=function(){h.apis.Product.SmartUpdate()},t.prototype.Callback=function(){},t.prototype.Handled=function(){return!0},t.prototype.OnDeepSearche=function(){var n=this;this._deepSearch||(this._deepSearch=new s.SearchData.Product);this._deepSearch.Open(function(){var t=n.searchList.Filter,i=t==n._deepSearch;n.searchList.Filter=n._deepSearch;i&&n.searchList.Reset()})},t}(i.UI.Page);n.SearchPage=t}(a=t.Pages||(t.Pages={}))});define("Desktop/Apps",["require","exports","../lib/Q/sys/Corelib","../lib/q/sys/UI","../lib/q/sys/System","abstract/Models","abstract/extra/Common","Desktop/AdminPage","Desktop/Pages","abstract/QShopApis","abstract/extra/Common","abstract/Services","Apps/Login","../lib/Q/sys/db","abstract/extra/ShopApis"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function d(){var n=new y.ShopApis;n.Init(p);p.requester.Get(i.basic.iGuid,[],null,function(){});p.requester.Get(i.basic.SessionId,{},null,function(n,t){i.basic.SessionId.parse(t)});i.Api.RegisterTrigger({Name:"AddPrice",Filter:function(){return!1},CheckAccess:function(){return!0},Params:null});i.Api.RegisterApiCallback({DoApiCallback:function(){return!0},Name:"AddPrice"});i.Api.RegisterApiCallback({DoApiCallback:function(){return!0},Name:"RemovePrice"});i.Api.RegisterTrigger({Name:"RemovePrice",Filter:function(){return!1},CheckAccess:function(){return!0},Params:null})}var p,w,k,b;Object.defineProperty(t,"__esModule",{value:!0});h.Apis.Load();c.InitModule();e.GetVars(function(n){return p=n,!1}),function(n){var t=function(n){function t(){var t=n.call(this,"QShop")||this;return i.Api.RegisterApiCallback({Name:"Settings",DoApiCallback:function(n,i,u){r.UI.Modal.ShowDialog("Settings","Do you want realy to make backup to this Shop",function(n){n.Result==r.UI.MessageResult.ok?(p.requester.Request(Window,"START"),setTimeout(function(){p.requester.Request(Window,"BACKUP");setTimeout(function(){u.callback&&u.callback(u,t)},6e3)},5e3)):u.callback&&u.callback(u,t)},"Backup","Cancel")}}),envirenment.isChromeApp||window.addEventListener("beforeunload",window.onbeforeunload=function(){return"Merci de ne pas quitter la page!"},{capture:!0,passive:!0}),t}return __extends(t,n),t.prototype.Update=function(){this.SelectedPage.Update()},t.prototype.initialize=function(){function h(n){n?o.Admin&&o.Admin.AdminPage&&p.requester.Push(f.models.IsAdmin,new f.models.IsAdmin,null,function(n,r,f){var h=i.basic.Settings.get("selectedPage"),s;f?t||(u.Add(t=new o.Admin.AdminPage(u)),s=t,s=t):t!=null&&u.Remove(t);e.OpenPage(h)||(e.SelectedPage=s)}):clearInterval(l)}var c=this,t,u,l,e;n.prototype.initialize.call(this);this.Add(this.Search=new s.Pages.SearchPage(this));this.Head.Header.Brand.addEventListener("click",function(){i.Api.RiseApi("ReAuth",{callback:function(){},data:c})},this);p.user.OnMessage(function(n,t){h(t._new)});p.user.IsLogged?h(!0):h(!1);u=this;e=this;this.OnPropertyChanged(r.UI.Layout.DPSelectedPage,function(n,t){t._new&&i.basic.Settings.set("selectedPage",t._new.Name)});i.Notification.on("UserSetting.selectedPageChanged",{callback:function(n,t,i){this.OpenPage(i._new)},owner:this});Window.Ntf=i.Notification},t}(r.UI.App);n.QShop=t}(w||(w={})),function(n){function t(n){var t=new w.QShop,r=new a.Apps.AuthentificationApp(t);n.Add(r);n.Add(t);i.thread.Dispatcher.call(r,t.Show)}n.Main=t}(k=t.Init||(t.Init={})),function(n){l.eServices.registerUpdater({ops:[],Name:"products",del:function(n){var t=f.models.Product.getById(n)||p.__data.Products.GetById(n);f.models.Product.pStore.Remove(n);t&&(p.__data.Products.Remove(t),typeof __LOCALSAVE__!="undefined"&&this.ops.push({op:v.db.Operation.Delete,row:t}))},edit:function(n,t,r){var e=f.models.Product.getById(n)||p.__data.Products.GetById(n);e?(e.Stat=u.sdata.DataStat.Updating,e.FromJson(t,i.encoding.SerializationContext.GlobalContext,!0),e.Stat=u.sdata.DataStat.Updated,typeof __LOCALSAVE__!="undefined"&&this.ops.push({op:v.db.Operation.Update,row:e})):(e=new f.models.Product(n),e.FromJson(t,r),p.__data.Products.Add(e),typeof __LOCALSAVE__!="undefined"&&this.ops.push({op:v.db.Operation.Insert,row:e}))},onfinish:function(){var n=this;typeof __LOCALSAVE__!="undefined"&&p.db.Get("Products").table.ExecuteOperations(this.ops,function(t){t&&p.db.MakeUpdate("Products",n.date)})},onstart:function(n){this.date=n&&n.date&&new Date(n.date)||new Date(0)},add:function(){}});var t=function(){function n(n,t){this.table=n;this.Name=t}return n.prototype.del=function(n){var t=u.sdata.DataRow.getById(n,this.table.ArgType)||this.table.GetById(n);t&&(this.table.Remove(t),t.Dispose())},n.prototype.edit=function(n,t,i){var r=u.sdata.DataRow.getById(n,this.table.ArgType)||this.table.GetById(n);r?(r.Stat=u.sdata.DataStat.Updating,r.FromJson(t,i,!0),r.Stat=u.sdata.DataStat.Updated):(r=this.table.CreateNewItem(n),r.FromJson(t,i,!1),this.table.Add(r))},n}();n.updater=t;l.eServices.registerUpdater(new t(p.__data.Costumers,"clients"));l.eServices.registerUpdater(new t(p.__data.Agents,"agents"));l.eServices.registerUpdater(new t(p.__data.Factures,"factures"));l.eServices.registerUpdater(new t(p.__data.SFactures,"sfactures"));l.eServices.registerUpdater(new t(p.__data.Categories,"categories"));l.eServices.registerUpdater(new t(p.__data.Fournisseurs,"fournisseurs"))}(b||(b={}));i.Api.RegisterApiCallback({Name:"log",DoApiCallback:function(){var n=document.location.pathname;n.lastIndexOf("/")!=n.length-1&&(n+="/");console.log("%c","color:White; background:url('"+(document.location.origin+n)+"_/Picture/logo');")}});d()});define("Desktop/ModelsViews",["require","exports","../lib/q/sys/Corelib","abstract/Models","../lib/q/sys/UI","template|../assets/templates/Templates.html","template|../assets/templates/AdminTemplates.html"],function(n,t,i,r,u,f,e){"use strict";function v(){s.getDescriptor("Article",r.models.Article).Add(new c);s.getDescriptor("Article",r.models.Article).Add(new c).Add(new g);s.getDescriptor("RegUser",r.models.Login).Add(new y);s.getDescriptor("UnRegUser",r.models.Login).Add(new p);s.getDescriptor("Factures",r.models.Factures).Add(new b);s.getDescriptor("Mail",r.models.Mail).Add(new w);s.getDescriptor("Product",r.models.Product).Add(new d);s.getDescriptor("Category",r.models.Category).Add(new it);s.getDescriptor("Price",r.models.FakePrice).Add(new tt);s.getDescriptor("FProduct",r.models.FakePrice).Add(new nt);s.getDescriptor("SFacture",r.models.SFacture).Add(new k);s.getDescriptor("Agents",r.models.Agents).Add(new rt)}function o(n,t,i,r,u,f,e){var o,h,c,s;if(o=typeof n=="string"?document.createElement(n):n,t&&o.setAttribute("db-bind",t),i&&o.setAttribute("db-job",i),r!=undefined&&o.setAttribute("db-twoway",r),u)for(h in u)o.setAttribute(h,u[h]);if(f)for(c in f)o.style[c]=f[c];if(e)for(s=0;s<e.length;s++)o.appendChild(e[s]);return o}var l=this,s,a,h;Object.defineProperty(t,"__esModule",{value:!0});ValidateImport(f,e);s=i.mvc.Initializer.Instances;a=s.System;t.Init=v;i.bind.Register({Name:"checkok",OnInitialize:h=function(n){n.Scop.Value?n.dom.classList.add("glyphicon","glyphicon-ok"):n.dom.classList.remove("glyphicon-ok")},Todo:h});i.bind.Register({Name:"openmail",OnInitialize:h=function(n){n.addEventListener("onclick","dblclick",{handleEvent:function(){var t=n.Scop.Value;t&&u.UI.Modal.ShowDialog(t.Subject,t.Body,undefined,"Close",null)},Owner:l})},Todo:h});i.bind.Register({Name:"tostring",OnInitialize:h=function(n){var t=n.Scop.Value||"";typeof t!="string"&&(t=t&&t.toString()||"");t.length>45&&(t=t.substring(0,45)+"...");n.dom.textContent=t},Todo:h});var c=function(n){function t(){var r=n.call(this,"cart")||this,t=document.createElement("tr"),u=document.createElement("td");t.setAttribute("scope","row");var f=o(document.createElement("td"),"Product.Name","label"),e=o(document.createElement("td"),"Count","label"),s=o(document.createElement("td"),"Price","price"),i=document.createElement("td");return i.innerHTML='<h4 class="pull-right activeShadow glyphicon glyphicon-open" style="margin-left:5px;margin-right:5px" db-job="art-add"><\/h4><h4 class="pull-right activeShadow glyphicon glyphicon-plus-sign" style="margin-left:5px;margin-right:5px" db-job="art-plus"><\/h4>    <h4 class="pull-right glyphicon fa-book glyphicon-minus-sign" style="margin-left: 5px; margin-right: 5px" db-job="art-minus"><\/h4>    <h4 class="pull-right glyphicon fa-book glyphicon-remove-circle" style="margin-left: 5px; margin-right: 5px" db-job="art-remove"><\/h4><span db-job="showIf" db-bind="$modify" />',i.style.maxWidth="100px",t.appendChild(u),t.appendChild(f),t.appendChild(e),t.appendChild(s),t.appendChild(i),r._Shadow=t,r}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),y=function(n){function t(){var u=n.call(this,"row")||this,i=document.createElement("tr"),f,r,t;for(i.setAttribute("scope","row"),r=[o(document.createElement("td"),"Username","label",!1),o(document.createElement("td"),"Client.FullName","label",!1),o(document.createElement("td"),"Client.Tel","label",!1),o(document.createElement("td"),"Client.Email","label",!1),o(document.createElement("td"),"Client.Job","label",!1),o(f=document.createElement("td"),undefined,undefined),],f.innerHTML='<span class="pull-right activeShadow glyphicon glyphicon-check" style="margin-left:5px;margin-right:5px" db-job="validateuser"><\/span><span class="pull-right glyphicon glyphicon-fire" style="margin-left: 5px; margin-right: 5px" db-job="removeuser"><\/span>',t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),p=function(n){function t(){var f=n.call(this,"row")||this,i=document.createElement("tr"),r,u,t;for(i.setAttribute("scope","row"),u=[o(document.createElement("td"),"Username","label",!1),o(document.createElement("td"),"Client.FullName","label",!1),o(document.createElement("td"),"Client.Tel","label",!1),o(document.createElement("td"),"Client.Email","label",!1),o(document.createElement("td"),"Client.Job","label",!1),o(r=document.createElement("td"),undefined,undefined),],r.innerHTML='<span class="pull-right activeShadow glyphicon glyphicon-lock" style="margin-left:5px;margin-right:5px" db-job="lockuser"><\/span><span class="pull-right glyphicon glyphicon-fire" style="margin-left: 5px; margin-right: 5px" db-job="removeuser"><\/span>',r.style.maxWidth="auto",t=0;t<u.length;t++)i.appendChild(u[t]);return f._Shadow=i,f}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),w=function(n){function t(){var e=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"openmail",!1),r,u,f,t;for(i.setAttribute("scope","row"),u=document.createElement("td"),u.appendChild(o(document.createElement("span"),"Visited","checkok",!1)),f=[u,o(document.createElement("td"),"From.FullName","label",!1),o(document.createElement("td"),"To","label",!1),o(document.createElement("td"),"Subject","label",!1),o(document.createElement("td"),"Body","tostring",!1),o(document.createElement("td"),"TargetId","label",!1),o(r=document.createElement("td"),undefined,undefined),],r.innerHTML='<span class="pull-right activeShadow glyphicon glyphicon-lock" style="margin-left:5px;margin-right:5px" db-job="mailvisite"><\/span><span class="pull-right glyphicon glyphicon-fire" style="margin-left: 5px; margin-right: 5px" db-job="maildelete"><\/span>',r.style.maxWidth="auto",t=0;t<f.length;t++)i.appendChild(f[t]);return e._Shadow=i,e}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),b=function(n){function t(){var f=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"openafacture",!1,{"db-exec":".IsValidated->factureStat"}),r,u,t;for(i.setAttribute("scope","row"),u=[o(document.createElement("td"),"Ref","label",!1),o(document.createElement("td"),"Date","date",!1),o(document.createElement("td"),"Client.FullName","label",!1),o(document.createElement("td"),"NArticles","label",!1),o(document.createElement("td"),"Total","label",!1),o(r=document.createElement("td"),undefined,undefined),],r.innerHTML='<span class="pull-right activeShadow glyphicon glyphicon-check" style="margin-left:5px;margin-right:5px" db-job="show" db-bind="IsValidated" target="0" db-data="none,"><\/span><span class="pull-right glyphicon glyphicon-record" style="margin-left: 5px; margin-right: 5px" db-job="show" db-bind="IsOpen" target="0" db-data="none,"><\/span>',r.style.maxWidth="auto",t=0;t<u.length;t++)i.appendChild(u[t]);return f._Shadow=i,f}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),k=function(n){function t(){var f=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"openasfacture",!1,{"db-exec":".IsValidated->sfactureStat"}),r,u,t;for(i.setAttribute("scope","row"),u=[o(document.createElement("td"),"Ref","label",!1),o(document.createElement("td"),"Fournisseur.Name","label",!1),o(document.createElement("td"),"Date","date",!1),o(document.createElement("td"),"NArticles","label",!1),o(document.createElement("td"),"Total","price",!1),o(document.createElement("td"),"Observation","label",!1),o(r=document.createElement("td"),undefined,undefined),],r.innerHTML='<span class="pull-right activeShadow glyphicon glyphicon-check" style="margin-left:5px;margin-right:5px" db-job="show" db-bind="IsValidated" target="0" db-data="none,"><\/span><span class="pull-right glyphicon glyphicon-record" style="margin-left: 5px; margin-right: 5px" db-job="show" db-bind="IsOpen" target="0" db-data="none,"><\/span>',r.style.maxWidth="auto",t=0;t<u.length;t++)i.appendChild(u[t]);return f._Shadow=i,f}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),d=function(n){function t(){var u=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"openproduct",!1),f,r,t;for(i.setAttribute("scope","row"),r=[o(document.createElement("td"),"Category","tostring",!1),o(document.createElement("td"),"Name","label",!1),o(document.createElement("td"),"Dimention","label",!1),o(document.createElement("td"),"SerieName","tostring",!1),o(document.createElement("td"),"Quality","enum2string",!1,{type:"models.Quality",rtype:"number"},{maxWidth:"70px"}),o(document.createElement("td"),"Qte","label",!1),o(document.createElement("td"),"Value","price",!1),f=o(document.createElement("td"))],f.innerHTML='<span type="button" db-job="openfsprice" class="btn btn-sm btn-danger glyphicon glyphicon-usd pull-right"><\/span>',t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),g=function(n){function t(){var u=n.call(this,"orow")||this,i=o(document.createElement("tr")),r,t;for(i.setAttribute("scope","row"),r=typeof fastEdit!="undefined"&&fastEdit?[o("td",null,null,!0,null,null,[o("input","Count","number",!0,{"class":"form-control unborder",placeholder:"Qte"})]),o("td",null,null,!0,null,null,[o("input",void 0,"TLabel",!0,{"text-transform":"uppercase","class":"form-control unborder",placeholder:"Enter the Product Name"})]),o("td",null,null,!0,null,null,[o("label","Product","number",!0,{readonly:"","db-filter":"fackeprice:0","class":"form-control unborder",placeholder:"Help"})]),o("td",null,null,!0,null,null,[o("input","Product","reduction",!0,{"class":"form-control unborder",placeholder:"Help"})]),o("td",null,null,!0,null,null,[o("label","Price","number",!0,{"class":"form-control unborder"})]),o("td",null,null,!0,null,null,[o("button","Product","openfprice",!1,{type:"button",autofocus:"true","class":"btn btn-sm btn-danger glyphicon glyphicon-usd pull-right"})])]:[o("td","Count","number",!1,{"class":"tdPadding"}),o("td","Label","label",!1,{"text-transform":"uppercase","class":"tdPadding"}),o("td","PSel","number",!1,{readonly:"","class":"tdPadding"}),o("td","Price","number",!1,{"class":"tdPadding"}),o("td",null,null,!0,null,null,[o("button","Product","openfprice",!1,{type:"button",autofocus:"true","class":"btn btn-sm btn-danger glyphicon glyphicon-usd pull-right"})])],t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),nt=function(n){function t(){var f=n.call(this,"row")||this,t=o(document.createElement("tr"),null,null,null),e,s,h,i,u,r;for(t.setAttribute("scope","row"),e=o("span","ApplyPrice","applyPriceStat",!1,null,{display:"none"}),t.appendChild(e),u=typeof fastEdit!="undefined"&&fastEdit?[h=o("td",null,null,!0,null,null,[o("input","Qte","number",!0,{"class":"form-control unborder",placeholder:"Qte"})]),s=o("td",null,null,!0,null,null,[o("input","Product","auto-product",!0,{"text-transform":"uppercase","class":"form-control unborder",placeholder:"Enter the Product Name"})]),i=o("td",null,null,!0,null,null,[o("input","PSel","number",!0,{"class":"form-control unborder",placeholder:"Prix D'Achat"})]),i=o("td",null,null,!0,null,null,[o("input",undefined,"number",!0,{"db-filter":"fackeprice:0","class":"form-control unborder",placeholder:"Prix D'Vent"})]),]:[h=o("td","Qte","number",!1,{"class":"tdPadding"}),s=o("td","Product","label",!1,{"text-transform":"uppercase","class":"tdPadding"}),i=o("td","PSel","number",!1,{"class":"tdPadding"}),i=o("td",undefined,"number",!1,{"db-filter":"fackeprice:0","class":"tdPadding"})],r=0;r<u.length;r++)t.appendChild(u[r]);return f._Shadow=t,f}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),tt=function(n){function t(){var u=n.call(this,"price")||this,i=o(document.createElement("tr"),undefined,"dopenfprice",!1),r,t;for(i.setAttribute("scope","row"),r=[o(document.createElement("td"),"Facture.Fournisseur.Name","label",!1),o(document.createElement("td"),"Product.Name","label",!1),o(document.createElement("td"),"Qte","number",!1),o(document.createElement("td"),"PSel","number",!1),o(document.createElement("td"),"Value","price",!1),o(document.createElement("td"),"PValue","price",!1),o(document.createElement("td"),"HWValue","price",!1),o(document.createElement("td"),"WValue","price",!1),],t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),it=function(n){function t(){var u=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"opencategory",!1),r,t;for(i.setAttribute("scope","row"),r=[o(document.createElement("td"),"Name","tostring",!0),o(document.createElement("td"),"Base","tostring",!0),o(document.createElement("td"),"Base.Base","tostring",!0)],t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate),rt=function(n){function t(){var u=n.call(this,"row")||this,i=o(document.createElement("tr"),undefined,"opencategory",!1),r,t;for(i.setAttribute("scope","row"),r=[o(document.createElement("td"),"Person.FullName","tostring",!1),o(document.createElement("td"),"Person.Tel","tostring",!1),o(document.createElement("td"),"Person.Email","tostring",!1),o("td",null,null,null,null,{"max-width":"75px"},[o("button","Person","openclient",!1,{type:"button","class":"btn b btn-default pull-right"},null,[document.createTextNode("Edit")])])],t=0;t<r.length;t++)i.appendChild(r[t]);return u._Shadow=i,u}return __extends(t,n),t.prototype.Create=function(){return this._Shadow.cloneNode(!0)},t}(i.mvc.ITemplate)});define("Desktop/Main",["require","exports","../lib/Q/sys/UI","../lib/Q/sys/Jobs","../lib/Q/sys/Corelib","Desktop/ModelsViews","Desktop/Apps"],function(n,t,i,r,u,f,e){"use strict";function s(){u.mvc.Initializer.Instances.then(function(){return u.thread.Dispatcher.call(e.Init,e.Init.Main,i.UI.Desktop.Current)})}function h(){o||u.thread.Dispatcher.call(null,c)}function c(){o||(o=!0,r.Jobs.Load(),s())}Object.defineProperty(t,"__esModule",{value:!0});f.Init();t.Main=s;var o=!1;t.initialize=h});define("Mobile/Core",["require","exports","../lib/q/sys/UI","../lib/q/sys/Corelib","../lib/q/sys/Filters","abstract/Models","../lib/q/sys/System","context","Mobile/Resources"],function(n,t,i,r,u,f,e,o,s){"use strict";var h,c;Object.defineProperty(t,"__esModule",{value:!0}),function(n){var a=function(n){function t(t){var i=n.call(this)||this;return i.View.addEventListener("touchstart",i),i.applyStyle("pop","card-container"),i.OnClosed=new r.bind.FEventListener("",t),i}return __extends(t,n),t.prototype.Open=function(n,r){n&&(r!=null?this.OnClosed.Add({Invoke:n,Owner:r}):this.OnClosed.Add(n));this.View.style.zIndex=String(++t.zindex);document.body.appendChild(this.View);this.Parent=i.UI.Desktop.Current;this.date=performance.now()},t.prototype.Hide=function(n,t){this.date=-1;var i={Result:n,Pop:this,Data:t,Cancel:void 0};if(this.OnClosed.PInvok("",[i],this),!i.Cancel)try{this.View.remove()}catch(i){}},t.prototype.handleEvent=function(n){n.srcElement==this.View&&(this.date==-1||performance.now()-this.date<1e3||this.Hide(i.UI.MessageResult.abort,null))},t.zindex=13224e6,t.Default=new t(!0),t}(i.UI.ContentControl),h,v,l,t,e,y;n.Pop=a;h=function(n){function t(){var t=n.call(this,"mobile.nav-bottom",i.UI.TControl.Me)||this;return t.Items=new r.collection.List(Object,[{Title:"add"},{Title:s.resources.MdIcon[s.resources.MdIcon.remove]},{Title:s.resources.MdIcon[s.resources.MdIcon.unarchive]},{Title:s.resources.MdIcon[s.resources.MdIcon.delete_sweep]}]),t.pop=new a(!1),t.OnClosed=new r.bind.FEventListener(""),t.pop.OnClosed.Add({Invoke:t.OnPopClosed,Owner:t}),t}return __extends(t,n),t.prototype.initialize=function(){n.prototype.initialize.call(this)},t.prototype.setName=function(n,t,i){n=="ListView"&&(this.ListView=i,this.ListView.AcceptNullValue=!0)},t.prototype.OnClicked=function(n,t,r){this.pop.Hide(i.UI.MessageResult.ok,r.Value)},t.prototype.Open=function(){this.pop.Content=this;this.pop.Open()},t.prototype.OnPopClosed=function(n){this.OnClosed.PInvok("",[this,n],this)},t.prototype.OkClick=function(){this.pop.Hide(i.UI.MessageResult.Exit,{})},t.prototype.CancelClick=function(){this.pop.Hide(i.UI.MessageResult.cancel,{})},t}(i.UI.TControl);n.Options=h;v=function(n){function t(t){var u=n.call(this,s.resources.mobile.get("simpleedit"),i.UI.TControl.Me)||this;return u._view.addEventListener("click",function(n){u.OnMouseDown(n)},!1),u.card=u._view.getElementsByClassName("green-card")[0],u.OnClosed=new r.bind.FEventListener("",t),u}return __extends(t,n),t.prototype._hasValue_=function(){return!0},t.prototype.OkClicked=function(){this.Close(!0)},t.prototype.CancelClicked=function(){this.Close(!1)},t.prototype.OnMouseDown=function(n){if(!(performance.now()-this.start<1e3)){var t=n.srcElement;return this.card.contains(t)?!0:(this.Close(!1),n.stopImmediatePropagation(),n.preventDefault(),!0)}},t.prototype.Close=function(n){this.isOpen=!1;i.UI.Desktop.Current.ReleaseKeyControl();try{document.body.contains(this._view)&&this.View.remove();this.OnClosed.PInvok("",[this,this.Value,n],null)}catch(t){}},t.prototype.setName=function(n,t){n=="box"&&(this.box=t)},t.prototype.Open=function(n,t){var u=this;this.isOpen||(this.isOpen=!0,i.UI.Desktop.Current.GetKeyControl(this,this.OnKeyDown,[]),this.start=performance.now(),typeof n=="number"&&(this.Value=n),this.box?this.box.disabled=t==undefined?!1:!t:this.OnCompiled=function(){u.box.disabled=t==undefined?!1:!t},r.thread.Dispatcher.call(this,this.asyncOpen))},t.prototype.asyncOpen=function(){this.Parent=i.UI.Desktop.Current;document.body.appendChild(this.View)},t.prototype.OnKeyDown=function(n){if(n.keyCode==13)this.Close(!0);else if(n.keyCode==27)this.Close(!1);else return i.UI.KeyboardControllerResult.Release;return n.stopImmediatePropagation(),n.preventDefault(),i.UI.KeyboardControllerResult.Handled},t.DPTitle=r.bind.DObject.CreateField("Title",String),t}(i.UI.TControl);n.SimpleEdit=v,function(n){var e=function(n){function t(t,i){var u=n.call(this,t)||this;return u.Teta=i,u.__Controller__=r.bind.Controller.Attach(u,u),u.Value=u,u}return __extends(t,n),t.prototype.Search=function(n){var t=this.SelectedPage;n=n.trim();t instanceof f&&t.Search(n)},t.prototype.OnDispose=function(){return r.helper.TryCatch(this.__Controller__,this.__Controller__.Dispose),n.prototype.OnDispose.call(this)},t}(i.UI.Layout),f;n.AppBase=e;f=function(n){function f(t,u,f,e){var o=n.call(this,t,i.UI.TControl.Me)||this;return o.Name=u,o.Url=f,o.Glyph=e,o.OnSelected=new r.bind.EventListener(0),o.Options=new r.collection.List(Object),o.Items=new r.collection.ExList(Object),o.ServiceType=i.UI.ServiceType.Main,o.lts=0,o._view.classList.add("panel","left"),o._view.addEventListener("touchstart",function(n){o.TouchStart(n)}),o}return __extends(f,n),f.prototype.OnSearche=function(){},f.prototype.OnDeepSearche=function(){},f.prototype.OnContextMenu=function(){},f.prototype.OnPrint=function(){},f.prototype.GetLeftBar=function(){return null},f.prototype.GetRightBar=function(){return null},f.prototype.Callback=function(){return void 0},f.prototype.Handled=function(){return!1},f.prototype.initialize=function(){n.prototype.initialize.call(this);this.Items.Filter=new u.filters.list.LStringFilter},f.prototype.setName=function(n,t,i){if(n=="ListView")return this.ListView=i,this.ListView.AcceptNullValue=!1,this.ListView.activateClass=this.activeClass(),!0},f.prototype.Search=function(n){this.Items.Filter.Patent=new u.filters.list.StringPatent(n=="*"?"":n)},f.prototype.OnKeyDown=function(n){return n.keyCode==13?(this.OnDoubleTab(this.ListView.SelectedItem),n.stopImmediatePropagation(),n.preventDefault(),!0):this.ListView.OnKeyDown(n)},f.prototype.OnAttached=function(){var n=this.ListView&&this.ListView.SelectedChild;n&&n.View.scrollIntoViewIfNeeded()},f.prototype.OnDetached=function(){},f.prototype.Update=function(){},f.prototype.OnOptionExecuted=function(){},f.prototype.TouchEnd=function(n,i){var f=performance.now(),e=f-this.lastAccess,s=this.lastCnt,o,r,u;if(this.lastAccess=f,this.lastCnt=i.dom,e<=350&&e>=100&&s==i.dom&&this.OnDoubleTab(this.ListView.SelectedItem),this.ListView.SelectedIndex!=-1){if(o=this.lts,r=performance.now(),r-o>500){if(this.dist(n.changedTouches[0],this.lct)>10)return;u=this.SearchParents(t);u&&u.OpenOptions()}this.lts=r+1e3}},f.prototype.dist=function(n,t){return Math.sqrt((n.screenX-t.screenX)*(n.screenX-t.screenX)+(n.screenY-t.screenY)*(n.screenY-t.screenY))},f.prototype.GetSubsOptions=function(){return},f.prototype.OnSubsOptionExecuted=function(){return!1},f.prototype.TouchStart=function(n){this.lts=performance.now();this.lct=n.touches[0]},f.prototype.OnDoubleTab=function(){},f.prototype.OnOptionOpening=function(){return!1},f}(i.UI.TControl);n.MobilePage=f}(l=n.abstracts||(n.abstracts={}));t=function(n){function t(u,f){var e=n.call(this,u,f)||this,s;return e.Items=new r.collection.List(Object),e.Foot=new i.UI.ServiceNavBar(e,!0),e.subOptions=new h,s=function(){},e.Items.Listen=function(n){var i,u;if(n.event==r.collection.CollectionEvent.Added)n.newItem&&n.newItem.OnSelected.Add(s,o.context.NameOf(t));else if(n.event==r.collection.CollectionEvent.Removed)n.oldItem&&n.oldItem.OnSelected.Remove(o.context.NameOf(t));else if(n.event===r.collection.CollectionEvent.Replace)n.newItem&&n.newItem.OnSelected.Add(s,o.context.NameOf(t)),n.oldItem&&n.oldItem.OnSelected.Remove(o.context.NameOf(t));else if(n.event==r.collection.CollectionEvent.Cleared)for(i=0;i<n.collection.length;i++)u=n.collection[i],u&&u.OnSelected.Remove(o.context.NameOf(t));else if(n.event==r.collection.CollectionEvent.Reset)for(i=0;i<n.collection.length;i++)u=n.collection[i],u&&u.OnSelected.Add(s,o.context.NameOf(t))},e}return __extends(t,n),t.prototype.toString=function(){return"EMobileApp"},t.prototype.showPage=function(n){var t=this;if(!this.Main){this.__Controller__.OnCompiled={Invoke:function(){t.showPage(n)},Owner:this};return}this.Main.Content&&this.Main.Content.disapplyStyle("center");n&&(n&&n.applyStyle("center"),this.Main.Content=n,this.menuContent.Source=n.Options,this.NavList.SelectedItem=n)},t.prototype.Check=function(n){return n instanceof i.UI.JControl},t.prototype._hasValue_=function(){return!0},t.prototype.setName=function(n,t,u){var f=this,e;if(n==="_panels"){this._panels=new i.UI.DivControl(t);return}if(n=="_main"){this.Main=new i.UI.ContentControl(t);this.Main.Parent=this;return}if(n=="slogan")t.addEventListener("click",function(){return f.ToggleMenu()});else{if(n=="menuContent"){this.menuContent=u;return}if(n!="Header"){if(n=="searchBar"){this.searchBar=new i.UI.UISearch(t);this.searchBar.OnSearch=this.Search.bind(this);this.searchBar.Parent=this;e=this.searchBar.handleEvent;this.searchBar.handleEvent=function(n){f.Search(f.searchBar.inputEl.value);e.call(f.searchBar,n)};return}if(n=="NavList"){this.NavList=u;this.line=new r.bind.TwoDBind(r.bind.BindingMode.TwoWay,this,this.NavList,l.AppBase.DPSelectedPage,i.UI.ListAdapter.DPSelectedItem,function(n){return n},function(n){return n});return}return}}this[n]=t},t.prototype.Add=function(){return this},t.prototype.OnOptionClicked=function(n,t,i){if(this.Header.classList.contains("menu-opened")){this.Header.classList.remove("menu-opened");var u=i.Value;u&&u.OnOptionClicked&&r.helper.TryCatch(u,u.OnOptionClicked,void 0,[u,this,this.SelectedPage]);r.helper.TryCatch(this.SelectedPage,this.SelectedPage.OnOptionExecuted,void 0,[u])}},t.prototype.navClicked=function(n,t,i){if(!document.webkitIsFullScreen){var r=document.body;r.requestFullscreen&&r.requestFullscreen();r.webkitRequestFullScreen&&r.webkitRequestFullScreen();r.webkitRequestFullscreen&&r.webkitRequestFullscreen()}this.SelectedPage=i.Value},t.prototype.ToggleMenu=function(){r.$$(this.Header).toggleClass("menu-opened")},t.prototype.SelectNaxtPage=function(){this.NavList.SelectedIndex++},t.prototype.SelectPrevPage=function(){this.NavList.SelectedIndex--},t.prototype.OpenOptions=function(){this.SelectedPage&&this.SelectedPage.OnOptionOpening()&&this.subOptions.Open()},t.prototype.OnSubsOptionClosed=function(n,t){var i=this.SelectedPage;i&&i.OnOptionExecuted(t)},t.prototype.initialize=function(){r.ScopicCommand.Register({Invoke:this.reRenderNavitem,Owner:this},null,"initNav");this.subOptions.OnClosed.Add({Invoke:this.OnSubsOptionClosed,Owner:this});n.prototype.initialize.call(this)},t.prototype.Update=function(){this.SelectedPage&&this.SelectedPage.Update()},t.prototype.OnKeyDown=function(t){return this.searchBar&&this.searchBar.IsOpen?!0:n.prototype.OnKeyDown.call(this,t)},t.prototype.OnDeepSearche=function(){this.searchBar.open()},t.prototype.Search=function(n){var t=this.SelectedPage;n=n.trim();t&&t.Search&&t.Search(n)},t.prototype.OnAttached=function(){var n=this.SelectedPage;n&&n.OnAttached()},t.prototype.reRenderNavitem=function(n,t,i){var r=i,u=t,f=u.firstElementChild;u.href="#"+r.Url;r.dom=t;f.innerText=r.Glyph;this.SelectedPage==null&&(this.SelectedPage=r)},__decorate([r.attributes.property(r.collection.List,void 0),__metadata("design:type",r.collection.List)],t.prototype,"Options",void 0),t}(l.AppBase);n.EMobileApp=t;e=function(n){function t(t){var i=n.call(this,s.resources.mobile.get("login-form").content.firstElementChild,t)||this;return i.i=!0,i.firstTime=!0,i.Value=new f.models.Login,i}return __extends(t,n),t.prototype._hasValue_=function(){return!0},t.prototype.initialize=function(){n.prototype.initialize.call(this)},t.prototype.setName=function(n,t){this[n]=t},t.prototype._login=function(){this.login()},t.prototype.login=function(){var n=this;if(this.hors_conn.checked){this.Teta.Setting.offline=!0;this.Teta.Setting.Stat=s.Common.ServerStat.Connected;return}this.Teta.Setting.Stat=s.Common.ServerStat.Connecting;s.resources.GData.requester.Post(f.models.Login,this.Value,null,function(i,r,u,f){if(!i.IsSuccess)return n.Teta.Setting.Stat=s.Common.ServerStat.UnAvaible;n.Teta.Setting.Stat=u?s.Common.ServerStat.Connected:s.Common.ServerStat.Disconnected;u&&(n.Teta.Setting.saveAuth(),s.resources.GData.requester.SetAuth("id",t.id=f.GetHeader("id")));n.firstTime&&delete n.firstTime})},t.prototype._signup=function(){alert("Signup")},t.prototype.pwdForgotten=function(){alert("Pwd Forgotten")},t.prototype.hello=function(){alert("Hello ")},t.toogle=function(n,t){t.style.opacity="0";t.style.height="1px";t.style.display="";var i=window.getComputedStyle(n,null).getPropertyValue("padding-top"),u=window.getComputedStyle(n,null).getPropertyValue("padding-bottom");return r.css.animation.animates({animations:[{dom:n,props:[r.css.animation.constats.hideOpacity,r.css.animation.trigger("padding-top",parseInt(i),0,"","px"),r.css.animation.trigger("padding-bottom",parseInt(u),0,"","px"),r.css.animation.trigger("height",n.clientHeight,0,"","px")],timespan:1e3,oncomplete:function(n){n.dom.style.display="none"}},{dom:t,props:[r.css.animation.constats.showOpacity,r.css.animation.trigger("height",0,t.scrollHeight+1,"","px")],timespan:1e3,onstart:function(n){n.dom.style.display="block"}}],interval:100,timespan:700})},t.prototype._toggle=function(){this.toggleIcon.innerText=this.i?"create":"person";i.UI.JControl.toggleClass(this.toggleIcon,"glyphicon-user");this.anim&&r.css.animation.stopAnimations(this.anim);this.anim=(this.i=!this.i)?t.toogle(this.signupForm,this.loginForm):t.toogle(this.loginForm,this.signupForm)},t.prototype.ExcuteOnCompiled=function(n,t){this.__Controller__?this.__Controller__.OnCompiled={Invoke:n,Owner:t}:n.call(t,null)},t.prototype.Show=function(){if(this.firstTime&&(this.firstTime=!1,this.Teta.Setting.loadAuth())){this.ExcuteOnCompiled(this.login,this);return}for(var n=i.UI.Desktop.Current,r=0,t=n.getChild(r);t;){if(t==this)break;t=n.getChild(++r)}t||n.Add(this);n.Show(this)},t}(t);n.AuthApp=e;y=function(n){function t(t){var i=n.call(this,s.resources.mobile.get("settings").content.firstElementChild,t)||this;return i.i=!0,i.connectionCheker=new c.checkConnection(i),i.loadIP(),i}return __extends(t,n),t.__fields__=function(){return[this.DPServerAddress,this.DPPort,this.DPStat]},t.prototype.connect=function(){this.connectionCheker.request()},t.prototype._show=function(n){for(var t=i.UI.Desktop.Current,u=0,r=t.getChild(u);r;){if(r==n)break;r=t.getChild(++u)}r||t.Add(n);t.Show(n)},t.prototype.setName=function(n,t){this[n]=t;n==="toggleIcon"&&(this.toggleIcon.innerText="settings")},t.prototype._toggle=function(){this.anim&&r.css.animation.stopAnimations(this.anim);this.anim=(this.i=!this.i)?e.toogle(this.signupForm,this.loginForm):e.toogle(this.loginForm,this.signupForm);this.toggleIcon.innerText=this.i?"settings":"sms"},t.prototype.AddRessChanged=function(n){var f=this,t=n._new||"",u,i;t&&(u=t.indexOf(":"),i=t.lastIndexOf(":"),i>u&&r.thread.Dispatcher.call(this,function(){f.ServerAddress=t.substring(0,i)}))},t.prototype.OnStatChanged=function(n){var t=i.UI.Desktop.Current;switch(n._new){case s.Common.ServerStat.UnAvaible:if(this.connectionCheker.stopThread(),this.offline==!0)return r.thread.Dispatcher.call(this,function(){this.Teta.Setting.Stat=s.Common.ServerStat.Connected});if(this.offline!=null&&r.basic.Settings.get("offline"))return r.thread.Dispatcher.call(this,function(){if(confirm("Do you want to run offline mode")){this.offline=!0;this.Teta.Setting.Stat=s.Common.ServerStat.Connected;return}this.offline=!1});this._show(this);break;case s.Common.ServerStat.Disconnected:this.connectionCheker.stopThread();this.saveIP();this.Teta.Auth.Show();break;case s.Common.ServerStat.Connected:this.connectionCheker.startThread();this.saveAuth();this.saveIP();this._show(this.Teta.App)}},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.loadIP()},t.prototype.Recheck=function(n){return this.connectionCheker.request(n),this},Object.defineProperty(t.prototype,"Address",{get:function(){return this.ServerAddress+(this.Port?":"+this.Port:"")},enumerable:!0,configurable:!0}),t.prototype.Connect=function(){if(this.hors_conn.checked){this.Teta.Setting.offline=!0;this.Teta.Setting.Stat=s.Common.ServerStat.Connected;return}try{this.ServerAddress.lastIndexOf("/")==this.ServerAddress.length-1&&(this.ServerAddress=this.ServerAddress.substring(0,this.ServerAddress.length-1));var n=new System.basics.Url(this.Address);if(!n.IsExternal)return alert("L'address doit etre commencer par (http://) ou par (https://) ou par autres shemas ");__global.ApiServer=n}catch(t){alert("Un Error Occured check your entities");return}this.Recheck()},t.prototype.Show=function(){var t=this;this.connectionCheker.stopThread();this.connectionCheker.request(function(n,i){t.OnStatChanged({_new:i==null?s.Common.ServerStat.UnAvaible:i==!0?s.Common.ServerStat.Connected:s.Common.ServerStat.Disconnected})});n.prototype.Show.call(this)},t.prototype.saveIP=function(){try{localStorage.setItem("ip",this.ServerAddress);localStorage.setItem("port",String(this.Port))}catch(n){}},t.prototype.loadIP=function(){this.ServerAddress=localStorage.getItem("ip");this.Port=parseInt(localStorage.getItem("port"))},t.prototype.saveAuth=function(){try{localStorage.setItem("auth",JSON.stringify(r.encoding.SerializationContext.GlobalContext.reset().ToJson(this.Teta.Auth.Value)))}catch(n){}},t.prototype.loadAuth=function(){var n=localStorage.getItem("auth");if(n)try{return __global.ApiServer=new System.basics.Url(localStorage.getItem("ip")||"http://192.168.1.2"),this.Teta.Auth.Value.FromJson(JSON.parse(n),r.encoding.SerializationContext.GlobalContext.reset()),!0}catch(t){}return!1},t.DPServerAddress=r.bind.DObject.CreateField("ServerAddress",String,"",null,t.prototype.AddRessChanged),t.DPStat=r.bind.DObject.CreateField("Stat",Number,0,t.prototype.OnStatChanged),t.DPPort=r.bind.DObject.CreateField("Port",Number),t}(t);n.Settings=y}(h=t.controls||(t.controls={})),function(n){var t=function(n){function t(t){var i=n.call(this,!0)||this;return i.settings=t,i.http=new XMLHttpRequest,i._shema={Method:r.net.WebRequestMethod.Get,Name:"CHECKCONNECTION",SendData:!1,ParamsFormat:r.basic.StringCompile.Compile("")},i}return __extends(t,n),t.prototype.request=function(n){s.resources.GData.requester.Request(h.Settings,"CHECKCONNECTION",null,null,n)},t.prototype.startThread=function(){var n=this;clearInterval(this.thread);this.thread=setInterval(function(){n.request()},1e4)},t.prototype.stopThread=function(){clearInterval(this.thread);this.thread=-1},t.prototype.Register=function(){},t.prototype.ERegister=function(){},t.prototype.GetMethodShema=function(){return this._shema},t.prototype.GetType=function(){return h.Settings},t.prototype.GetRequest=function(){return new r.net.RequestUrl(__global.GetApiAddress("/~checklogging"),null,null,r.net.WebRequestMethod.Get,!1)},t.prototype.OnResponse=function(n){this.settings.Stat=n===!1?s.Common.ServerStat.Disconnected:n===!0?s.Common.ServerStat.Connected:s.Common.ServerStat.UnAvaible},t}(e.Controller.Api);n.checkConnection=t}(c=t.ECommon||(t.ECommon={}))});define("Mobile/Resources",["require","exports","template|../assets/mobile/templates/templates.mobile.html","context","../lib/q/sys/UI","../lib/q/sys/Services","abstract/extra/Common"],function(n,t,i,r,u,f,e){"use strict";function o(t,i){for(var e,u=0,f=["Roboto","style","uisearch"];u<f.length;u++)e=f[u],n("style|../assets/mobile/css/"+e+".css",t,i,r.context)}var s,h;Object.defineProperty(t,"__esModule",{value:!0});t.loadCss=o;u.LoadDefaultCSS();o(),function(n){n.mobile=i.template.mobile;e.GetVars(function(t){return n.GData=clone(t),!1});var t;(function(n){n[n.local_pharmacy=0]="local_pharmacy";n[n.check_circle=1]="check_circle";n[n.chrome_reader_mode=2]="chrome_reader_mode";n[n["class"]=3]="class";n[n.code=4]="code";n[n.compare_arrows=5]="compare_arrows";n[n.copyright=6]="copyright";n[n.credit_card=7]="credit_card";n[n.dashboard=8]="dashboard";n[n.local_airport=9]="local_airport";n[n.link=10]="link";n[n.inbox=11]="inbox";n[n.gesture=12]="gesture";n[n.forward=13]="forward";n[n.font_download=14]="font_download";n[n.flag=15]="flag";n[n.filter_list=16]="filter_list";n[n.drafts=17]="drafts";n[n.local_library=18]="local_library";n[n.local_laundry_service=19]="local_laundry_service";n[n.local_hotel=20]="local_hotel";n[n.local_hospital=21]="local_hospital";n[n.local_grocery_store=22]="local_grocery_store";n[n.local_gas_station=23]="local_gas_station";n[n.local_florist=24]="local_florist";n[n.local_drink=25]="local_drink";n[n.local_dining=26]="local_dining";n[n.reply=27]="reply";n[n.reply_all=28]="reply_all";n[n.report=29]="report";n[n.save=30]="save";n[n.select_all=31]="select_all";n[n.send=32]="send";n[n.sort=33]="sort";n[n.text_format=34]="text_format";n[n.layers=35]="layers";n[n.layers_clear=36]="layers_clear";n[n.my_location=37]="my_location";n[n.navigation=38]="navigation";n[n.low_priority=39]="low_priority";n[n.mail=40]="mail";n[n.markunread=41]="markunread";n[n.move_to_inbox=42]="move_to_inbox";n[n.next_week=43]="next_week";n[n.redo=44]="redo";n[n.remove=45]="remove";n[n.remove_circle=46]="remove_circle";n[n.format_strikethrough=47]="format_strikethrough";n[n.format_size=48]="format_size";n[n.format_shapes=49]="format_shapes";n[n.format_quote=50]="format_quote";n[n.format_paint=51]="format_paint";n[n.format_list_numbered=52]="format_list_numbered";n[n.format_list_bulleted=53]="format_list_bulleted";n[n.format_line_spacing=54]="format_line_spacing";n[n.format_italic=55]="format_italic";n[n.rv_hookup=56]="rv_hookup";n[n.location_city=57]="location_city";n[n.mood=58]="mood";n[n.mood_bad=59]="mood_bad";n[n.flash_auto=60]="flash_auto";n[n.sync_disabled=61]="sync_disabled";n[n.sync_problem=62]="sync_problem";n[n.subdirectory_arrow_right=63]="subdirectory_arrow_right";n[n.subdirectory_arrow_left=64]="subdirectory_arrow_left";n[n.refresh=65]="refresh";n[n.more_vert=66]="more_vert";n[n.more_horiz=67]="more_horiz";n[n.menu=68]="menu";n[n.last_page=69]="last_page";n[n.place=70]="place";n[n.rate_review=71]="rate_review";n[n.local_phone=72]="local_phone";n[n.bluetooth_audio=73]="bluetooth_audio";n[n.confirmation_number=74]="confirmation_number";n[n.disc_full=75]="disc_full";n[n.local_pizza=76]="local_pizza";n[n.local_play=77]="local_play";n[n.local_post_office=78]="local_post_office";n[n.local_printshop=79]="local_printshop";n[n.near_me=80]="near_me";n[n.person_pin=81]="person_pin";n[n.person_pin_circle=82]="person_pin_circle";n[n.pin_drop=83]="pin_drop";n[n.system_update=84]="system_update";n[n.tap_and_play=85]="tap_and_play";n[n.time_to_leave=86]="time_to_leave";n[n.vibration=87]="vibration";n[n.voice_chat=88]="voice_chat";n[n.casino=89]="casino";n[n.child_friendly=90]="child_friendly";n[n.fitness_center=91]="fitness_center";n[n.free_breakfast=92]="free_breakfast";n[n.golf_course=93]="golf_course";n[n.hot_tub=94]="hot_tub";n[n.kitchen=95]="kitchen";n[n.pool=96]="pool";n[n.room_service=97]="room_service";n[n.directions_car=98]="directions_car";n[n.directions_bus=99]="directions_bus";n[n.sms=100]="sms";n[n.sms_failed=101]="sms_failed";n[n.sync=102]="sync";n[n.battery_unknown=103]="battery_unknown";n[n.bluetooth=104]="bluetooth";n[n.bluetooth_connected=105]="bluetooth_connected";n[n.flash_on=106]="flash_on";n[n.flash_off=107]="flash_off";n[n.restaurant_menu=108]="restaurant_menu";n[n.satellite=109]="satellite";n[n.store_mall_directory=110]="store_mall_directory";n[n.streetview=111]="streetview";n[n.subway=112]="subway";n[n.terrain=113]="terrain";n[n.traffic=114]="traffic";n[n.train=115]="train";n[n.tram=116]="tram";n[n.check_box=117]="check_box";n[n.check_box_outline_blank=118]="check_box_outline_blank";n[n.indeterminate_check_box=119]="indeterminate_check_box";n[n.radio_button_checked=120]="radio_button_checked";n[n.radio_button_unchecked=121]="radio_button_unchecked";n[n.star=122]="star";n[n.star_border=123]="star_border";n[n.map=124]="map";n[n.transfer_within_a_station=125]="transfer_within_a_station";n[n.zoom_out_map=126]="zoom_out_map";n[n.apps=127]="apps";n[n.arrow_back=128]="arrow_back";n[n.arrow_downward=129]="arrow_downward";n[n.school=130]="school";n[n.sentiment_dissatisfied=131]="sentiment_dissatisfied";n[n.sentiment_neutral=132]="sentiment_neutral";n[n.sentiment_satisfied=133]="sentiment_satisfied";n[n.sentiment_very_dissatisfied=134]="sentiment_very_dissatisfied";n[n.sentiment_very_satisfied=135]="sentiment_very_satisfied";n[n.share=136]="share";n[n.whatshot=137]="whatshot";n[n.local_taxi=138]="local_taxi";n[n.add_to_photos=139]="add_to_photos";n[n.add_a_photo=140]="add_a_photo";n[n.watch=141]="watch";n[n.videogame_asset=142]="videogame_asset";n[n.tv=143]="tv";n[n.local_activity=144]="local_activity";n[n.star_half=145]="star_half";n[n.local_atm=146]="local_atm";n[n.local_bar=147]="local_bar";n[n.local_cafe=148]="local_cafe";n[n.local_car_wash=149]="local_car_wash";n[n.local_convenience_store=150]="local_convenience_store";n[n.add_location=151]="add_location";n[n.fullscreen_exit=152]="fullscreen_exit";n[n.fullscreen=153]="fullscreen";n[n.first_page=154]="first_page";n[n.expand_more=155]="expand_more";n[n.child_care=156]="child_care";n[n.notifications=157]="notifications";n[n.notifications_active=158]="notifications_active";n[n.notifications_none=159]="notifications_none";n[n.notifications_off=160]="notifications_off";n[n.notifications_paused=161]="notifications_paused";n[n.arrow_drop_down=162]="arrow_drop_down";n[n.local_see=163]="local_see";n[n.local_shipping=164]="local_shipping";n[n.cake=165]="cake";n[n.domain=166]="domain";n[n.group=167]="group";n[n.group_add=168]="group_add";n[n.content_cut=169]="content_cut";n[n.content_paste=170]="content_paste";n[n.create=171]="create";n[n.delete_sweep=172]="delete_sweep";n[n.smoke_free=173]="smoke_free";n[n.smoking_rooms=174]="smoking_rooms";n[n.spa=175]="spa";n[n.image_aspect_ratio=176]="image_aspect_ratio";n[n.image=177]="image";n[n.healing=178]="healing";n[n.hdr_weak=179]="hdr_weak";n[n.hdr_strong=180]="hdr_strong";n[n.hdr_on=181]="hdr_on";n[n.hdr_off=182]="hdr_off";n[n.grid_on=183]="grid_on";n[n.directions_railway=184]="directions_railway";n[n.directions_run=185]="directions_run";n[n.directions_subway=186]="directions_subway";n[n.directions_transit=187]="directions_transit";n[n.directions_walk=188]="directions_walk";n[n.edit_location=189]="edit_location";n[n.ev_station=190]="ev_station";n[n.flight=191]="flight";n[n.hotel=192]="hotel";n[n.unarchive=193]="unarchive";n[n.undo=194]="undo";n[n.weekend=195]="weekend";n[n.access_alarm=196]="access_alarm";n[n.access_alarms=197]="access_alarms";n[n.access_time=198]="access_time";n[n.add_alarm=199]="add_alarm";n[n.airplanemode_active=200]="airplanemode_active";n[n.airplanemode_inactive=201]="airplanemode_inactive";n[n.restaurant=202]="restaurant";n[n.directions_boat=203]="directions_boat";n[n.directions_bike=204]="directions_bike";n[n.directions=205]="directions";n[n.beenhere=206]="beenhere";n[n.business_center=207]="business_center";n[n.beach_access=208]="beach_access";n[n.all_inclusive=209]="all_inclusive";n[n.airport_shuttle=210]="airport_shuttle";n[n.ac_unit=211]="ac_unit";n[n.wifi=212]="wifi";n[n.wc=213]="wc";n[n.vpn_lock=214]="vpn_lock";n[n.format_textdirection_l_to_r=215]="format_textdirection_l_to_r";n[n.grid_off=216]="grid_off";n[n.grain=217]="grain";n[n.gradient=218]="gradient";n[n.flip=219]="flip";n[n.local_parking=220]="local_parking";n[n.local_offer=221]="local_offer";n[n.local_movies=222]="local_movies";n[n.local_mall=223]="local_mall";n[n.battery_alert=224]="battery_alert";n[n.battery_charging_full=225]="battery_charging_full";n[n.battery_full=226]="battery_full";n[n.battery_std=227]="battery_std";n[n["public"]=228]="public";n[n.poll=229]="poll";n[n.plus_one=230]="plus_one";n[n.person_outline=231]="person_outline";n[n.person_add=232]="person_add";n[n.person=233]="person";n[n.people_outline=234]="people_outline";n[n.people=235]="people";n[n.party_mode=236]="party_mode";n[n.pages=237]="pages";n[n.remove_circle_outline=238]="remove_circle_outline";n[n.flare=239]="flare";n[n.filter_vintage=240]="filter_vintage";n[n.filter_tilt_shift=241]="filter_tilt_shift";n[n.adb=242]="adb";n[n.airline_seat_flat=243]="airline_seat_flat";n[n.airline_seat_flat_angled=244]="airline_seat_flat_angled";n[n.airline_seat_individual_suite=245]="airline_seat_individual_suite";n[n.airline_seat_legroom_extra=246]="airline_seat_legroom_extra";n[n.airline_seat_legroom_normal=247]="airline_seat_legroom_normal";n[n.airline_seat_legroom_reduced=248]="airline_seat_legroom_reduced";n[n.airline_seat_recline_extra=249]="airline_seat_recline_extra";n[n.airline_seat_recline_normal=250]="airline_seat_recline_normal";n[n.cast=251]="cast";n[n.cast_connected=252]="cast_connected";n[n.computer=253]="computer";n[n.desktop_mac=254]="desktop_mac";n[n.arrow_drop_down_circle=255]="arrow_drop_down_circle";n[n.arrow_drop_up=256]="arrow_drop_up";n[n.arrow_forward=257]="arrow_forward";n[n.arrow_upward=258]="arrow_upward";n[n.cancel=259]="cancel";n[n.check=260]="check";n[n.chevron_left=261]="chevron_left";n[n.chevron_right=262]="chevron_right";n[n.close=263]="close";n[n.expand_less=264]="expand_less";n[n.bluetooth_disabled=265]="bluetooth_disabled";n[n.bluetooth_searching=266]="bluetooth_searching";n[n.brightness_auto=267]="brightness_auto";n[n.brightness_high=268]="brightness_high";n[n.brightness_low=269]="brightness_low";n[n.brightness_medium=270]="brightness_medium";n[n.data_usage=271]="data_usage";n[n.developer_mode=272]="developer_mode";n[n.devices=273]="devices";n[n.dvr=274]="dvr";n[n.gps_fixed=275]="gps_fixed";n[n.gps_not_fixed=276]="gps_not_fixed";n[n.gps_off=277]="gps_off";n[n.graphic_eq=278]="graphic_eq";n[n.location_disabled=279]="location_disabled";n[n.location_searching=280]="location_searching";n[n.network_cell=281]="network_cell";n[n.network_wifi=282]="network_wifi";n[n.nfc=283]="nfc";n[n.screen_lock_landscape=284]="screen_lock_landscape";n[n.screen_lock_portrait=285]="screen_lock_portrait";n[n.screen_lock_rotation=286]="screen_lock_rotation";n[n.screen_rotation=287]="screen_rotation";n[n.sd_storage=288]="sd_storage";n[n.settings_system_daydream=289]="settings_system_daydream";n[n.signal_cellular_4_bar=290]="signal_cellular_4_bar";n[n.signal_cellular_connected_no_internet_4_bar=291]="signal_cellular_connected_no_internet_4_bar";n[n.signal_cellular_no_sim=292]="signal_cellular_no_sim";n[n.signal_cellular_null=293]="signal_cellular_null";n[n.signal_cellular_off=294]="signal_cellular_off";n[n.signal_wifi_4_bar=295]="signal_wifi_4_bar";n[n.signal_wifi_4_bar_lock=296]="signal_wifi_4_bar_lock";n[n.signal_wifi_off=297]="signal_wifi_off";n[n.storage=298]="storage";n[n.usb=299]="usb";n[n.wallpaper=300]="wallpaper";n[n.widgets=301]="widgets";n[n.wifi_lock=302]="wifi_lock";n[n.wifi_tethering=303]="wifi_tethering";n[n.attach_file=304]="attach_file";n[n.attach_money=305]="attach_money";n[n.border_all=306]="border_all";n[n.border_bottom=307]="border_bottom";n[n.border_clear=308]="border_clear";n[n.border_color=309]="border_color";n[n.border_horizontal=310]="border_horizontal";n[n.border_inner=311]="border_inner";n[n.border_left=312]="border_left";n[n.border_outer=313]="border_outer";n[n.border_right=314]="border_right";n[n.border_style=315]="border_style";n[n.border_top=316]="border_top";n[n.border_vertical=317]="border_vertical";n[n.bubble_chart=318]="bubble_chart";n[n.drag_handle=319]="drag_handle";n[n.format_align_center=320]="format_align_center";n[n.format_align_justify=321]="format_align_justify";n[n.format_align_left=322]="format_align_left";n[n.format_align_right=323]="format_align_right";n[n.format_bold=324]="format_bold";n[n.format_clear=325]="format_clear";n[n.format_color_fill=326]="format_color_fill";n[n.format_color_reset=327]="format_color_reset";n[n.format_color_text=328]="format_color_text";n[n.format_indent_decrease=329]="format_indent_decrease";n[n.format_indent_increase=330]="format_indent_increase";n[n.sim_card_alert=331]="sim_card_alert";n[n.sd_card=332]="sd_card";n[n.priority_high=333]="priority_high";n[n.power=334]="power";n[n.phone_paused=335]="phone_paused";n[n.phone_missed=336]="phone_missed";n[n.phone_locked=337]="phone_locked";n[n.phone_in_talk=338]="phone_in_talk";n[n.phone_forwarded=339]="phone_forwarded";n[n.phone_bluetooth_speaker=340]="phone_bluetooth_speaker";n[n.personal_video=341]="personal_video";n[n.ondemand_video=342]="ondemand_video";n[n.no_encryption=343]="no_encryption";n[n.network_locked=344]="network_locked";n[n.network_check=345]="network_check";n[n.more=346]="more";n[n.mms=347]="mms";n[n.live_tv=348]="live_tv";n[n.folder_special=349]="folder_special";n[n.event_note=350]="event_note";n[n.event_busy=351]="event_busy";n[n.event_available=352]="event_available";n[n.enhanced_encryption=353]="enhanced_encryption";n[n.drive_eta=354]="drive_eta";n[n.do_not_disturb_on=355]="do_not_disturb_on";n[n.do_not_disturb_off=356]="do_not_disturb_off";n[n.do_not_disturb_alt=357]="do_not_disturb_alt";n[n.do_not_disturb=358]="do_not_disturb";n[n.fiber_smart_record=359]="fiber_smart_record";n[n.forward_10=360]="forward_10";n[n.forward_30=361]="forward_30";n[n.forward_5=362]="forward_5";n[n.games=363]="games";n[n.hd=364]="hd";n[n.hearing=365]="hearing";n[n.high_quality=366]="high_quality";n[n.library_add=367]="library_add";n[n.library_books=368]="library_books";n[n.library_music=369]="library_music";n[n.loop=370]="loop";n[n.mic=371]="mic";n[n.mic_none=372]="mic_none";n[n.mic_off=373]="mic_off";n[n.movie=374]="movie";n[n.music_video=375]="music_video";n[n.new_releases=376]="new_releases";n[n.not_interested=377]="not_interested";n[n.note=378]="note";n[n.pause=379]="pause";n[n.pause_circle_filled=380]="pause_circle_filled";n[n.pause_circle_outline=381]="pause_circle_outline";n[n.play_arrow=382]="play_arrow";n[n.play_circle_filled=383]="play_circle_filled";n[n.play_circle_outline=384]="play_circle_outline";n[n.playlist_add=385]="playlist_add";n[n.playlist_add_check=386]="playlist_add_check";n[n.playlist_play=387]="playlist_play";n[n.queue=388]="queue";n[n.queue_music=389]="queue_music";n[n.queue_play_next=390]="queue_play_next";n[n.radio=391]="radio";n[n.recent_actors=392]="recent_actors";n[n.remove_from_queue=393]="remove_from_queue";n[n.repeat=394]="repeat";n[n.repeat_one=395]="repeat_one";n[n.replay=396]="replay";n[n.replay_10=397]="replay_10";n[n.replay_30=398]="replay_30";n[n.replay_5=399]="replay_5";n[n.shuffle=400]="shuffle";n[n.skip_next=401]="skip_next";n[n.skip_previous=402]="skip_previous";n[n.slow_motion_video=403]="slow_motion_video";n[n.snooze=404]="snooze";n[n.sort_by_alpha=405]="sort_by_alpha";n[n.stop=406]="stop";n[n.subscriptions=407]="subscriptions";n[n.subtitles=408]="subtitles";n[n.surround_sound=409]="surround_sound";n[n.video_call=410]="video_call";n[n.video_label=411]="video_label";n[n.video_library=412]="video_library";n[n.videocam=413]="videocam";n[n.videocam_off=414]="videocam_off";n[n.volume_down=415]="volume_down";n[n.volume_mute=416]="volume_mute";n[n.volume_off=417]="volume_off";n[n.volume_up=418]="volume_up";n[n.web=419]="web";n[n.web_asset=420]="web_asset";n[n.business=421]="business";n[n.call=422]="call";n[n.call_end=423]="call_end";n[n.call_made=424]="call_made";n[n.call_merge=425]="call_merge";n[n.call_missed=426]="call_missed";n[n.call_missed_outgoing=427]="call_missed_outgoing";n[n.call_received=428]="call_received";n[n.call_split=429]="call_split";n[n.chat=430]="chat";n[n.chat_bubble=431]="chat_bubble";n[n.chat_bubble_outline=432]="chat_bubble_outline";n[n.clear_all=433]="clear_all";n[n.comment=434]="comment";n[n.contact_mail=435]="contact_mail";n[n.contact_phone=436]="contact_phone";n[n.contacts=437]="contacts";n[n.dialer_sip=438]="dialer_sip";n[n.dns=439]="dns";n[n["delete"]=440]="delete";n[n.delete_forever=441]="delete_forever"})(t=n.MdIcon||(n.MdIcon={}));f.Load(n.GData.requester)}(s=t.resources||(t.resources={})),function(n){var t;(function(n){n[n.Undefinned=0]="Undefinned";n[n.UnAvaible=1]="UnAvaible";n[n.Connecting=2]="Connecting";n[n.Disconnected=14]="Disconnected";n[n.Connected=22]="Connected"})(t=n.ServerStat||(n.ServerStat={}))}(h=t.Common||(t.Common={}))});define("Mobile/Common",["require","exports","../lib/q/sys/Corelib","Mobile/Resources","Mobile/Core","../lib/q/sys/UI"],function(n,t,i,r,u,f){"use strict";var e,o;Object.defineProperty(t,"__esModule",{value:!0});e=function(){function n(){}return n.createNewArticle=function(n,t,i){var u=this;r.resources.GData.apis.Article.New(function(r){var f=r.Data;f?(f.Price=t.Value,f.Owner=n,t.CurrentArticle=f,f.Product=t,f.Price=t.Value||t.PValue||t.HWValue||t.WValue,n.Articles.Add(f),u.saveArticle(n,f,i)):alert("failed to create new article")})},n.saveArticle=function(n,t,u){var f=t.CreateBackup();t.Count=u;u?r.resources.GData.apis.Article.Save(t,function(n){n.Error==i.basic.DataStat.Success?t.Commit(f):(alert("L'article n'est pas sauvegarder"),t.Rollback(f))}):r.resources.GData.apis.Article.Delete(t,function(r){r.Error==i.basic.DataStat.Success?(t.Commit(f),n.Articles.Remove(t),t.Product.CurrentArticle=null):(alert("L'article n'est pas sauvegarder"),t.Rollback(f))})},n.deleteArticle=function(n,t,u){r.resources.GData.apis.Article.Delete(t,function(r){r.Error==i.basic.DataStat.Success?(u&&t.Commit(u),n.Articles.Remove(t),t.Product.CurrentArticle=null):(alert("L'article n'est pas supprimer"),u&&t.Rollback(u))})},n.editArticle=function(n,t,i){var r=this;i&&n&&(this.t.Open(t&&t.Count||0,!0),n.IsOpen&&this.t.OnClosed.Add(function(u,f,e){e&&(t?r.saveArticle(n,t,f):r.createNewArticle(n,i,f))}))},n.t=new u.controls.SimpleEdit(!0),n}();t.ArticleManager=e;o=function(){function n(){}return n.prototype.Init=function(n,t,i,r){this.Facture=n;this.art=t;this.prd=i;this.t=r},n.prototype.OnOptionOpening=function(){var n=this.Facture;if(n&&n.IsOpen&&this.prd)return this.bl=this.art&&this.art.CreateBackup(),!0},n.prototype.OnOptionExecuted=function(n){var e=this,t=this.prd,o=this.art,u=this.Facture,s;if(u&&u.IsOpen&&t){if(n.Result==f.UI.MessageResult.cancel){o&&this.bl&&o.Rollback(this.bl);this.bl=null;return}n.Result==f.UI.MessageResult.Exit?(n.Cancel=!0,s=n.Pop,r.resources.GData.apis.Article.Save(t.CurrentArticle,function(n){n.Error==i.basic.DataStat.Success?(n.Data.Commit(e.bl),e.bl=null,u.Recalc(),f.UI.InfoArea.push("The article wass successfully saved"),s.Hide(f.UI.MessageResult.cancel,null)):alert("Error while saving the article")})):n.Result==f.UI.MessageResult.ok&&(n.Cancel=n.Data.Title!="delete_sweep"&&n.Data.Title!="unarchive",o?this.exec(o,n.Data):r.resources.GData.apis.Article.New(function(i){var r=i.Data;r?(r.Owner=u,t.CurrentArticle=r,r.Product=t,r.Price=t.Value||t.PValue||t.HWValue||t.WValue,e.Facture.Articles.Add(r),u.Recalc(),e.exec(r,n.Data)):alert("failed to create new article")}))}},n.prototype.exec=function(n,t){var i=this.Facture;t.Title=="add"?n.Count++:t.Title=="remove"?n.Count--:t.Title=="unarchive"?e.editArticle(i,n,n&&n.Product):t.Title=="delete_sweep"&&e.deleteArticle(i,n)},n}();t.factureOpers=o});define("Mobile/Pages/Home",["require","exports","Mobile/Core","abstract/Models","../../lib/q/sys/Corelib","Mobile/Resources","Mobile/Common","../../lib/q/sys/UI","../../lib/q/sys/Filters"],function(n,t,i,r,u,f,e,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(n){var h=function(n){function t(t){var r=n.call(this,f.resources.mobile.get("home"),"Shop","","home")||this;return r.app=t,r.Products=f.resources.GData.__data.Products,r.t=new i.controls.SimpleEdit(!0),r.articleChanged={Owner:r,Invoke:r.OnArticleChanged},r.fop=new e.factureOpers,r}return __extends(t,n),t.__fields__=function(){return[this.DPFacture]},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Options.Add({Title:"Update",OnOptionClicked:this.Update.bind(this)})},t.prototype.activeClass=function(){return"selectedProduct"},t.prototype.OnFullInitialized=function(){n.prototype.OnFullInitialized.call(this)},t.prototype.OnCompileEnd=function(t){var i=this;n.prototype.OnCompileEnd.call(this,t);f.resources.GData.apis.Category.Update();f.resources.GData.requester.Request(r.models.Products,"GETCSV",void 0,void 0,function(n,t,r,e){f.resources.GData.__data.Products.FromCsv(e.Response,u.encoding.SerializationContext.GlobalContext);i.Items.Source=f.resources.GData.__data.Products})},t.prototype.Update=function(){this.SmartUpdate()},t.prototype.SmartUpdate=function(){var n=f.resources.GData.db.Get("Products");n==null&&f.resources.GData.db.CreateTable("Products",r.models.Product);n.table.LoadTableFromDB(f.resources.GData.__data.Products,function(){var t=Date.now();f.resources.GData.apis.Product.SmartUpdate(new Date(n.info.LastUpdate||0))})},t.prototype.OnAttached=function(){},t.prototype.FactureChanged=function(n){this.unobserve(n._old);this.observe(n._new)},t.prototype.unobserve=function(n){n&&(n.UnObserve(r.models.Facture.DPArticles,this.OnArticlesChanged),this.rebuild(n.Articles,null))},t.prototype.observe=function(n){n&&(n.Observe(r.models.Facture.DPArticles,this.OnArticlesChanged,this),this.rebuild(null,n.Articles))},t.prototype.OnArticlesChanged=function(n,t){this.rebuild(t._old,t._new)},t.prototype.rebuild=function(n,t){var i,u,r;if(n)for(n.Unlisten=this.articleChanged,i=n.Count-1;i>=0;i--)r=void 0,(r=(r=n.Get(i))&&r.Product)&&(r.CurrentArticle=null);if(t)for(t.Listen=this.articleChanged,i=t.Count-1;i>=0;i--)u=t.Get(i),r=void 0,(r=u&&u.Product)&&(r.CurrentArticle=u)},t.prototype.OnArticleChanged=function(){this.rebuild(this.Facture.Articles,this.Facture.Articles)},t.prototype.exec=function(n,t){t.Title=="add"?n.Count++:t.Title=="remove"?n.Count--:t.Title=="unarchive"?(this.t,u.thread.Dispatcher.call(this,function(n){this.t.Open(n.Count);this.t.OnClosed.Add(function(t,i,r){r&&(n.Count=i)})},n)):t.Title=="delete_sweep"&&(n.Count=0)},t.prototype.OnOptionOpening=function(){var t=this.Facture,n=this.ListView.SelectedItem;if(n)return this.fop.Init(this.Facture,n&&n.CurrentArticle,n,this.t),this.fop.OnOptionOpening()},t.prototype.OnOptionExecuted=function(n){var i=this.Facture,t=this.ListView.SelectedItem;return this.fop.Init(this.Facture,t&&t.CurrentArticle,t,this.t),this.fop.OnOptionExecuted(n)},t.prototype.OnSweep=function(){},t.DPFacture=u.bind.DObject.CreateField("Facture",r.models.Facture,null,t.prototype.FactureChanged),t}(i.controls.abstracts.MobilePage),c,t,l;n.Home=h;c=function(n){function t(t){var i=n.call(this,f.resources.mobile.get("factures"),"Factures","","library_books")||this;return i.app=t,i}return __extends(t,n),t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Options.Add({Title:"Update ",OnOptionClicked:this.Update.bind(this)});this.Options.Add({Title:"Ouvrir ",OnOptionClicked:this.ShowFacture.bind(this)});this.Options.Add({Title:"Modifier ",OnOptionClicked:this.EditFacture.bind(this)});this.Options.Add({Title:"Nouveau ",OnOptionClicked:this.NewFacture.bind(this)});this.Options.Add({Title:"Delete ",OnOptionClicked:this.DeleteFacture.bind(this)});this.Items.Source=f.resources.GData.__data.Factures},t.prototype.activeClass=function(){return"profile-cart-active"},t.prototype.OnFullInitialized=function(){n.prototype.OnFullInitialized.call(this)},t.prototype.OnCompileEnd=function(t){n.prototype.OnCompileEnd.call(this,t);f.resources.GData.apis.Client.Update();f.resources.GData.apis.Agent.Update();f.resources.GData.requester.Request(r.models.Factures,"GETCSV",void 0,void 0,function(n,t,i,r){f.resources.GData.__data.Factures.FromCsv(r.Response,u.encoding.SerializationContext.GlobalContext)})},t.prototype.OnDoubleTab=function(n){this.app.ShowFacture(n)},t.prototype.Update=function(){f.resources.GData.apis.Facture.SmartUpdate()},t.prototype.NewFacture=function(){this.app.NewFacture()},t.prototype.DeleteFacture=function(){this.app.DeleteFacture()},t.prototype.ShowFacture=function(){this.app.ShowFacture(this.ListView.SelectedItem)},t.prototype.EditFacture=function(){this.app.OpenFacture(this.ListView.SelectedItem)},t}(i.controls.abstracts.MobilePage);n.Factures=c;t=function(n){function t(t){var r=n.call(this,f.resources.mobile.get("facture"),"Facture","","receipt")||this;return r.app=t,r.fop=new e.factureOpers,r.t=new i.controls.SimpleEdit(!0),r.OnServerResponse=r.OnServerResponse.bind(r),r}return __extends(t,n),t.__fields__=function(){return[this.DPSelectedFacture]},t.prototype.initialize=function(){n.prototype.initialize.call(this);this.Options.Add({Title:"Metre a jour",OnOptionClicked:this.Update.bind(this)});this.Options.Add({Title:"Modifier",OnOptionClicked:this.EditFacture.bind(this)});this.Options.Add({Title:"Ouvrir",OnOptionClicked:this.ShowFacture.bind(this)});this.Options.Add({Title:"Fermer",OnOptionClicked:this.CloseFacture.bind(this)})},t.prototype.activeClass=function(){return"selectedProduct"},t.prototype.OnFullInitialized=function(){n.prototype.OnFullInitialized.call(this)},t.prototype.Update=function(){this.SelectedFacture&&f.resources.GData.apis.Facture.UpdateArticlesOf(this.SelectedFacture,this.OnServerResponse)},t.prototype.DeleteFacture=function(){this.app.DeleteFacture()},t.prototype.ShowFacture=function(){this.app.ShowFacture(this.SelectedFacture)},t.prototype.CloseFacture=function(){this.app.CloseFacture(this.SelectedFacture)},t.prototype.EditFacture=function(){this.app.OpenFacture(this.SelectedFacture)},t.prototype.OnServerResponse=function(n,t,i){i!==u.basic.DataStat.Success&&alert("Fail to load facture due to :"+u.basic.DataStat[i])},t.prototype.OnDoubleTab=function(n){e.ArticleManager.editArticle(this.SelectedFacture,n,n&&n.Product)},t.prototype.saveArticle=function(n,t){var i=n.CreateBackup(),r=this.SelectedFacture;n.Count=t;t?f.resources.GData.apis.Article.Save(n,function(t){t.Error==u.basic.DataStat.Success?n.Commit(i):(alert("L'article n'est pas sauvegarder"),n.Rollback(i))}):f.resources.GData.apis.Article.Delete(n,function(t){t.Error==u.basic.DataStat.Success?(n.Commit(i),r.Articles.Remove(n),n.Product.CurrentArticle=null):(alert("L'article n'est pas sauvegarder"),n.Rollback(i))})},t.prototype.OnFactureChanged=function(n){var t=n._new;this.Items.Source=t&&t.Articles;this.Update()},t.prototype.OnOptionOpening=function(){var t=this.SelectedFacture,n=this.ListView.SelectedItem;if(n)return this.fop.Init(t,n,n&&n.Product,this.t),this.fop.OnOptionOpening()},t.prototype.OnOptionExecuted=function(n){var i=this.SelectedFacture,t=this.ListView.SelectedItem;if(t)return this.fop.Init(i,t,t.Product,this.t),this.fop.OnOptionExecuted(n)},t.DPSelectedFacture=u.bind.DObject.CreateField("SelectedFacture",r.models.Facture,null,t.prototype.OnFactureChanged),t}(i.controls.abstracts.MobilePage);n.Facture=t;l=function(e){function c(n){var t=e.call(this,f.resources.mobile.get("app").content.firstElementChild,n)||this;return t.list=f.resources.GData.__data.Costumers.Filtred(window.fltr=new s.filters.list.LStringFilter),t.Foot=new o.UI.ServiceNavBar(t,!0),t}return __extends(c,e),c.prototype.DeleteFacture=function(){throw new Error("Method not implemented.");},c.prototype.initialize=function(){e.prototype.initialize.call(this);this.Items.Add(this.factures=new n.Factures(this));this.Items.Add(this.facture=new n.Facture(this));this.Items.Add(this.home=new n.Home(this));this.__Controller__.OnCompiled={Owner:this,Invoke:this.OnFullCompilled};this.dbHfFf=new u.bind.TwoDBind(u.bind.BindingMode.TwoWay,this.home,this.facture,h.DPFacture,t.DPSelectedFacture,function(n){return n},function(n){return n});this.initApis()},c.prototype.OnFullCompilled=function(){this.SelectedPage=this.home},c.prototype.ShowFacture=function(n){this.facture.SelectedFacture=n;this.SelectedPage=this.facture},c.prototype.EditFacture=function(n){this.facture.SelectedFacture=n;this.SelectedPage=this.home},c.prototype.OpenFacture=function(n){var t=this;n&&f.resources.GData.apis.Facture.OpenFacture(n,function(n,i){i?(n.IsOpen=!0,t.EditFacture(n),o.UI.InfoArea.push("La Facture est bien ouvrir",!0)):alert("Failed to open facture .Sory")})},c.prototype.CloseFacture=function(n){n&&f.resources.GData.apis.Facture.CloseFacture(n,function(n,t){t?(o.UI.InfoArea.push("La Facture est bien fermer",!0),n.IsOpen=!1):alert("Failed to close facture .Sory")})},c.prototype.initializeNF=function(){var n=this,t;this.t=new i.controls.Pop(!0);t=new o.UI.TControl("mobile.newFacture",{data:this.list,OkClicked:function(){n.t.Hide(o.UI.MessageResult.ok,void 0)},CancelClicked:function(){n.t.Hide(o.UI.MessageResult.cancel,void 0)}});t.setName=function(t,i,r){t=="ListView"&&(n.ListView=r,n.ListView.AcceptNullValue=!0)};f.resources.GData.apis.Client.Update();this.t.Content=t},c.prototype.NewFacture=function(){var n=this;this.t||this.initializeNF();this.t.Open(function(t){var i,u;if(t.Result==o.UI.MessageResult.ok){if(i=n.ListView.SelectedItem,!i){t.Cancel=!0;o.UI.InfoArea.push("Select One Client Please");return}u=new r.models.Facture(0);f.resources.GData.requester.Request(r.models.Facture,"CREATE",u,{CId:i.Id,Type:r.models.BonType.Bon,Abonment:r.models.Abonment.Detaillant,TType:r.models.TransactionType.Vente},function(t,i,r){r?(f.resources.GData.__data.Factures.Add(t.data),n.EditFacture(u)):o.UI.InfoArea.push("Creation of Facture Failed")})}},this)},c.prototype.initApis=function(){u.bind.NamedScop.Create("qdata",f.resources.GData.__data);var n=this;u.Api.RegisterApiCallback({Name:"ShowFacture",DoApiCallback:function(t,i,r){n.ShowFacture(r.data)}});u.Api.RegisterApiCallback({Name:"OpenFacture",DoApiCallback:function(t,i,r){n.OpenFacture(r.data)}});u.Api.RegisterApiCallback({Name:"CloseFacture",DoApiCallback:function(t,i,r){n.CloseFacture(r.data)}})},c}(i.controls.EMobileApp);n.App=l})(h=t.Pages||(t.Pages={}));u.bind.Register({Name:"search",OnInitialize:function(n){var t,i;window.srch=this;t=n.dom;t instanceof HTMLInputElement||console.debug("Un Expected Value Type");i=n.Scop.Value;t.addEventListener(t.hasAttribute("autosearch")?"input":"change",function(){i.Filter.Patent=new s.filters.list.StringPatent(this.value.toString())})},Todo:function(){}})});define("Mobile/Main",["require","exports","Mobile/Core","abstract/QShopApis","Mobile/Pages/Home","../lib/q/sys/UI"],function(n,t,i,r,u,f){"use strict";function o(){setTimeout(function(){new e},0)}Object.defineProperty(t,"__esModule",{value:!0});r.Apis.Load();var e=function(){function n(){this.Setting=new i.controls.Settings(this);this.Auth=new i.controls.AuthApp(this);this.App=new u.Pages.App(this);f.UI.Spinner.Default.Pause();this.Setting.Show()}return n}();t.Teta=e;t.initialize=o});define("abstract/Printing",["require","exports","../lib/Q/sys/Corelib"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(n){var o=function(n){function o(){return n!==null&&n.apply(this,arguments)||this}return __extends(o,n),Object.defineProperty(o.prototype,"Color",{get:function(){return this.get(o.DPColor)},set:function(n){this.set(o.DPColor,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Landscape",{get:function(){return this.get(o.DPLandscape)},set:function(n){this.set(o.DPLandscape,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Margins",{get:function(){return this.get(o.DPMargins)},set:function(n){this.set(o.DPMargins,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"PaperSize",{get:function(){return this.get(o.DPPaperSize)},set:function(n){this.set(o.DPPaperSize,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"PaperSource",{get:function(){return this.get(o.DPPaperSource)},set:function(n){this.set(o.DPPaperSource,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"PrinterResolution",{get:function(){return this.get(o.DPPrinterResolution)},set:function(n){this.set(o.DPPrinterResolution,n)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"PrinterSettings",{get:function(){return this.get(o.DPPrinterSettings)},set:function(n){this.set(o.DPPrinterSettings,n)},enumerable:!0,configurable:!0}),o.__fields__=function(){return[this.DPColor,this.DPLandscape,this.DPMargins,this.DPPaperSize,this.DPPaperSource,this.DPPrinterResolution,this.DPPrinterSettings]},o.ctor=function(){this.DPColor=i.bind.DObject.CreateField("Color",Boolean);this.DPLandscape=i.bind.DObject.CreateField("Landscape",Boolean);this.DPMargins=i.bind.DObject.CreateField("Margins",u);this.DPPaperSize=i.bind.DObject.CreateField("PaperSize",r);this.DPPaperSource=i.bind.DObject.CreateField("PaperSource",f);this.DPPrinterResolution=i.bind.DObject.CreateField("PrinterResolution",e);this.DPPrinterSettings=i.bind.DObject.CreateField("PrinterSettings",t)},o}(i.bind.DObject),r,u,f,e,h,t,c,l,s;n.PageSettings=o;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Height",{get:function(){return this.get(t.DPHeight)},set:function(n){this.set(t.DPHeight,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PaperName",{get:function(){return this.get(t.DPPaperName)},set:function(n){this.set(t.DPPaperName,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RawKind",{get:function(){return this.get(t.DPRawKind)},set:function(n){this.set(t.DPRawKind,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return this.get(t.DPWidth)},set:function(n){this.set(t.DPWidth,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPHeight,this.DPPaperName,this.DPRawKind,this.DPWidth]},t.ctor=function(){this.DPHeight=i.bind.DObject.CreateField("Height",Number);this.DPPaperName=i.bind.DObject.CreateField("PaperName",String);this.DPRawKind=i.bind.DObject.CreateField("RawKind",Number);this.DPWidth=i.bind.DObject.CreateField("Width",Number)},t}(i.bind.DObject);n.PaperSize=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Left",{get:function(){return this.get(t.DPLeft)},set:function(n){this.set(t.DPLeft,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){return this.get(t.DPRight)},set:function(n){this.set(t.DPRight,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.get(t.DPTop)},set:function(n){this.set(t.DPTop,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bottom",{get:function(){return this.get(t.DPBottom)},set:function(n){this.set(t.DPBottom,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPLeft,this.DPRight,this.DPTop,this.DPBottom]},t.ctor=function(){this.DPLeft=i.bind.DObject.CreateField("Left",Number);this.DPRight=i.bind.DObject.CreateField("Right",Number);this.DPTop=i.bind.DObject.CreateField("Top",Number);this.DPBottom=i.bind.DObject.CreateField("Bottom",Number)},t}(i.bind.DObject);n.Margins=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"RawKind",{get:function(){return this.get(t.DPRawKind)},set:function(n){this.set(t.DPRawKind,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SourceName",{get:function(){return this.get(t.DPSourceName)},set:function(n){this.set(t.DPSourceName,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPRawKind,this.DPSourceName]},t.ctor=function(){this.DPRawKind=i.bind.DObject.CreateField("RawKind",Number);this.DPSourceName=i.bind.DObject.CreateField("SourceName",String)},t}(i.bind.DObject);n.PaperSource=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Kind",{get:function(){return this.get(t.DPKind)},set:function(n){this.set(t.DPKind,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"X",{get:function(){return this.get(t.DPX)},set:function(n){this.set(t.DPX,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Y",{get:function(){return this.get(t.DPY)},set:function(n){this.set(t.DPY,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPKind,this.DPX,this.DPY]},t.ctor=function(){this.DPKind=i.bind.DObject.CreateField("Kind",Number);this.DPX=i.bind.DObject.CreateField("X",Number);this.DPY=i.bind.DObject.CreateField("Y",Number)},t}(i.bind.DObject);n.PrinterResolution=e,function(n){n[n.High=-4]="High";n[n.Medium=-3]="Medium";n[n.Low=-2]="Low";n[n.Draft=-1]="Draft";n[n.Custom=0]="Custom"}(h=n.PrinterResolutionKind||(n.PrinterResolutionKind={}));t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Copies",{get:function(){return this.get(t.DPCopies)},set:function(n){this.set(t.DPCopies,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Collate",{get:function(){return this.get(t.DPCollate)},set:function(n){this.set(t.DPCollate,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Duplex",{get:function(){return this.get(t.DPDuplex)},set:function(n){this.set(t.DPDuplex,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FromPage",{get:function(){return this.get(t.DPFromPage)},set:function(n){this.set(t.DPFromPage,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MaximumPage",{get:function(){return this.get(t.DPMaximumPage)},set:function(n){this.set(t.DPMaximumPage,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MinimumPage",{get:function(){return this.get(t.DPMinimumPage)},set:function(n){this.set(t.DPMinimumPage,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PrintFileName",{get:function(){return this.get(t.DPPrintFileName)},set:function(n){this.set(t.DPPrintFileName,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PrintRange",{get:function(){return this.get(t.DPPrintRange)},set:function(n){this.set(t.DPPrintRange,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PrintToFile",{get:function(){return this.get(t.DPPrintToFile)},set:function(n){this.set(t.DPPrintToFile,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PrinterName",{get:function(){return this.get(t.DPPrinterName)},set:function(n){this.set(t.DPPrinterName,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ToPage",{get:function(){return this.get(t.DPToPage)},set:function(n){this.set(t.DPToPage,n)},enumerable:!0,configurable:!0}),t.__fields__=function(){return[this.DPCopies,this.DPCollate,this.DPDuplex,this.DPFromPage,this.DPMaximumPage,this.DPMinimumPage,this.DPPrintFileName,this.DPPrintRange,this.DPPrintToFile,this.DPPrinterName,this.DPToPage]},t.ctor=function(){this.DPCopies=i.bind.DObject.CreateField("Copies",Number);this.DPCollate=i.bind.DObject.CreateField("Collate",Boolean);this.DPDuplex=i.bind.DObject.CreateField("Duplex",Number);this.DPFromPage=i.bind.DObject.CreateField("FromPage",Number);this.DPMaximumPage=i.bind.DObject.CreateField("MaximumPage",Number);this.DPMinimumPage=i.bind.DObject.CreateField("MinimumPage",Number);this.DPPrintFileName=i.bind.DObject.CreateField("PrintFileName",String);this.DPPrintRange=i.bind.DObject.CreateField("PrintRange",Number);this.DPPrintToFile=i.bind.DObject.CreateField("PrintToFile",Boolean);this.DPPrinterName=i.bind.DObject.CreateField("PrinterName",String);this.DPToPage=i.bind.DObject.CreateField("ToPage",Number)},t}(i.bind.DObject);n.PrinterSettings=t,function(n){n[n.Default=-1]="Default";n[n.Simplex=1]="Simplex";n[n.Vertical=2]="Vertical";n[n.Horizontal=3]="Horizontal"}(c=n.Duplex||(n.Duplex={})),function(n){n[n.AllPages=0]="AllPages";n[n.Selection=1]="Selection";n[n.SomePages=2]="SomePages";n[n.CurrentPage=4194304]="CurrentPage"}(l=n.PrintRange||(n.PrintRange={}));s=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),Object.defineProperty(r.prototype,"Handler",{get:function(){return this.get(r.DPHandler)},set:function(n){this.set(r.DPHandler,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"OwnerId",{get:function(){return this.get(r.DPOwnerId)},set:function(n){this.set(r.DPOwnerId,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Owner",{get:function(){return this.get(r.DPOwner)},set:function(n){this.set(r.DPOwner,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Params",{get:function(){return this.get(r.DPParams)},set:function(n){this.set(r.DPParams,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"PrinterSettings",{get:function(){return this.get(r.DPPrinterSettings)},set:function(n){this.set(r.DPPrinterSettings,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"PageSettings",{get:function(){return this.get(r.DPPageSettings)},set:function(n){this.set(r.DPPageSettings,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Response",{get:function(){return this.get(r.DPResponse)},set:function(n){this.set(r.DPResponse,n)},enumerable:!0,configurable:!0}),r.__fields__=function(){return[this.DPHandler,this.DPOwnerId,this.DPOwner,this.DPParams,this.DPPrinterSettings,this.DPPageSettings,this.DPResponse]},r.ctor=function(){this.DPHandler=i.bind.DObject.CreateField("Handler",String);this.DPOwnerId=i.bind.DObject.CreateField("OwnerId",Number);this.DPOwner=i.bind.DObject.CreateField("Owner",String);this.DPParams=i.bind.DObject.CreateField("Params",Array);this.DPPrinterSettings=i.bind.DObject.CreateField("PrinterSettings",t);this.DPPageSettings=i.bind.DObject.CreateField("PageSettings",o);this.DPResponse=i.bind.DObject.CreateField("Response",Object)},r}(i.bind.DObject);n.PrintDocument=s})(r=t.Printing||(t.Printing={}))});define("abstract/Apis/FakePrice",["require","exports","abstract/Models","abstract/extra/AdminApis"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){var r=n.call(this,t,"FakePrice.edit")||this;return r.d=new i.models.FakePrices(null),r}return __extends(t,n),t.prototype.GetArrayType=function(){return i.models.FakePrices},t.prototype.GetArgType=function(){return i.models.FakePrice},t.prototype.NativeCreateItem=function(n){return new i.models.FakePrice(n)},t.prototype.Check=function(n,t){this.callback(t,n,(n&&n.Product)!=null)},t.prototype.getDefaultList=function(){return this.d},t}(r.EMyApi);t.FakePrice1=u});define("lib/Q/initQLib",["require","exports","./sys/AI"],function(n,t,i){"use strict";function r(n){for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])}Object.defineProperty(t,"__esModule",{value:!0});r(i)});